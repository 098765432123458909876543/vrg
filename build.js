/*!
 * bowser@2.11.0 (MIT)
 *   author: Dustin Diaz <dustin@dustindiaz.com> (http://dustindiaz.com)
 *   url: git+https://github.com/lancedikson/bowser.git
 *   contributors:
 *     Denis Demchenko (http://twitter.com/lancedikson)
 *
 *   Copyright 2015, Dustin Diaz (the "Original Author")
 *   All rights reserved.
 *
 *   MIT License
 *
 *   Permission is hereby granted, free of charge, to any person
 *   obtaining a copy of this software and associated documentation
 *   files (the "Software"), to deal in the Software without
 *   restriction, including without limitation the rights to use,
 *   copy, modify, merge, publish, distribute, sublicense, and/or sell
 *   copies of the Software, and to permit persons to whom the
 *   Software is furnished to do so, subject to the following
 *   conditions:
 *
 *   The above copyright notice and this permission notice shall be
 *   included in all copies or substantial portions of the Software.
 *
 *   Distributions of all or part of the Software intended to be used
 *   by the recipients as they would use the unmodified Software,
 *   containing modifications that substantially alter, remove, or
 *   disable functionality of the Software, outside of the documented
 *   configuration mechanisms provided by the Software, shall be
 *   modified such that the Original Author's bug reporting email
 *   addresses and urls are either replaced with the contact information
 *   of the parties responsible for the changes, or removed entirely.
 *
 *   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 *   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 *   OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 *   NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 *   HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 *   WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 *   FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 *   OTHER DEALINGS IN THE SOFTWARE.
 *
 *
 *   Except where noted, this license applies to any and all software
 *   programs and associated documentation files created by the
 *   Original Author, when distributed with the Software.
 *
 *
 *
 * is-electron@2.2.1 (MIT)
 *   author: Cheton Wu <cheton@gmail.com>
 *   url: git@github.com:cheton/is-electron.git
 *
 *   The MIT License (MIT)
 *
 *   Copyright (c) 2016-2018 Cheton Wu
 *
 *   Permission is hereby granted, free of charge, to any person obtaining a copy
 *   of this software and associated documentation files (the "Software"), to deal
 *   in the Software without restriction, including without limitation the rights
 *   to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *   copies of the Software, and to permit persons to whom the Software is
 *   furnished to do so, subject to the following conditions:
 *
 *   The above copyright notice and this permission notice shall be included in all
 *   copies or substantial portions of the Software.
 *
 *   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *   IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *   AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *   LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *   OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 *   SOFTWARE.
 *
 *
 *
 * is-mobile@3.1.1 (MIT)
 *   author: Julian Gruber (http://juliangruber.com)
 *   url: git://github.com/juliangruber/is-mobile.git
 *
 *
 */
/*! For license information please see build.js.LICENSE.txt */
(()=>{var e,t,n,s,i,a,r={224:(e,t,n)=>{"use strict";n.d(t,{p:()=>re});var s=n(580),i=n(666),a=n(276);const r=new Map;function o(e,t){let n;const s=e.toLowerCase();switch(!0){case/^int[0-9]+$/.test(s):switch(s){case"int8":n=new Int8Array(t);break;case"int16":n=new Int16Array(t);break;case"int32":n=new Int32Array(t)}break;case/^uint[0-9]+$/.test(s):switch(s){case"uint8":n=new Uint8Array(t);break;case"uint16":n=new Uint16Array(t);break;case"uint32":n=new Uint32Array(t)}break;case"uint8clamped"===s:n=new Uint8ClampedArray(t);break;case/^float[0-9]+$/.test(s):switch(s){case"float32":n=new Float32Array(t);break;case"float64":n=new Float64Array(t)}}if(!n)throw new Error("Not found array type was ".concat(e));return n}function l(){return"SharedArrayBuffer"in self}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=o(e,t).byteLength;return!n&&l()?new SharedArrayBuffer(s):new ArrayBuffer(s)}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o(e,h(e,t,n))}var u=n(574);function d(e,t,n,s,i,r,o,l){if(e|=0,n|=0,i+l>(t|=0)&&i<t+1){const t=o/2;if((s+t>e||s-t<e+1)&&(r+t>n||r-t<n+1)){const i=e,o=n,l=e+1,h=n,c=e,u=n+1,d=e+1,g=n+1;return s<i&&r<o?(0,a.LW)(s,r,i,o)<t:s>l&&r<h?(0,a.LW)(s,r,l,h)<t:s<c&&r>u?(0,a.LW)(s,r,c,u)<t:!(s>d&&r>g)||(0,a.LW)(s,r,d,g)<t}}return!1}function g(e,t,n,s,i,r,o){const l=Math.max(0,Math.abs(e-s)-r/2),h=Math.max(0,Math.abs(t-i)-o/2);return(0,a.oK)(l,h,l,h)<=n*n}function p(e,t,n,s,i,r,o,l,h,c){const[u,d,g,p,f,m]=function(e,t,n,s,i,r,o,l,h,c){if(t<o+c&&t+i>o||o<t+i&&o+c>t){const[u,d,g,p]=function(e,t,n,s,i,r){let[o,l]=(0,a.xw)(e,t,s,i),h=Math.sqrt(o*o+l*l);let c=n/2+r/2-h;if(c<=0)return[0,0,0,0];h>0&&(h=1/h);return o*=h,l*=h,c/=2,[o*c,l*c,-o*c,-l*c]}(e,n,s,r,l,h),f=0!==u||0!==d||0!==g||0!==p?o-t>c/.5?t-(o+c):o-(t+i):0;return[u,f/2,d,g,-f/2,p]}return[0,0,0,0,0,0]}(e,t,n,s,i,r,o,l,h,c);return 0!==u||0!==d||0!==g||0!==p||0!==f||0!==m}const f=new Array;function m(e,t,n,s,i,a,r,o,l){return(e-s)*(r-s)+(t-i)*(o-i)+(n-a)*(l-a)}function y(e,t,n,s,i,r,o,l,h,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:new a.P(0,0,0),d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:new a.P(0,0,0);const g=s*s+i*i+r*r,p=s*(o-=e)+i*(l-=t)+r*(h-=n),f=o*o+l*l+h*h-c*c;if(0===g)return!1;let m=p*p-g*f;if(m<0)return!1;m=Math.sqrt(m);const y=(p-m)/g,w=(p+m)/g;return!(y<0||w<0)&&(u.x=e+y*s,u.y=t+y*i,u.z=n+y*r,d.x=e+w*s,d.y=t+w*i,d.z=n+w*r,!0)}function w(e,t,n,s,i,r,o,l,h,c,u,d,g){let p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:new a.P(0,0,0),f=arguments.length>14&&void 0!==arguments[14]?arguments[14]:new a.P(0,0,0);const m=o-e,y=l-t,w=h-n,b=(c-=e)-m,v=(u-=t)-y,x=(d-=n)-w,M=s*s+i*i+r*r,S=b*s+v*i+x*r,k=m*s+y*i+w*r,P=b*b+v*v+x*x,_=m*b+y*v+w*x,E=m*m+y*y+w*w,O=g*g;if(0===P)return!1;const A=M-S*S/P,L=k-_*S/P,C=E-_*_/P-O;if(0===A)return!1;let T=L*L-A*C;if(T<0)return!1;T=Math.sqrt(T);const D=(L-T)/A,F=(L+T)/A;return p.x=e+D*s,p.y=t+D*i,p.z=n+D*r,f.x=e+F*s,f.y=t+F*i,f.z=n+F*r,!0}function b(e,t,n,s,i,r,o,l,h,c,u,d){const[g,p,f]=(0,a.tL)(s,i),b=new a.P(-1,-1,-1),v=new a.P(-1,-1,-1);c-=d/=2;let x=!1,M=!1,S=!1;if(1==y(e,t,n,g,p,f,r,o+=d,l,d,b,v)&&m(h,c,u,r,o,l,b.x,b.y,b.z)<=0)x=!0;else if(1==y(e,t,n,g,p,f,h,c,u,d,b,v)&&m(r,o,l,h,c,u,b.x,b.y,b.z)<=0)M=!0;else{if(!(1==w(e,t,n,g,p,f,r,o,l,h,c,u,d,b,v)&&m(r,o,l,h,c,u,b.x,b.y,b.z)>0&&m(h,c,u,r,o,l,b.x,b.y,b.z)>0))return[-1,-1,-1,-1,-1,-1];S=!0}const k=new a.P(0,0,0);return x&&m(h,c,u,r,o,l,v.x,v.y,v.z)<=0||M&&m(r,o,l,h,c,u,v.x,v.y,v.z)<=0||S&&m(r,o,l,h,c,u,v.x,v.y,v.z)>0&&m(h,c,u,r,o,l,v.x,v.y,v.z)>0||1==y(e,t,n,g,p,f,r,o,l,d,k,v)&&m(h,c,u,r,o,l,v.x,v.y,v.z)<=0||1==y(e,t,n,g,p,f,h,c,u,d,k,v)&&m(r,o,l,h,c,u,v.x,v.y,v.z)<=0||w(e,t,n,g,p,f,r,o,l,h,c,u,d,k,v),[b.x,b.y,b.z,v.x,v.y,v.z]}var v=n(768);const x=[[1,0,0],[0,0,1],[-1,0,0],[0,0,-1],[1,0,1],[-1,0,-1],[1,0,-1],[-1,0,1]],M=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1],[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[0,1,1],[0,-1,1],[0,1,-1],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[1,-1,-1],[-1,1,1],[1,-1,1],[1,1,-1],[-1,-1,1],[1,-1,-1],[-1,1,-1],[-1,-1,-1],[1,1,1]];function S(e,t,n,s,i,a,r,o){return((0|i)*r*a+(0|s)*a+(0|n))*e+t}function k(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Array;const s=t/2,i=Math.floor(e-s),a=Math.ceil(e+s);if(!(i^a))return[i];for(let t=0|i,r=0|a;t<r;t=t+1|0){const i=t+.5,a=Math.abs(i-e);Math.sqrt(a*a)>s||n.push(t)}return n}function P(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Array;const i=n/2,a=Math.floor(e-i),r=Math.floor(t-i),o=Math.ceil(e+i),l=Math.ceil(t+i);if(a==o&&r===l)return[a,r];for(let i=0|a,h=0|o;i<h;i=i+1|0)for(let a=0|r,o=0|l;a<o;a=a+1|0)d(i,0,a,e,.5,t,n,0)&&s.push(i,a);return s}function _(e,t,n,s,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Array;const r=s/2,o=i,l=Math.floor(e-r),h=Math.floor(t),c=Math.floor(n-r),u=Math.ceil(e+r),g=Math.ceil(t+o),p=Math.ceil(n+r);if(l===u&&h===g&&c===p)return[l,h,c];for(let r=0|l,o=0|u;r<o;r=r+1|0)for(let o=0|c,l=0|p;o<l;o=o+1|0)for(let l=0|h,c=0|g;l<c;l=l+1|0)d(r,l,o,e,t,n,s,i)&&a.push(r,l,o);return a}function E(e,t,n,s,i,r,o,l){return function(e,t,n,s,i){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,o=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0;const[h,c,u]=(0,a.XC)(e,t);let d=1/h,g=1/c,p=1/u,f=Math.floor(n),m=Math.floor(s),y=Math.floor(i),w=0,b=0,v=0,x=0,M=0,S=0;d>0?(w=1,x=(f+1-n)*d):(d*=-1,w=-1,x=(n-f)*d),g>0?(b=1,M=(m+1-s)*g):(g*=-1,b=-1,M=(s-m)*g),p>0?(v=1,S=(y+1-i)*p):(p*=-1,v=-1,S=(i-y)*p);let k=x<M?x<S?x:S:M<S?M:S,P=x<M?x<S?0:2:M<S?1:2;do{const e=o(f,m,y,k,P,x,M,S,d,g,p,w,b,v);if(e){let t=n+k/d*w,a=s+k/g*b,r=i+k/p*v;switch(P){case 0:t=Math.round(t);break;case 1:a=Math.round(a);break;case 2:r=Math.round(r)}if(l&&l(f,m,y,t,a,r,e,k,P,x,M,S,d,g,p,w,b,v))break;return[t,a,r,k]}{const e=x<M?x<S?x:S:M<S?M:S;let t=n+e/d*w,a=s+e/g*b,r=i+e/p*v;switch(x<M?x<S?0:2:M<S?1:2){case 0:t=Math.round(t);break;case 1:a=Math.round(a);break;case 2:r=Math.round(r)}if(l&&l(f,m,y,t,a,r,!1,k,P,x,M,S,d,g,p,w,b,v))break}x<M?x<S?(f+=w,k=x,x+=d,P=0):(y+=v,k=S,S+=p,P=2):M<S?(m+=b,k=M,M+=g,P=1):(y+=v,k=S,S+=p,P=2)}while(k<r);return[-1,-1,-1,-1]}((0,a.B8)(e),(0,a.B8)(t),n,s,i,r,o,l)}function O(e,t,n,s,i,r,o){const l=(0,a.B8)(e),h=(0,a.B8)(t);return function(e,t,n,s,i){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,o=arguments.length>6?arguments[6]:void 0;const[l,h,c]=(0,a.XC)(e,t),u=1/l,d=1/h,g=1/c,p=Math.sign(l),f=Math.sign(h),m=Math.sign(c),y=p*u,w=f*d,b=m*g,x=Math.abs(u),M=Math.abs(d),S=Math.abs(g);let k=Math.floor(n),P=Math.floor(s),_=Math.floor(i),E=1/l,O=1/h,A=1/c,L=0,C=0,T=0,D=0,F=0,z=0;E>0?(L=1,D=(k+1-n)*E):(E*=-1,L=-1,D=(n-k)*E),O>0?(C=1,F=(P+1-s)*O):(O*=-1,C=-1,F=(s-P)*O),A>0?(T=1,z=(_+1-i)*A):(A*=-1,T=-1,z=(i-_)*A);let B=D<F?D<z?D:z:F<z?F:z,N=D<F?D<z?0:2:F<z?1:2;do{const e=o(k,P,_);if(e<=0){let e=n+B/E*L,t=s+B/O*C,a=i+B/A*T;switch(N){case 0:e=Math.round(e);break;case 1:t=Math.round(t);break;case 2:a=Math.round(a)}return[e,t,a,B]}const t=Math.floor((0,v._1)(Math.max(0,e-1)/x,0)),a=Math.floor((0,v._1)(Math.max(0,e-1)/M,0)),r=Math.floor((0,v._1)(Math.max(0,e-1)/S,0));D+=t*y,F+=a*w,z+=r*b,k+=t*p,P+=a*f,_+=r*m,D<F?D<z?(k+=L,B=D,D+=E,N=0):(_+=T,B=z,z+=A,N=2):F<z?(P+=C,B=F,F+=O,N=1):(_+=T,B=z,z+=A,N=2)}while(B<r);return[-1,-1,-1,-1]}(l<Number.EPSILON&&l>-Number.EPSILON?Number.EPSILON:l,h<Number.EPSILON&&h>-Number.EPSILON?-Number.EPSILON:h,n,s,i,r,o)}function A(e,t,n,s,i,a,r){let[o,l,h]=r;const c=0|t,u=0|n,d=0|s;if(null===e||c<0||c>=o||u<0||u>=l||d<0||d>=h)return-1;return e[S(a,i,c,u,d,o,l)]}function L(e,t,n,s,i,a,o,l,h){let[u,d,g]=o;const p=0|t,f=0|n,m=0|s;if(null===e||p<0||p>=u||f<0||f>=d||m<0||m>=g)return!1;const y=S(a,i,p,f,m,u,d),w=e[y],b=function(e,t){const n=r.has(e)?r.get(e):c(e,1,!0);return n?(n[0]=t,n[0]):t}(l,h);return w!==b&&(e[y]=h,!0)}function C(e,t,n,s,i,a,r,o,l,h){let c=arguments.length>10&&void 0!==arguments[10]&&arguments[10],u=arguments.length>11&&void 0!==arguments[11]&&arguments[11],d=arguments.length>12&&void 0!==arguments[12]&&arguments[12];if(i<0||a<0||r<0||i>o-1||a>l-1||r>h-1)return!1;const g=S(n,0,i,a,r,o,l);if(null===e||null===t)return!1;const p=e[g],f=0===t[g];return e[g]=d?s:c?0===t[g]?s:u?Math.max(0,Math.max(e[g],s)):Math.max(0,Math.min(e[g],s)):0===t[g]?s:e[g],t[g]=1,p!==e[g]||f}class T{constructor(e){this.filter=e}find(e,t,n,s,i){const[a,r,o]=e;let l=1/0,h=!1;const c=new Array,u={},d=(n,s,i,d)=>{if(s<0||i<0||d<0||s>a-1||i>r-1||d>o-1)return l=Math.min(l,n-1),void(h=!0);const g="".concat(s,",").concat(i,",").concat(d);if(u.hasOwnProperty(g))return l=Math.min(l,n-1),void(h=!0);u[g]=!0,1===A(this.filter,s,i,d,0,t,e)?h||c.push({count:n,x:s,y:i,z:d}):(l=Math.min(l,n-1),h=!0)};for(d(1,n,s,i);c.length>0;){const e=c.shift()||null;if(null===e)break;const{count:t,x:n,y:s,z:i}=e;for(let e=0,a=0|M.length;e<a;e=e+1|0){const[a,r,o]=M[e];d(t+1,n+a,s+r,i+o)}}return l===1/0?1:l}update(e,t,n,s,i,a,r,o){const[l,h,c]=n,u=A(this.filter,a,r,o,0,i,n)===s,d=u?this.find(n,i,a,r,o):0,g=new Array({count:d,x:a,y:r,z:o}),p={},f="".concat(a,",").concat(r,",").concat(o);if(p.hasOwnProperty(f))return;p[f]=!0,C(e,t,i,d,a,r,o,l,h,c,!0,u,!1);const m=(a,r,o,d)=>{if(a<0||r<0||o<0||d<0||r>l-1||o>h-1||d>c-1)return;const f="".concat(r,",").concat(o,",").concat(d);p.hasOwnProperty(f)||(p[f]=!0,C(e,t,i,a,r,o,d,l,h,c,!0,u,!1)&&A(this.filter,r,o,d,0,i,n)===s&&g.push({count:a,x:r,y:o,z:d}))};for(u&&m(this.find(n,i,a,r,o),a,r,o);g.length>0;){const e=g.shift()||null;if(null===e)break;const{count:t,x:s,y:a,z:r}=e;for(let e=0,o=0|M.length;e<o;e=e+1|0){const[o,l,h]=M[e];m(u?this.find(n,i,s+o,a+l,r+h):t+1,s+o,a+l,r+h)}}}}class D{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"uint8",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1;this.buffer=null,this.is_update=!0,this.is_reflesh_distance_field=!1,this.filter=null,this.distance_field=null,this.fill_distance_field=null,this.inserts=new Array,this.distance_field_builder=null,this.width=e,this.height=t,this.depth=n,this.distance=(0,a.X6)(0,0,0,e,t,n),this.data_type=s,this.length=i,this.fill=r,this.setSize(e,t,n)}clear(){this.setSize(1,1,1)}setSize(e,t,n){if(e===this.width&&t===this.height&&n===this.depth&&null!==this.buffer)return;const s=c(this.data_type,e*t*n*this.length),i=c("int32",e*t*n),r=c("int8",e*t*n);this.distance_field_builder=new T(s),this.buffer=s.buffer,this.width=e,this.height=t,this.depth=n,this.distance=(0,a.X6)(0,0,0,e,t,n),this.filter=s,this.distance_field=i,this.fill_distance_field=r,this.is_update=!0,s.fill(this.fill),i.fill(1),r.fill(0)}getWorldDistance(){return this.distance}getSize(){const{width:e,height:t,depth:n}=this;return[e,t,n]}getFill(){return this.fill}getLength(){return this.length}getBuffer(){return this.buffer}getFilter(){return this.filter}getDistanceField(){return this.distance_field}getFillDistanceField(){return this.fill_distance_field}set(e,t,n,s,i){let a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.getFilter(),o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this.getSize();var l;if(null===r)return;const h=0|t,c=0|n,u=0|s,d=r===this.getFilter()?this.length:1,[g,p,f]=o,m=r[S(d,e,h,c,u,g,p)];if(L(r,t,n,s,e,d,o,this.data_type,i)&&r===this.getFilter()&&(this.is_update=!0,m!==this.fill&&void 0!==this.inserts[m]&&(this.inserts[m].count--,this.inserts[m].count<=0&&delete this.inserts[m]),i!==this.fill&&(void 0===this.inserts[i]?this.inserts[i]={count:1}:this.inserts[i].count++),a)){const e=this.getDistanceField(),t=this.getFillDistanceField();null!==e&&null!==t&&(null===(l=this.distance_field_builder)||void 0===l||l.update(e,t,this.getSize(),this.getFill(),this.getLength(),h,c,u))}}get(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getFilter(),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.getSize();return null===i?-1:A(i,t,n,s,e,i===this.getFilter()?this.length:1,a)}getCount(e){return void 0===this.inserts[e]?0:this.inserts[e].count}expand(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===e&&0===t&&0===n)return;const[s,i,a]=this.getSize(),r=this.getFilter(),o=this.getDistanceField(),l=this.getFillDistanceField();this.setSize(s+Math.abs(e),i+Math.abs(t),a+Math.abs(n));for(let h=s-1|0;h>=0;h=h-1|0)for(let c=i-1|0;c>=0;c=c-1|0)for(let u=a-1|0;u>=0;u=u-1|0){const d=h+Math.abs(e<0?-e:0),g=c+Math.abs(t<0?-t:0),p=u+Math.abs(n<0?-n:0),f=this.get(0,h,c,u,o,[s,i,a]),m=this.get(0,h,c,u,l,[s,i,a]);this.set(0,d,g,p,-1===f?0:f,!1,this.getDistanceField()),this.set(0,d,g,p,-1===m?0:m,!1,this.getFillDistanceField());for(let e=0,t=0|this.length;e<t;e=e+1|0){const t=this.get(e,h,c,u,r,[s,i,a]);this.set(e,d,g,p,-1===t?1:t,!1,this.getFilter())}}}reduction(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===e&&0===t&&0===n)return;const[s,i,a]=this.getSize(),r=this.getFilter(),o=this.getDistanceField(),l=this.getFillDistanceField();this.setSize(s-Math.abs(e),i-Math.abs(t),a-Math.abs(n));for(let h=s-1|0;h>=0;h=h-1|0)for(let c=i-1|0;c>=0;c=c-1|0)for(let u=a-1|0;u>=0;u=u-1|0){const d=h-Math.abs(e<0?-e:0),g=c-Math.abs(t<0?-t:0),p=u-Math.abs(n<0?-n:0),f=this.get(0,h,c,u,o,[s,i,a]),m=this.get(0,h,c,u,l,[s,i,a]);this.set(0,d,g,p,-1===f?0:f,!1,this.getDistanceField()),this.set(0,d,g,p,-1===m?0:m,!1,this.getFillDistanceField());for(let e=0,t=0|this.length;e<t;e=e+1|0){const t=this.get(e,h,c,u,r,[s,i,a]);this.set(e,d,g,p,-1===t?1:t,!1,this.getFilter())}}}requestRefleshDistanceField(){this.is_reflesh_distance_field=!0}cancelRefleshDistanceField(){this.is_reflesh_distance_field=!1}async refleshDistanceField(){var e,t;const n=this.getFilter(),s=this.getDistanceField(),i=this.getFillDistanceField(),[a,r,o]=this.getSize(),l=this.getFill();if(null!==n&&null!==s&&null!==i){s.fill(1),null===(e=this.fill_distance_field)||void 0===e||e.fill(0);for(let e=0;e<a;e=e+1|0)for(let n=0;n<r;n=n+1|0)for(let h=0;h<o;h=h+1|0)this.get(0,e,n,h)!==this.fill&&(null===(t=this.distance_field_builder)||void 0===t||t.update(s,i,[a,r,o],l,this.getLength(),e,n,h));this.finalize()}}hasUpdate(){return this.is_update}finalize(){var e;null===(e=this.fill_distance_field)||void 0===e||e.fill(1)}checkUpdate(){let e=this.is_update;return this.is_reflesh_distance_field&&(this.refleshDistanceField(),this.is_reflesh_distance_field=!1,e=!0),this.is_update=!1,e}}var F=n(402),z=n(790);class B{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>[-1,-1,-1,-1,-1];this.size=new a.P(1,1,1),this.entitys=new Array,this.oldPropertys=new WeakMap,this.oldPoints=new WeakMap,this.data=new Array,this.points=new Array,this.heap=new Array,this.hasAdd=e,this.paramGetter=t}hasOverPosition(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const[a,r,o]=this.getSize();return e+s/2<0||t+i<0||n+s/2<0||e-s/2>=a||t>=r||n-s/2>=o}getDimension(){const[,e,t]=this.getSize();switch(!0){case!(1^e):return 1;case!(1^t):return 2}return 3}calcMortonNumber(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this.hasOverPosition(e,t,n))return-1;switch(this.getDimension()){case 1:return(0,F.mY)(e);case 2:return(0,F.nI)(e,n);case 3:return(0,F.Hq)(e,t,n)}}setSize(e,t,n){this.size.x=e,this.size.y=t,this.size.z=n}getSize(){return[this.size.x,this.size.y,this.size.z]}getEntityProperty(e){return this.paramGetter(e)}getOldEntityProperty(e){const t=this.oldPropertys.get(e);return t?[t.x,t.y,t.z,t.rx,t.ry]:[-1,-1,-1,-1,-1]}add(e){this.hasAdd(e)&&!this.entitys.includes(e)&&this.entitys.push(e)}remove(e){this.hasAdd(e)&&this.entitys.includes(e)&&this.entitys.splice(this.entitys.indexOf(e),1)}hasEntity(e){return this.hasAdd(e)}clear(){this.entitys.forEach((e=>this.oldPropertys.delete(e))),this.size.x=0,this.size.y=0,this.size.z=0,(0,u.vF)(this.data),(0,u.vF)(this.points),(0,u.vF)(this.entitys)}getCell(e){return this.data[e]||new Array}getPointCell(e,t,n){const s=this.calcMortonNumber(e,t,n);return this.getCell(s)}getAppendPoints(){return this.points}getDataLength(){return this.data.length}setOldPosition(e){const t=this.oldPropertys.get(e);if(void 0!==t){const[n,s,i,a,r]=this.getEntityProperty(e),o=Math.floor(n-a/2),l=Math.floor(s),h=Math.floor(i-a/2),c=Math.ceil(n+a/2),u=Math.ceil(s+r),d=Math.ceil(i+a/2);t.sx=o,t.sy=l,t.sz=h,t.ex=c,t.ey=u,t.ez=d,t.x=n,t.y=s,t.z=i,t.rx=a,t.ry=r}}initOldPosition(e){const t={x:-1,y:-1,z:-1,rx:-1,ry:-1,sx:-1,sy:-1,sz:-1,ex:-1,ey:-1,ez:-1};return this.oldPropertys.set(e,t),t}appendCells(e,t){const n=e.getID();for(let e=0,s=0|t.length;e<s;e=e+1|0){const s=t[e],i=this.data[s];void 0===i?this.data[s]=[n]:i.includes(n)||(i.push(n),i.length>1&&!this.points.includes(s)&&this.points.push(s))}}update(e,t,n){this.setSize(e,t,n),z.D1?this.data.fill(void 0):this.data.length=0,(0,u.vF)(this.points);for(let e=0,t=0|this.entitys.length;e<t;e=e+1|0){const t=this.entitys[e],[n,s,i,r,o]=this.getEntityProperty(t);let l=this.oldPropertys.get(t);if(void 0===l&&(l=this.initOldPosition(t)),-1!==n&&-1!==s&&-1!==i&&!this.hasOverPosition(n,s,i,r,o)){let e=this.oldPoints.get(t);void 0===e&&this.oldPoints.set(t,e=new Array);const h=Math.floor(n-r/2),c=Math.floor(s),d=Math.floor(i-r/2),g=Math.ceil(n+r/2),p=Math.ceil(s+o),f=Math.ceil(i+r/2);if(l.sx!==h||l.sy!==c||l.sz!==d||l.ex!==g||l.ey!==p||l.ez!==f){const t=-1===l.x?n:l.x,m=-1===l.y?s:l.y,y=-1===l.z?i:l.z,w=n-t,b=s-m,x=i-y,M=(0,a.X6)(w,b,x,0,0,0),[S,E]=(0,a.tx)(w,b,x,0,0,0),O=Math.min(M,r/4,o/4,.5),[A,L,C]=(0,a.c8)(S,E,0,0,1),T=this.getDimension();let D=0;for((0,u.vF)(e);;){const n=t+D*A,s=m+D*L,i=y+D*C;(0,u.vF)(this.heap);let a=this.heap;switch(T){case 1:a=k(n,r,this.heap);break;case 2:a=P(n,i,r,this.heap);break;case 3:a=_(n,s,i,r,o,this.heap)}for(let t=0,n=0|a.length;t<n;t=t+T|0){const n=a[t],s=a[t+1],i=a[t+2];let r=-1;switch(T){case 1:r=this.calcMortonNumber(n,0,0);break;case 2:r=this.calcMortonNumber(n,0,s);break;case 3:r=this.calcMortonNumber(n,s,i)}-1===r||e.includes(r)||e.push(r)}if(D>=M)break;D=Math.min(M,(0,v._1)(D+O,M,1e5,Math.ceil))}0===O&&(l.sx=h,l.sy=c,l.sz=d,l.ex=g,l.ey=p,l.ez=f)}this.appendCells(t,e)}l.x=n,l.y=s,l.z=i,l.rx=r,l.ry=o}}}var N=n(424),I=n(749);var R=n(34);class V{constructor(e){this.id=(0,N.D)(),this.components=new Array,this.entity=e;for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];this.components.push(...n)}hasEntity(e){return e instanceof this.entity&&!this.components.some((t=>!e.hasComponent(t)))}additional(e,t,n){}movable(e,t,n){}physical(e,t,n){}offset(e,t,n){}preadditional(e,t){}premovable(e,t){}prephysical(e,t){}preoffset(e,t){}ending(e,t){}rendering(e,t){}destructor(e,t){}}class j extends class{constructor(e){this.id=(0,N.D)(),this.components=new WeakMap,this.live=!0,this.isUpdate=!0;for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];this.setComponents(...n),this.names="".concat(e.length>0?"".concat(e," "):"").concat(this.id).split(" ")}getID(){return this.id}getNames(){return[...this.names]}addNames(){for(let e=0,t=0|arguments.length;e<t;e=e+1|0){const t=e<0||arguments.length<=e?void 0:arguments[e];this.names.includes(t)||(this.names.push(t),this.isUpdate=!0)}}removeNames(){for(let e=0,t=0|arguments.length;e<t;e=e+1|0){const t=e<0||arguments.length<=e?void 0:arguments[e];this.names.includes(t)&&(this.names.splice(this.names.indexOf(t),1),this.isUpdate=!0)}}hasComponent(e){return this.components.has(e)}setComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>{if(!e)return;let t=e;do{this.components.set(t.constructor,e)}while(null!==(t=t.constructor.prototype.__proto__));this.isUpdate=!0}))}getComponent(e){return this.components.get(e)}removeComponent(e){this.components.has(e)&&(this.components.delete(e),this.isUpdate=!0)}checkUpdate(){const{isUpdate:e}=this;return this.isUpdate=!1,e}hasUpdate(){return this.isUpdate}hasLive(){return this.live}remove(){this.live=!1}destroy(){}}{constructor(){super(...arguments),this.position=new a.P(0,0,0),this.direction=new a.P(0,0,0)}}class q{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.size=new a.FM(e,t),this.treeFix=n}}class X{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.material=e,this.scale=t,this.rotate=n,this.bounding=s,this.flip={x:i,y:a}}}class W{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.axes={x:e,y:t,z:n},this.bottom=s}}class U{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.fix=new a.P(0,0,0),this.fixRotate=0,this.position=new a.P(e,t,n),this.scale=s,this.rotate=i}}class Y{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Array,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.init=!1,this.enable=!0,this.old=new a.P(-1,-1,-1),this.targets=new Array,this.size=new a.FM(e,t),this.filter=n,this.treeFix=s}}class H{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.size=new a.FM(e,t),this.treeFix=n}}class G{constructor(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.cost=0,this.x=e,this.y=t,this.z=n,this.stepX=s,this.stepY=i,this.stepZ=a,this.step=null===r?0:r.step+1,this.prev=r}getCost(e,t,n){return(0,a.X6)(e,t,n,this.x,this.y,this.z)+this.step}}class Z{constructor(){this.stacks=new Array,this.queue=new Array,this.sorts=new WeakMap,this.block={block:!1}}find(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e=>({block:!1}),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e=>!0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e=>e.step,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:()=>!0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:()=>0;const h=[];return new Promise(((c,d)=>{if(!e.hasFinish())return;const g=(3===e.dimension?M:x).slice(),{block:p}=this;let f=0;e.begin(.5+(0|t),.5+(0|n),.5+(0|s));const m=this;this.queue.push(function*(){yield()=>0;let t=!1;do{t&&(0,u.qr)(e.searchPoint).asc((e=>e.cost)),t=!1;const n=e.searchPoint.shift();if(void 0===n||!o())break;if(a(n)){e.close(n),c(null);break}(0,u.Sy)(g);for(let s=0|g.length;f<s;f=f+1|0){const[s,a,o]=g[f],h=s+(0|n.x)|0,c=a+(0|n.y)|0,u=o+(0|n.z)|0;let d=m.stacks.shift()||null;null===d?d=new G(h+.5,c+.5,u+.5,s,a,o,n):(d.x=h+.5,d.y=c+.5,d.z=u+.5,d.stepX=s,d.stepY=a,d.stepZ=o,d.prev=n,d.cost=0),p.block=!1,delete p.label,i(d,p);let y="".concat(h,",").concat(c,",").concat(u);void 0!==p.label&&(y="".concat(y,"-").concat(p.label)),e.hasSearch[y]||(e.hasSearch[y]=!0,p.block||(d.cost=r(d),t=!0,e.searchPoint.push(d))),yield l}f=0,h.push(n)}while(e.searchPoint.length>0);return e.close(null),d(),!0}())})).finally((()=>{this.stacks.push(...h)}))}update(e){(0,u.qr)(this.queue).asc((e=>(this.sorts.get(e)||(()=>0))()));const t=performance.now();do{const e=this.queue.shift()||null;if(null===e)break;{const t=e.next();t.done||(this.sorts.set(e,t.value),this.queue.push(e))}}while(performance.now()-t<e&&this.queue.length>0)}}var K=n(220);class Q{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.position=new a.P(e,t,n)}}class ${constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.value=e}}const J=.23964497041420119,ee=[[0,0],[1,0],[0,1],[-1,0],[0,-1],[1,1],[1,-1],[-1,1],[-1,-1]];function te(e,t){return e.top===t.top&&e.bottom===t.bottom&&e.right===t.right&&e.left===t.left&&e.front===t.front&&e.back===t.back&&e.flipXRight===t.flipXRight&&e.flipYRight===t.flipYRight&&e.flipXLeft===t.flipXLeft&&e.flipYLeft===t.flipYLeft&&e.flipXFront===t.flipXFront&&e.flipYFront===t.flipYFront&&e.flipXBack===t.flipXBack&&e.flipYBack===t.flipYBack&&e.flipXTop===t.flipXTop&&e.flipYTop===t.flipYTop&&e.flipXBottom===t.flipXBottom&&e.flipYBottom===t.flipYBottom&&e.position.x===t.position.x&&e.position.y===t.position.y&&e.position.z===t.position.z}function ne(e,t,n,s,i){e[t*n+s]=i}class se{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.data=e,this.width=t,this.height=n,this.depth=s}}class ie{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;this.buffers={},this.clusterAABBs=new Array,this.clusterBoxX=0,this.clusterBoxY=0,this.clusterWidth=0,this.clusterHeight=0,this.dists=new WeakMap,this.billboardPropLength=14,this.voxelPropLength=21,this.oldScene=null,this.setting=e,this.maxTextureSize=t,this.maxDrawDistance=n}getClusterResolution(){return this.setting.clusterResolution||16}getBuffer(e){return l()?this.buffers[e]:new se(this.buffers[e].data.slice(),this.buffers[e].width,this.buffers[e].height,this.buffers[e].depth)}requireBuffer(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const[a,r,o]=function(e,t){return[Math.min(t,e),Math.min(t,1+Math.floor(e/t)),Math.min(t,1+Math.floor(Math.floor(e/t)/t))]}(n,this.maxTextureSize),l=a*r*o*s;return(i||!this.buffers.hasOwnProperty(e)||this.buffers[e].data.length<l)&&(this.buffers[e]=new se(c(t,l,i),a,r,o)),this.buffers[e]}lightCullingData(e){const t=new Array,n=e.getCamera(),s=e.getSun(),i=e.getEntitys();if(n.hasComponent($)){const{position:e,direction:t}=n,s=n.getComponent($).value;if(null!==s){let i=new a.P(0,0,0);n.hasComponent(Q)&&(i=n.getComponent(Q).position);const[r,o]=(0,a.t6)(s.direction.x,i.x,i.z);e.x=s.position.x+r,e.y=s.position.y+i.y,e.z=s.position.z+o,t.x=s.direction.x,t.y=s.direction.y,t.z=s.direction.z}}for(let e=0,s=0|i.length;e<s;e=e+1|0){const s=i[e];if(s&&!s.hasLive()||!(s instanceof j)||!s.hasComponent(X)||!s.hasComponent(W))continue;const{direction:r,position:o}=s;if(s.hasComponent(U)&&s.hasComponent($)){const e=s.getComponent(U),t=s.getComponent(X),i=s.getComponent($);if(null!==i.value){const{position:s,direction:l}=i.value,[h,c,u]=(0,a.c8)(l.x,l.y,e.position.x*(e.position.z/J),e.position.y*(e.position.z/J),e.position.z);o.x=s.x+h,o.y=s.y+c,o.z=s.z+u;const[d,g,p]=(0,a.c8)(l.x,l.y,e.position.x*(e.position.z/n.fov),e.position.y*(e.position.z/n.fov),e.position.z);e.fix.x=s.x+d,e.fix.y=s.y+g,e.fix.z=s.z+p,t.scale=e.scale*(e.position.z/J);let f=0;if(l.y>=0){f+=(0,a.B8)(l.x),f+=Math.PI/16*(Math.abs(e.position.x)/.25)*(e.position.x>0?1:-1)*(Math.abs(Math.max(0,J-.5))/.5)*((a.uB-l.y)/a.uB);let t=f+Math.sin(2*(0,a.KO)(o.x,o.z,i.value.position.x,i.value.position.z))*(Math.PI/16*(Math.abs(Math.max(0,J-.5))/.5)*(1-Math.abs(Math.sin(l.y))));t+=Math.sin(2*(0,a.KO)(o.x,o.z,i.value.position.x,i.value.position.z))*(Math.PI/16*(Math.abs(Math.max(0,.5-J))/.25)*Math.abs(Math.sin(l.y))),t+=Math.sin(2*(0,a.KO)(o.x,o.z,i.value.position.x,i.value.position.z))*(Math.PI/32*Math.abs(Math.cos(2*l.y)))*(Math.abs(e.position.x)/.25),f=(0,v.CD)(t,f,Math.max(0,Math.min(1,((r.y-Math.PI/3.5)/.5+1)/2))),f+=((.5-Math.abs(l.y)/(Math.PI/2))/.5*(Math.PI/16)+Math.PI/16)*(e.position.x>0?-1:1)*Math.min(1,Math.abs(e.position.x)/.25)}else f+=Math.PI/(16-Math.abs(Math.max(0,.5-J))/.5*6)*(Math.abs(e.position.x)/.25)*(e.position.x>0?-1:1)*(Math.abs(l.y)/a.uB),f+=(Math.sin(r.x)+a.uB*Math.sign(e.position.x)*(Math.abs(Math.max(0,.5-J))/.25))*(Math.PI/16+Math.abs(Math.max(0,J-.5))/.25*16*Math.cos(-l.y))*(Math.abs(e.position.x)/.25),f+=(Math.abs(l.y)/a.uB*(Math.PI/5)-Math.PI/32)*(e.position.x>0?-1:1)*Math.min(1,Math.abs(e.position.x)/.25);e.fixRotate=f,t.rotate=e.rotate}}const l=o.x,h=o.y+s.getComponent(W).bottom*s.getComponent(X).scale,c=o.z,u=(0,a.X6)(l,h,c,n.position.x,n.position.y,n.position.z);if(u>this.maxDrawDistance)continue;const[d,g]=(0,a.tx)(l,h,c,n.position.x,n.position.y,n.position.z),[p,f]=(0,a.vr)(d,g,n.direction.x,n.direction.y);p>Math.PI/2&&f>Math.PI/2||(this.dists.set(s,u),t.push(s))}return t.length>1&&(0,u.qr)(t).asc((e=>this.dists.get(e))),{billboards:t,camera:{position:{x:n.position.x,y:n.position.y,z:n.position.z},direction:{x:n.direction.x,y:n.direction.y,z:n.direction.z},fov:n.fov,zoom:n.zoom,light:n.light},sun:{direction:{x:s.direction.x,y:s.direction.y}}}}frustumCullingData(e,t,n){const{clusterWidth:s,clusterHeight:i,clusterAABBs:r,clusterBoxX:o,clusterBoxY:l}=this,[h,c]=e.getSize(),u=h/Math.min(h,c),d=c/Math.min(h,c),p=t.getCamera(),f=p.fov*p.zoom,m=[...new Array(s*i)].map((()=>[])),y=new Array,w=o*u,b=l*d,[v,x,M,S,k,P,_,E,O]=(0,a.gJ)(p.direction.x,p.direction.y,f);let A=0;for(let e=0,t=0|n.length;e<t;e=e+1|0){const t=n[e],{position:o}=t,l=t.getComponent(W),h=t.getComponent(X),c=o.x,L=o.y+l.bottom*h.scale,C=o.z;let[T,D,F]=(0,a.iV)(p.position.x,p.position.y,p.position.z,c,L,C,h.scale,v,x,M,S,k,P,_,E,O,p.direction.z,t.hasComponent(U)?J:f);F*=h.bounding;const z=Math.floor(Math.min(s*w,Math.max(0,T+s*w/2-F))/w),B=Math.floor(Math.min(i*b,Math.max(0,D+i*b/2-F))/b),N=Math.floor(Math.min(s*w,Math.max(0,T+s*w/2+F))/w),I=Math.floor(Math.min(i*b,Math.max(0,D+i*b/2+F))/b),R=Math.min(z,N),V=Math.min(B,I),j=Math.max(z,N),q=Math.max(B,I);if(j<0||q<0||R>=s||V>=i)continue;let Y=!1;for(let e=0|V,t=q+1|0;e<t;e=e+1|0)for(let t=0|R,n=j+1|0;t<n;t=t+1|0){if(t<0||e<0||t>=s||e>=i)continue;const n=e*s+t|0;if(!g(T,D,F,r[2*n]*u,r[2*n+1]*d,w,b))continue;const a=m[n]||null;null!==a&&a.push(A),Y=!0}Y&&(y.push({id:A,entity:t}),A++)}return{bind_entitys:y,cullings:m}}buildEntitys(e,t){const{billboardPropLength:n}=this,s=this.requireBuffer("billboard_parameters","float32",Math.max(n,t.length*n),1,!0),i=e.getMaterialManager().getMaterials();for(let e=0,r=0|t.length;e<r;e=e+1|0){const{id:r,entity:o}=t[e],{position:l}=o,h=o.getComponent(X),c=o.getComponent(W),u=o.hasComponent(U);ne(s.data,n,r,0,l.x),ne(s.data,n,r,1,l.y+c.bottom*h.scale),ne(s.data,n,r,2,l.z),ne(s.data,n,r,3,h.scale),ne(s.data,n,r,4,h.bounding),ne(s.data,n,r,5,u?o.getComponent(U).fix.x:c.axes.x?1:0),ne(s.data,n,r,6,u?o.getComponent(U).fix.y:c.axes.y?1:0),ne(s.data,n,r,7,u?o.getComponent(U).fix.z:c.axes.z?1:0),ne(s.data,n,r,8,(0,a.B8)(h.rotate)),ne(s.data,n,r,9,h.flip.x?-1:1),ne(s.data,n,r,10,h.flip.y?-1:1),ne(s.data,n,r,11,u?1:0),ne(s.data,n,r,12,u?(0,a.B8)(o.getComponent(U).fixRotate):0),ne(s.data,n,r,13,i.indexOf(h.material)||0)}return{billboard_parameters:s}}buildCullingData(e){const t=this.requireBuffer("cluster_list","int32",Math.max(1,e.length),1,!0),n=this.requireBuffer("item_list","int32",Math.max(1,e.reduce(((e,t)=>e+t.length),0)),1,!0);for(let s=0,i=0|e.length;s<i;s=s+1|0){const i=e[s],a=s>0?t.data[s-1]:0;t.data[s]=a+i.length;for(let e=0,t=0|i.length;e<t;e=e+1|0)n.data[a+e]=i[e]}return{cluster_list:t,item_list:n}}buildMaterials(e,t,n){if(!e.checkUpdate()&&!t.checkUpdate()&&!n)return{materials:null,sync_materials:!1};const s=[],i=t.getMaterials();for(const t in i){const n=Number(t);if(isNaN(n))continue;const a=i[n];s[n]=e.getBufferLocation(a.src,a.index)}const a=this.requireBuffer("materials","int32",Math.max(1,s.length),1);for(let e=0,t=0|s.length;e<t;e=e+1|0)a.data[e]=s[e]||0;return{materials:this.getBuffer("materials"),sync_materials:!0}}buildVoxels(e,t,n){if(!t.checkUpdate()&&!n)return{voxels:null,sync_voxels:!1};const s=[],i=t.getVoxels(),{voxelPropLength:a}=this;for(const t in i){const n=Number(t);if(isNaN(n))continue;const r=i[n];if(null===r)for(let e=0,t=0|a;e<t;e=e+1|0)s[n*a+e]=0;else{const t=e.getTileSet(),i=e.getMaterials();s[n*a+0]=r.position.x,s[n*a+1]=r.position.y,s[n*a+2]=r.position.z,null!==t?(s[n*a+3]=Object.values(i).indexOf(t[r.front]),s[n*a+4]=Object.values(i).indexOf(t[r.back]),s[n*a+5]=Object.values(i).indexOf(t[r.right]),s[n*a+6]=Object.values(i).indexOf(t[r.left]),s[n*a+7]=Object.values(i).indexOf(t[r.top]),s[n*a+8]=Object.values(i).indexOf(t[r.bottom])):(s[n*a+3]=Object.values(i).indexOf(i.NONE),s[n*a+4]=Object.values(i).indexOf(i.NONE),s[n*a+5]=Object.values(i).indexOf(i.NONE),s[n*a+6]=Object.values(i).indexOf(i.NONE),s[n*a+7]=Object.values(i).indexOf(i.NONE),s[n*a+8]=Object.values(i).indexOf(i.NONE)),s[n*a+9]=r.flipXFront?-1:1,s[n*a+10]=r.flipYFront?-1:1,s[n*a+11]=r.flipXBack?-1:1,s[n*a+12]=r.flipYBack?-1:1,s[n*a+13]=r.flipXRight?-1:1,s[n*a+14]=r.flipYRight?-1:1,s[n*a+15]=r.flipXLeft?-1:1,s[n*a+16]=r.flipYLeft?-1:1,s[n*a+17]=r.flipXTop?-1:1,s[n*a+18]=r.flipYTop?-1:1,s[n*a+19]=r.flipXBottom?-1:1,s[n*a+20]=r.flipYBottom?-1:1}}const r=this.requireBuffer("voxels","float32",Math.max(a,s.length),1);for(let e=0,t=0|s.length;e<t;e=e+1|0)r.data[e]=s[e]||0;return{voxels:this.getBuffer("voxels"),sync_voxels:!0}}getMaxDrawDistance(){return this.maxDrawDistance}setMaxDrawDistance(e){this.maxDrawDistance=e}createData(e,t,n,s){const i=e.getRendererManager(),r=e.getMaterialManager(),o=e.getVoxelManager(),h=this.oldScene!==e.getName()||s;this.oldScene=e.getName();const c=e.getMap(),u=e.getLateTime();let d=null,g=null,p=null,f=null,m=null,y=null;const w=[],b=[];if(n){p=[this.getClusterResolution(),this.getClusterResolution()];const t=p[0],n=p[1];if(this.clusterWidth!==t||this.clusterWidth!==n){const[e,s,i]=(0,a.xv)(t,n,this.requireBuffer("frustum","float32",t,2*n).data);this.clusterAABBs=e,this.clusterBoxX=s,this.clusterBoxY=i,this.clusterWidth=t,this.clusterHeight=n}const{billboards:s,camera:r,sun:o}=this.lightCullingData(e),{bind_entitys:l,cullings:h}=this.frustumCullingData(i,e,s),{billboard_parameters:c}=this.buildEntitys(e,l),{cluster_list:u,item_list:b}=this.buildCullingData(h);d=r,g=o,f=c,m=u,y=b,w.push(f.data.buffer,m.data.buffer,y.data.buffer)}const{materials:v,sync_materials:x}=this.buildMaterials(t,r,h),{voxels:M,sync_voxels:S}=this.buildVoxels(e,o,h),k=e.getBackground(),P=c.checkUpdate(),_=c.getFilter(),E=c.getDistanceField();return l()||(_&&(P||h)&&b.push(_.buffer),null!==E&&(P||h)&&b.push(E.buffer),null!==v&&(x||h)&&b.push(v.data.buffer),null!==M&&(S||h)&&b.push(M.data.buffer),null!==v&&(x||h)&&w.push(v.data.buffer),null!==M&&(S||h)&&w.push(M.data.buffer)),b.push(...w),[{camera:d,sun:g,map:{width:c.getSize()[0],height:c.getSize()[1],depth:c.getSize()[2],distance:c.getWorldDistance(),data:P||h?_:null},distance_field:(P||h)&&null!==E?{width:c.getSize()[0],height:c.getSize()[1],depth:c.getSize()[2],data:E}:null,materials:x||h?v:null,voxels:S||h?M:null,cluster_resolution:p,billboard_parameters:f,item_list:y,cluster_list:m,background:k,lateTime:u},w,b]}}const ae=[30,60,90,120,1/0];class re{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.setting=e,this.init(t)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.setFramerate(this.setting.hasOwnProperty("framerate")?this.setting.framerate:1),this.setFOV(this.setting.hasOwnProperty("fov")?this.setting.fov:130,e),this.setInnerDeadzoneX(this.setting.stickInnerDeadzoneX||0),this.setOuterDeadzoneX(this.setting.stickOuterDeadzoneX||0),this.setInnerDeadzoneY(this.setting.stickInnerDeadzoneY||0),this.setOuterDeadzoneY(this.setting.stickOuterDeadzoneY||0),this.setSoundVolume(this.setting.hasOwnProperty("soundVolume")?this.setting.soundVolume:1),this.setClusterResolution(this.setting.hasOwnProperty("clusterResolution")?this.setting.clusterResolution:16),this.setFullscreen(this.setting.hasOwnProperty("isFullscreen")?this.setting.isFullscreen:!!(0,i.Vp)()),this.setBrowserFullscreen(!!this.setting.hasOwnProperty("isBrowserFullscreen")&&this.setting.isBrowserFullscreen),this.setReolutionIndex(this.setting.hasOwnProperty("resolutionIndex")?this.setting.resolutionIndex:-1),this.setReflectionCount(this.setting.hasOwnProperty("reflectionCount")?this.setting.reflectionCount:2),this.setShadow(!this.setting.hasOwnProperty("isShadow")||this.setting.isShadow),this.setSoftShadow(!this.setting.hasOwnProperty("isSoftShadow")||this.setting.isSoftShadow),this.setRoughness(!this.setting.hasOwnProperty("isRoughness")||this.setting.isRoughness),this.setBloom(!this.setting.hasOwnProperty("isBloom")||this.setting.isBloom),this.setMuzzleFlash(!this.setting.hasOwnProperty("isMuzzleFlash")||this.setting.isMuzzleFlash),this.setPixelizedLighting(!this.setting.hasOwnProperty("isPixelizedLighting")||this.setting.isPixelizedLighting),this.setLightingDotScale(this.setting.hasOwnProperty("lightingDotScale")?this.setting.lightingDotScale:1),this.setBlurDotScale(this.setting.hasOwnProperty("blurDotScale")?this.setting.blurDotScale:4),this.setContrast(this.setting.hasOwnProperty("contrast")?this.setting.contrast:1),this.setBrightness(this.setting.hasOwnProperty("brightness")?this.setting.brightness:1),this.setCRTEnable(!!this.setting.hasOwnProperty("isCRT")&&this.setting.isCRT),this.setCRTSubPixel(this.setting.hasOwnProperty("crtSubPixel")?this.setting.crtSubPixel:3),this.setCRTLens(this.setting.hasOwnProperty("crtLens")?this.setting.crtLens:.075),this.setCRTDeep(this.setting.hasOwnProperty("crtDeep")?this.setting.crtDeep:.075),this.setCRTEdge(this.setting.hasOwnProperty("crtEdge")?this.setting.crtEdge:.025),this.setCRTVig(this.setting.hasOwnProperty("crtVig")?this.setting.crtVig:.175),this.setCRTShadowMask(!!this.setting.hasOwnProperty("isCRTShadowMask")&&this.setting.isCRTShadowMask),this.setHUD(!this.setting.hasOwnProperty("isHUD")||this.setting.isHUD),this.setSensibility(this.setting.hasOwnProperty("sensibility")?this.setting.sensibility:50),this.setInvertX(!!this.setting.hasOwnProperty("invertX")&&this.setting.invertX),this.setInvertY(!!this.setting.hasOwnProperty("invertY")&&this.setting.invertY),this.setBob(!this.setting.hasOwnProperty("bob")||this.setting.bob),this.setToggleSprint(!this.setting.hasOwnProperty("toggleSprint")||this.setting.toggleSprint),this.setToggleCluch(!this.setting.hasOwnProperty("toggleCluch")||this.setting.toggleCluch),this.setWeaponChargeStandTime(this.setting.hasOwnProperty("weaponChargeStandTime")?this.setting.weaponChargeStandTime:180),this.setWeaponWheelStandTime(this.setting.hasOwnProperty("weaponWheelStandTime")?this.setting.weaponWheelStandTime:180),this.setEatSound(!this.setting.hasOwnProperty("eatSound")||this.setting.eatSound),this.setCheckPoint(!this.setting.hasOwnProperty("isCheckPoint")||this.setting.isCheckPoint),this.setDeadLoseWeapon(!!this.setting.hasOwnProperty("isDeadLoseWeapon")&&this.setting.isDeadLoseWeapon),this.setPermaDeath(!!this.setting.hasOwnProperty("isPermaDeath")&&this.setting.isPermaDeath),this.setSSSSlowMo(!this.setting.hasOwnProperty("isSSSSlowMo")||this.setting.isSSSSlowMo),this.setRandomWeaponDrop(this.setting.hasOwnProperty("randomWeaponDrop")?this.setting.randomWeaponDrop:0),this.setRandomHeightEnemy(this.setting.hasOwnProperty("randomHeightEnemy")?this.setting.randomHeightEnemy:1),this.setNotSpawnAcotrs(!!this.setting.hasOwnProperty("isNotSpawnActors")&&this.setting.isNotSpawnAcotrs),this.setDebugLog(!!this.setting.hasOwnProperty("isDebugLog")&&this.setting.isDebugLog)}reset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;for(const e in this.setting)delete this.setting[e];this.init(e)}saveSetting(){(0,s.nL)("setting")}setHUD(e){this.setting.isHUD=e,this.saveSetting()}setSensibility(e){this.setting.sensibility=e,this.saveSetting()}setInvertX(e){this.setting.invertX=e,this.saveSetting()}setInvertY(e){this.setting.invertY=e,this.saveSetting()}setBob(e){this.setting.bob=e,this.saveSetting()}setToggleSprint(e){this.setting.toggleSprint=e,this.saveSetting()}setToggleCluch(e){this.setting.toggleCluch=e,this.saveSetting()}setWeaponChargeStandTime(e){this.setting.weaponChargeStandTime=e,this.saveSetting()}setWeaponWheelStandTime(e){this.setting.weaponWheelStandTime=e,this.saveSetting()}setEatSound(e){this.setting.eatSound=e,this.saveSetting()}setCheckPoint(e){this.setting.isCheckPoint=e,this.saveSetting()}setDeadLoseWeapon(e){this.setting.isDeadLoseWeapon=e,this.saveSetting()}setPermaDeath(e){this.setting.isPermaDeath=e,this.saveSetting()}setSSSSlowMo(e){this.setting.isSSSSlowMo=e,this.saveSetting()}setRandomWeaponDrop(e){this.setting.randomWeaponDrop=e,this.saveSetting()}setRandomHeightEnemy(e){this.setting.randomHeightEnemy=e,this.saveSetting()}setNotSpawnAcotrs(e){this.setting.isNotSpawnActors=e,this.saveSetting()}setDebugLog(e){this.setting.isDebugLog=e,this.saveSetting()}setFOV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!==t&&t.getScenes().forEach((t=>{if(!(t instanceof class extends class extends class extends class extends class{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.speed=1,this.maxFrameSkipCount=5,this.framerate=60,this.update=0,this.reqAnim=null,this.timeout=null,this.updateTime=-1,this.nextGameTick=-1,this.paintTime=-1,this.skipFrameCount=-1,this.isSkip=!1,this.stackTick=0,this.isSleep=!1,this.isError=!1,this.isUpdateDefault=!1,this.isPaintDefault=!1,self.addEventListener("error",(()=>{this.error()})),this.useAnimationFrame=e}error(){this.isError=!0,this.stop(),new I.j(this,"error").trigger()}sleep(){this.isSleep=!0,new I.j(this,"sleep").trigger({})}unsleep(){this.isSleep=!1,new I.j(this,"unsleep").trigger()}updateDefault(){this.isUpdateDefault=!0}paintDefault(){this.isPaintDefault=!0}getFramerate(){return(0,i.Vp)()?60:1/0}reset(){let e=!1;return null!==this.reqAnim&&(cancelAnimationFrame(this.reqAnim),e=!0),this.updateTime=-1,this.nextGameTick=-1,this.paintTime=-1,this.skipFrameCount=-1,this.stackTick=0,this.reqAnim=null,e}tickFunc(e){if(this.requestTick(),-1===this.updateTime&&(this.updateTime=e),-1===this.nextGameTick&&(this.nextGameTick=e),-1===this.paintTime&&(this.paintTime=e),-1===this.skipFrameCount&&(this.skipFrameCount=this.maxFrameSkipCount),this.isSleep)return this.updateTime=e,this.paintTime=e,this.nextGameTick=e,void(this.skipFrameCount=this.maxFrameSkipCount);const t=e-this.updateTime;this.updateTime=e;const n=Math.max(60,this.getFramerate()),s=(0,v._1)(1e3/t,n);this.framerate=Math.min(n,s);let i=0,a=e;for(;;){if((this.update>0||i>0)&&(performance.now()-this.paintTime>=1e3/this.getFramerate()||this.isPaintDefault)&&(this.useAnimationFrame&&"requestAnimationFrame"in self?null===this.reqAnim&&(this.reqAnim=requestAnimationFrame((()=>{new I.j(this,"paint").trigger({now:e,framerate:s,fps:this.getFramerate()}),this.reqAnim=null})),this.isPaintDefault=!1,this.paintTime=e):(new I.j(this,"paint").trigger({now:e,framerate:s,fps:this.getFramerate()}),this.isPaintDefault=!1,this.paintTime=e)),this.nextGameTick>=e){this.isSkip||(this.skipFrameCount=Math.min(this.maxFrameSkipCount,this.skipFrameCount+.5)),this.isSkip=!1;break}if(i>=this.skipFrameCount){this.skipFrameCount=Math.max(1,this.skipFrameCount-1|0),this.stackTick=e-this.nextGameTick,this.isSkip=!0;break}0===i&&new I.j(this,"updatebegin").trigger({now:e,framerate:s,fps:this.getFramerate()}),i++;const t=performance.now(),n=t-a+this.stackTick;a=t;const r=n/(1e3/60)*this.speed;new I.j(this,"update").trigger({time:r,now:e,framerate:s,fps:this.getFramerate()}),this.stackTick=0,this.nextGameTick+=n}const r=Math.max(0,t-(performance.now()-e));(i>0||this.isUpdateDefault)&&(this.isUpdateDefault=!1,new I.j(this,"updateend").trigger({time:r/(1e3/60),now:e,framerate:s,fps:this.getFramerate()})),this.paintTime===e?this.update=0:this.update+=i}requestTick(){null===this.timeout&&(this.timeout=setTimeout((()=>{const e=performance.now();this.timeout=null,this.tickFunc(e)})))}cancelTick(){return null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null,!0)}run(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!(this.isError||this.hasRun()||this.isSleep&&!e||(this.reset(),this.isSleep=!1,this.requestTick(),0))}stop(){return!this.hasRun()||(this.reset(),this.cancelTick())}getNowFramerate(){return this.framerate}hasRun(){return null!==this.timeout}hasSleep(){return this.isSleep}getSpeed(){return this.speed}getMaxSkipFrameCount(){return this.maxFrameSkipCount}setSpeed(e){this.speed=e}setMaxSkipFrameCount(){return this.maxFrameSkipCount}clear(){this.setSpeed(1)}}{constructor(){super(...arguments),this.id=(0,N.D)(),this.additionals=new Array,this.movables=new Array,this.physicals=new Array,this.offsets=new Array,this.preadditionals=new Array,this.premovables=new Array,this.prephysicals=new Array,this.preoffsets=new Array,this.endings=new Array,this.renderings=new Array,this.destructors=new Array,this.heapSystem=new WeakMap,this.entitys=new Array,this.stands=new Array,this.entitysID={},this.entitysName={}}getID(){return this.id}addSystems(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>{e.additional!==V.prototype.additional&&this.additionals.push(e),e.movable!==V.prototype.movable&&this.movables.push(e),e.physical!==V.prototype.physical&&this.physicals.push(e),e.offset!==V.prototype.offset&&this.offsets.push(e),e.preadditional!==V.prototype.preadditional&&this.preadditionals.push(e),e.premovable!==V.prototype.premovable&&this.premovables.push(e),e.prephysical!==V.prototype.prephysical&&this.prephysicals.push(e),e.preoffset!==V.prototype.preoffset&&this.preoffsets.push(e),e.rendering!==V.prototype.ending&&this.endings.push(e),e.rendering!==V.prototype.rendering&&this.renderings.push(e),e.destructor!==V.prototype.destructor&&this.destructors.push(e)}))}check(){for(;this.stands.length>0;){const e=this.stands.shift()||null;if(null===e||!e.hasLive()||this.entitys.includes(e))continue;this.entitys.push(e),this.entitysID[e.getID()]=e;const t=e.getNames();for(let n=0,s=0|t.length;n<s;n=n+1|0){const s=t[n];this.entitysName.hasOwnProperty(s)||(this.entitysName[s]=new Array),this.entitysName[s].push(e)}}}syncEntitys(){const e=[...this.additionals,...this.movables,...this.physicals,...this.offsets,...this.renderings,...this.destructors];for(let t=0,n=0|arguments.length;t<n;t=t+1|0){const n=t<0||arguments.length<=t?void 0:arguments[t],s=n.getNames();for(let e=0,t=0|s.length;e<t;e=e+1|0){const t=s[e];this.entitysName.hasOwnProperty(t)||(this.entitysName[t]=new Array),this.entitysName[t].push(n)}for(const e in this.entitysName){const t=this.entitysName[e];t.includes(n)&&(t.splice(t.indexOf(n),1),0===t.length&&delete this.entitysName[e])}for(let t=0,s=0|e.length;t<s;t=t+1|0){const s=e[t];this.heapSystem.has(s)||this.heapSystem.set(s,new Array);const i=this.heapSystem.get(s)||[];s.hasEntity(n)?i.includes(n)||i.push(n):i.includes(n)&&i.splice(i.indexOf(n),1)}}}addEntitys(){for(let e=0,t=0|arguments.length;e<t;e=e+1|0){const t=e<0||arguments.length<=e?void 0:arguments[e];this.entitys.includes(t)||this.stands.includes(t)||this.stands.push(t)}}removeEntitys(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s;const i=[...this.additionals,...this.movables,...this.physicals,...this.offsets];for(let e=0,n=0|this.destructors.length;e<n;e=e+1|0){const n=this.destructors[e],i=((null===(s=this.heapSystem.get(n))||void 0===s?void 0:s.slice())||[]).filter((e=>t.includes(e)));for(let e=0,t=0|i.length;e<t;e=e+1|0){const t=i[e];(!t.hasUpdate()||n.hasEntity(t))&&n.destructor(t,this)}}for(let e=0,n=0|t.length;e<n;e=e+1|0){const n=t[e];this.entitys.splice(this.entitys.indexOf(n),1),delete this.entitysID[n.getID()];for(const e in this.entitysName){const t=this.entitysName[e];t.includes(n)&&(t.splice(t.indexOf(n),1),0===t.length&&delete this.entitysName[e])}n.destroy();for(let e=0,t=0|i.length;e<t;e=e+1|0){const t=i[e],s=this.heapSystem.get(t)||[];s.includes(n)&&s.splice(s.indexOf(n),1)}}}hasEntity(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some((e=>e.hasLive()&&-1!==Object.keys(this.entitys).indexOf(e.getID())))}getEntitys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>!0;return this.entitys.filter((t=>t.hasLive()&&e(t)))}getEntityOfID(e){if(!this.entitysID.hasOwnProperty(e))return null;const t=this.entitysID[e];return t.hasLive()?t:null}getEntitysOfName(){const e=new Array;for(let t=0,n=0|arguments.length;t<n;t=t+1|0){const n=t<0||arguments.length<=t?void 0:arguments[t];this.entitysName.hasOwnProperty(n)&&e.push(...this.entitysName[n].filter((t=>t.hasLive()&&!e.includes(t))))}return e}clear(){for(let e=0,t=0|this.stands.length;e<t;e=e+1|0)this.stands[e].remove();for(let e=0,t=0|this.entitys.length;e<t;e=e+1|0)this.entitys[e].remove();super.clear()}onupdate(e){var t,n,s,i;const{time:a,now:r,framerate:o,fps:l}=e;new I.j(this,"ecsbegin").trigger({time:a,now:r,framerate:o,fps:l});const h=new Array,c=new Array;let u=0;for(let e=0,t=0|this.entitys.length;e<t;e=e+1|0){const t=this.entitys[e];if(t.hasLive()){if(u++,!t.checkUpdate())continue;h.push(t)}else c.push(t)}h.length>0&&this.syncEntitys(...h),c.length>0&&this.removeEntitys(...c),(0,R.gw)("entity","entitys:".concat(u)),new I.j(this,"beforeadditional").trigger({time:a,now:r,framerate:o,fps:l});for(let e=0,t=0|this.preadditionals.length;e<t;e=e+1|0)this.preadditionals[e].preadditional(a,this);for(let e=0,n=0|this.additionals.length;e<n;e=e+1|0){const n=this.additionals[e],s=(null===(t=this.heapSystem.get(n))||void 0===t?void 0:t.slice())||[];for(let e=0,t=0|s.length;e<t;e=e+1|0){const t=s[e];t.hasLive()&&(!t.hasUpdate()||n.hasEntity(t))&&n.additional(a,t,this)}}new I.j(this,"beforemoveble").trigger({time:a,now:r,framerate:o,fps:l});for(let e=0,t=0|this.premovables.length;e<t;e=e+1|0)this.premovables[e].premovable(a,this);for(let e=0,t=0|this.movables.length;e<t;e=e+1|0){const t=this.movables[e],s=(null===(n=this.heapSystem.get(t))||void 0===n?void 0:n.slice())||[];for(let e=0,n=0|s.length;e<n;e=e+1|0){const n=s[e];n.hasLive()&&(!n.hasUpdate()||t.hasEntity(n))&&t.movable(a,n,this)}}new I.j(this,"beforephysical").trigger({time:a,now:r,framerate:o,fps:l});for(let e=0,t=0|this.prephysicals.length;e<t;e=e+1|0)this.prephysicals[e].prephysical(a,this);for(let e=0,t=0|this.physicals.length;e<t;e=e+1|0){const t=this.physicals[e],n=(null===(s=this.heapSystem.get(t))||void 0===s?void 0:s.slice())||[];for(let e=0,s=0|n.length;e<s;e=e+1|0){const s=n[e];s.hasLive()&&(!s.hasUpdate()||t.hasEntity(s))&&t.physical(a,s,this)}}new I.j(this,"beforeoffset").trigger({time:a,now:r,framerate:o,fps:l});for(let e=0,t=0|this.preoffsets.length;e<t;e=e+1|0)this.preoffsets[e].preoffset(a,this);for(let e=0,t=0|this.offsets.length;e<t;e=e+1|0){const t=this.offsets[e],n=(null===(i=this.heapSystem.get(t))||void 0===i?void 0:i.slice())||[];for(let e=0,s=0|n.length;e<s;e=e+1|0){const s=n[e];s.hasLive()&&(!s.hasUpdate()||t.hasEntity(s))&&t.offset(a,s,this)}}this.check(),new I.j(this,"ecsend").trigger({time:a,now:r,framerate:o,fps:l})}onupdateend(e){var t;for(let e=0,n=0|this.endings.length;e<n;e=e+1|0){const n=this.endings[e],s=(null===(t=this.heapSystem.get(n))||void 0===t?void 0:t.slice())||[];for(let e=0,t=0|s.length;e<t;e=e+1|0){const t=s[e];t.hasLive()&&(!t.hasUpdate()||n.hasEntity(t))&&n.ending(t,this)}}}onpaint(e){var t;for(let e=0,n=0|this.renderings.length;e<n;e=e+1|0){const n=this.renderings[e],s=(null===(t=this.heapSystem.get(n))||void 0===t?void 0:t.slice())||[];for(let e=0,t=0|s.length;e<t;e=e+1|0){const t=s[e];t.hasLive()&&(!t.hasUpdate()||n.hasEntity(t))&&n.rendering(t,this)}}}}{constructor(e,t,n,s,i,a){super(!1),this.name=e,this.scenes=t,this.renderers=n,this.assets=s,this.controls=i,this.sounds=a}getName(){return this.name}getRendererManager(){return this.renderers}getAssetManager(){return this.assets}getControlManager(){return this.controls}getSoundManager(){return this.sounds}createSound(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.sounds.create(e,t,null===n?(0,N.D)():n)}getSound(e){return this.sounds.getSound(e)}hasSound(e){return this.sounds.hasSound(e)}getSceneManager(){return this.scenes}clear(){const e=this.getSceneManager(),t=this.getControlManager();e.clear(),t.clear(),super.clear()}oninactive(){this.getControlManager().clear()}onupdatebegin(e){let{time:t,now:n,framerate:s,fps:i}=e;new I.j(this.getControlManager(),"update").trigger({time:t,now:n,framerate:s,fps:i})}onupdateend(e){const{time:t,now:n,framerate:s,fps:i}=e;new I.j(this.getSceneManager(),"update").trigger({time:t,now:n,framerate:s,fps:i}),new I.j(this.getRendererManager(),"update").trigger({time:t,now:n,framerate:s,fps:i}),new I.j(this.getSoundManager(),"update").trigger({time:t,now:n,framerate:s,fps:i})}}{constructor(e,t,n,s,i,a){super(e,t,n,s,i,a)}createTransferUIData(){return[]}}{constructor(e,t,n,s,i,r,o,l,h,c,u,d,g,p,f,m){super(e,o,l,h,c,u),this.isForceUpdate=!1,this.tile_set=null,this.background=null,this.mats={},this.lateTime=0,this.trees={range:new B((e=>e instanceof j&&e.hasComponent(q)),(e=>{if(!(e instanceof j))return[-1,-1,-1,-1,-1];const t=e.getComponent(q),n=t.treeFix&&e.hasComponent(Q)?e.getComponent(Q).position:new a.P(0,0,0);return[e.position.x+n.x,e.position.y+n.y,e.position.z+n.z,t.size.x,t.size.y]})),hitbox:new B((e=>e instanceof j&&e.hasComponent(H)),(e=>{if(!(e instanceof j))return[-1,-1,-1,-1,-1];const t=e.getComponent(H),n=t.treeFix&&e.hasComponent(Q)?e.getComponent(Q).position:new a.P(0,0,0);return[e.position.x+n.x,e.position.y+n.y,e.position.z+n.z,t.size.x,t.size.y]})),collision:new B((e=>e instanceof j&&e.hasComponent(Y)),(e=>{if(!(e instanceof j))return[-1,-1,-1,-1,-1];const t=e.getComponent(Y),n=t.treeFix&&e.hasComponent(Q)?e.getComponent(Q).position:new a.P(0,0,0);return[e.position.x+n.x,e.position.y+n.y,e.position.z+n.z,t.size.x,t.size.y]}))},this.finder=new Z,this.margin=i,this.materials=d,this.voxels=g,this.camera=f,this.sun=m,this.addEntitys(f,m),this.transferDataBuilder=new ie(p,r,1/0),this.offset={top:i,bottom:i,front:i,back:i,right:i,left:i},this.map=new D(t,n,s,"int32",1,1)}initTrees(e){for(const t in this.trees){const n=this.trees[t];n.hasEntity(e)&&n.initOldPosition(e)}}addEntitys(){for(let e=0,t=0|arguments.length;e<t;e=e+1|0){const t=e<0||arguments.length<=e?void 0:arguments[e];for(const e in this.trees)this.trees[e].add(t)}super.addEntitys(...arguments)}removeEntitys(){for(let e=0,t=0|arguments.length;e<t;e=e+1|0){const t=e<0||arguments.length<=e?void 0:arguments[e];for(const e in this.trees)this.trees[e].remove(t)}super.removeEntitys(...arguments)}getMaterialManager(){return this.materials}getVoxelManager(){return this.voxels}getMap(){return this.map}getWorldDistance(){return this.map.getWorldDistance()}getWorldSize(){return this.map.getSize()}getCamera(){return this.camera}getSun(){return this.sun}getMargin(){return this.margin}getOffset(){return this.offset}getVoxel(e,t,n){return this.getVoxelManager().getVoxel(this.map.get(0,e,t,n)-1)}getDistanceField(e,t,n){let s=this.map.get(0,e,t,n,this.map.getDistanceField(),this.map.getSize());return-1===s?0:s}getMaterials(){return this.mats}getTileSet(){return this.tile_set}getBackground(){return this.background||{theme:0,rise_up_color:[50/255,125/255,50/255],night_up_color:[50/255,125/255,50/255],rise_down_color:[100/255,125/255,50/255],night_down_color:[100/255,125/255,50/255],material_up:[1,.625,.075],material_down:[1,.625,0],noise_size:5,noise_length:2}}getLateTime(){return this.lateTime}getTree(e){return this.trees[e]||null}setWorldSize(e,t,n,s,i,a,r,o,l){this.map.setSize(e,t,n),this.offset.top=s,this.offset.bottom=i,this.offset.front=a,this.offset.back=r,this.offset.right=o,this.offset.left=l}setActorPosition(e,t,n,s){e.position.x=t,e.position.y=n,e.position.z=s;for(const t in this.trees)this.trees[t].setOldPosition(e)}setCamera(e){this.camera=e}setSun(e){this.sun=e}setTileSet(e){this.tile_set!==e&&(this.isForceUpdate=!0),this.tile_set=e}setBackground(e){this.background=e}setMaterials(e){for(const t in e)this.mats[t]=e[t]}setVoxel(e,t,n,s){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const r=this.getVoxelManager(),o=r.getVoxels(),l=this.map.get(0,e,t,n)-1,h=r.getVoxel(l);l>0&&this.map.getCount(l+1)<=0&&(h!==K.xZ||h!==K.g7)&&r.removeVoxels(h);let c=!1;for(let e=0,t=0|o.length;e<t;e=e+1|0){const t=o[e];if(null!==t&&te(t,s)){c=!0;break}}c||r.addVoxels(s);const u=o.find((e=>null!==e&&te(e,s)));if(void 0!==u){const s=o.indexOf(u)+1;this.map.set(0,e,t,n,s,i)}a&&(s===K.g7?this.reductionPosition():this.expandPosition())}setDistanceField(e,t,n,s){this.map.set(0,e,t,n,s,!1,this.map.getDistanceField())}hasOutOfWorld(e,t,n){return function(e,t,n,s){const[i,a,r]=e.getSize();return t<=0||t>=i-1||n<=0||n>=a-1||s<=0||s>=r-1}(this.map,e,t,n)}clear(){const e=this.getMap(),t=this.getVoxelManager(),n=this.getControlManager();e.clear(),t.clear(),n.clear();for(const e in this.trees)this.trees[e].clear();this.lateTime=0,super.clear()}hitScanVoxel(e,t,n,s,i,a){return O(e,t,n,s,i,a,((e,t,n)=>this.getDistanceField(e,t,n)))}hasHitScanVoxel(e,t,n,s,i,a){const[r,o,l]=this.hitScanVoxel(e,t,n,s,i,a);return!(-1===r&&-1===o&&-1===l)}hasHitScanBoldFind(e,t,n,s,i,a,r){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1/0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:new Array;const[h,c,u,,]=this.hitScanBoldFind(e,t,n,s,i,a,r,o,l);return-1!==h&&-1!==c&&-1!==u}hasHitScanBold(e,t,n,s,i,a,r){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1/0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:new Array;const[h,c,u,,]=this.hitScanBold(e,t,n,s,i,a,r,o,l);return-1!==h&&-1!==c&&-1!==u}hasHitScanVoxelBoldFind(e,t,n,s,i,a){let r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;const[o,l,h]=this.hitScanVoxelBold(e,t,n,s,i,a,r);return-1!==o&&-1!==l&&-1!==h}hasHitScanVoxelBold(e,t,n,s,i,a){let r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;const[o,l,h]=this.hitScanVoxelBold(e,t,n,s,i,a,r);return-1!==o&&-1!==l&&-1!==h}hasBlockScaleVoxel(e,t,n,s,i){return function(e,t,n,s,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:()=>!1;(0,u.vF)(f);const r=_(e,t,n,s,i,f);for(let o=0,l=0|r.length;o<l;o=o+3|0){const l=r[o],h=r[o+1],c=r[o+2];if(a("type",l,h,c)&&d(l,h,c,e,t,n,s,i))return!0}return!1}(e,t,n,s,i,((e,t,n,s)=>this.getVoxel(t,n,s)!==K.g7))}hasBlockScale(e,t,n,s,i,r){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Array;if(this.hasBlockScaleVoxel(t,n,s,i,r))return!0;const l=new Array,h=this.trees[e],c=e=>o.includes(e),u=_(t,n,s,i,r,[]);for(let e=0,o=0|u.length;e<o;e=e+3|0){const o=u[e],d=u[e+1],g=u[e+2],f=h.getPointCell(o,d,g);for(let e=0,o=0|f.length;e<o;e=e+1|0){const o=this.getEntityOfID(f[e]);if(null===o||!o.hasLive()||l.includes(o)||o.getNames().some(c)||c(o.getID()))continue;const[u,d,g,m,y]=h.getEntityProperty(o);if(-1===u&&-1===d&&-1===g)continue;let[w,b,x,,,]=h.getOldEntityProperty(o);w=-1===w?u:w,b=-1===b?d:b,x=-1===x?g:x;const M=u-w,S=d-b,k=g-x,P=(0,a.X6)(M,S,k,0,0,0),[_,E]=(0,a.tx)(M,S,k,0,0,0),O=Math.min(P,m/4,y/4,.5),[A,L,C]=(0,a.c8)(_,E,0,0,1);let T=0;for(;;){if(p(t,n,s,i,r,w+T*A,b+T*L,x+T*C,m,y))return!0;if(T>=P)break;T=Math.min(P,(0,v._1)(T+O,P,1e5,Math.ceil))}}}return!1}getEntitysOfRange(e,t,n,s,i,r){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Array;const l=new Array,h=new Array,c=this.trees[e],u=e=>o.includes(e),d=_(t,n-r/2,s,i,r,[]);for(let e=0,o=0|d.length;e<o;e=e+3|0){const o=d[e],g=d[e+1],f=d[e+2],m=c.getPointCell(o,g,f);for(let e=0,o=0|m.length;e<o;e=e+1|0){const o=m[e],d=this.getEntityOfID(o);if(null===d||!d.hasLive()||h.includes(d)||d.getNames().some(u)||u(o))continue;const[g,f,y,w,b]=c.getEntityProperty(d);if(-1===g&&-1===f&&-1===y)continue;let[x,M,S,,,]=c.getOldEntityProperty(d);x=-1===x?g:x,M=-1===M?f:M,S=-1===S?y:S;const k=g-x,P=f-M,_=y-S,E=(0,a.X6)(k,P,_,0,0,0),[O,A]=(0,a.tx)(k,P,_,0,0,0),L=Math.min(E,w/4,b/4,.5),[C,T,D]=(0,a.c8)(O,A,0,0,1);let F=0;for(;;){if(p(t,n-r/2,s,i,r,x+F*C,M+F*T,S+F*D,w,b)){l.push(d);break}if(F>=E)break;F=Math.min(E,(0,v._1)(F+L,E,1e5,Math.ceil))}}}return l}getEntitysOfLine(e,t,n,s,i,r,o){let l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:(e,t,n)=>!1;const c=new Array,d=new Array,g=e=>l.includes(e),p=this.trees[e];return E(t,n,s,i,r,o,h,((e,l,h,u,f,m,y,w,x,M,S,k,P,_,E,O,A,L)=>{const C=p.getPointCell(e,l,h);for(let e=0,l=0|C.length;e<l;e=e+1|0){const l=C[e],h=this.getEntityOfID(l);if(null===h||!h.hasLive()||d.includes(h)||h.getNames().some(g)||g(l))continue;const[y,w,x,M,S]=p.getEntityProperty(h);if(-1===y&&-1===w&&-1===x)continue;let[k,P,_,,,]=p.getOldEntityProperty(h);k=-1===k?y:k,P=-1===P?w:P,_=-1===_?x:_;const E=y-k,O=w-P,A=x-_,L=(0,a.X6)(E,O,A,0,0,0),[T,D]=(0,a.tx)(E,O,A,0,0,0),[F,z,B]=(0,a.c8)(T,D,0,0,1),N=Math.min(L,M/4,S/4,.5);let I=0;for(;;){const e=k+I*F,l=P+I*z,g=_+I*B;if((s<u?s<e+M/2:u<e+M/2)&&(i<f?i<l+S:f<l+S)&&(r<m?r<g+M/2:m<g+M/2)&&(s>u?s>e-M/2:u>e-M/2)&&(i>f?i>l:f>l)&&(r>m?r>g-M/2:m>g-M/2)){const[u,p,f]=b(s,i,r,t,n,e,l,g,e,l+S,g,M);if(-1!==u||-1!==p||-1!==f){const e=(0,a.X6)(u,p,f,s,i,r);if(e<o){d.push(h),c.push([u,p,f,e,h]);break}}}if(I>=L)break;I=Math.min(L,(0,v._1)(I+N,L,1e5,Math.ceil))}}return c.length>0})),c.length>1&&(0,u.qr)(c).asc((e=>e[3])),c}hitScan(e,t,n,s,i,r,o){let l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];const h=new Array,c=new Array,d=this.trees[e],g=e=>l.includes(e),[p,f,m,y]=E(t,n,s,i,r,o,((e,t,n)=>this.getVoxel(e,t,n)!==K.g7),((e,l,u,p,f,m,y,w,x,M,S,k,P,_,E,O,A,L)=>{const C=d.getPointCell(e,l,u);for(let e=0,l=0|C.length;e<l;e=e+1|0){const l=this.getEntityOfID(C[e]);if(null===l||!l.hasLive()||c.includes(l)||l.getNames().some(g)||g(l.getID()))continue;const[u,y,w,x,M]=d.getEntityProperty(l);if(-1===u&&-1===y&&-1===w)continue;let[S,k,P,,,]=d.getOldEntityProperty(l);S=-1===S?u:S,k=-1===k?y:k,P=-1===P?w:P;const _=u-S,E=y-k,O=w-P,A=(0,a.X6)(_,E,O,0,0,0),L=(0,v._1)(Math.min(o,(0,a.X6)(p,f,m,s,i,r)/o),0),[T,D]=(0,a.tx)(_,E,O,0,0,0),[F,z,B]=(0,a.c8)(T,D,0,0,1),N=u+A*L*F,I=y+A*L*z,R=w+A*L*B;if((s<p?s<N+x/2:p<N+x/2)&&(i<f?i<I+M:f<I+M)&&(r<m?r<R+x/2:m<R+x/2)&&(s>p?s>N-x/2:p>N-x/2)&&(i>f?i>I:f>I)&&(r>m?r>R-x/2:m>R-x/2)){const[e,u,d]=b(s,i,r,t,n,N,I,R,N,I+M,R,x);if(-1===e&&-1===u&&-1===d)continue;const g=(0,a.X6)(e,u,d,s,i,r);g<o&&(c.push(l),h.push([e,u,d,g,l]))}}return h.length>0}));return h.length>1&&(0,u.qr)(h).asc((e=>e[3])),h.push([p,f,m,y,null]),h[0]}hasHitScan(e,t,n,s,i,r,o){let l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];const h=new Array,c=new Array,u=new Array,d=this.trees[e],[g,p,f]=E(t,n,s,i,r,o,((e,t,n)=>this.getVoxel(e,t,n)!==K.g7),((e,g,p,f,m,y,w,x,M,S,k,P,_,E,O,A,L,C)=>{const T=d.getPointCell(e,g,p);for(let e=0,g=0|T.length;e<g;e=e+1|0){const g=this.getEntityOfID(T[e]);if(null===g||!g.hasLive()||u.includes(g))continue;if(g instanceof j&&g.getNames().some((e=>l.includes(e)))){u.push(g);continue}const[p,w,x,M,S]=d.getEntityProperty(g);if(-1===p&&-1===w&&-1===x)continue;let[k,P,_,,,]=d.getOldEntityProperty(g);k=-1===k?p:k,P=-1===P?w:P,_=-1===_?x:_;const E=(0,a.X6)(p,w,x,k,P,_),O=(0,v._1)(Math.min(1,(0,a.X6)(f,m,y,s,i,r)/o),0),[A,L]=(0,a.tx)(p,w,x,k,P,_),[C,D,F]=(0,a.c8)(A,L,0,0,1),z=p+E*O*C,B=w+E*O*D,N=x+E*O*F;if((s<f?s<z+M/2:f<z+M/2)&&(i<m?i<B+S:m<B+S)&&(r<y?r<N+M/2:y<N+M/2)&&(s>f?s>z-M/2:f>z-M/2)&&(i>m?i>B:m>B)&&(r>y?r>N-M/2:y>N-M/2)){const[e,l,u]=b(s,i,r,t,n,z,B,N,z,B+S,N,M);if(-1===e&&-1===l&&-1===u)continue;const d=(0,a.X6)(e,l,u,s,i,r);d<o&&(c.push(g),h.push([e,l,u,d,g]))}}return!1}));return-1!==g&&-1!==p&&-1!==f}hasHitScanActor(e,t,n,s,i,r,o){let l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];const h=new Array,c=this.trees[e];let u=!1;return E(t,n,s,i,r,o,((e,t,n)=>this.getVoxel(e,t,n)!==K.g7),((e,d,g,p,f,m,y,w,x,M,S,k,P,_,E,O,A,L)=>{const C=c.getPointCell(e,d,g);for(let e=0,d=0|C.length;e<d;e=e+1|0){const d=this.getEntityOfID(C[e]);if(null===d||!d.hasLive()||h.includes(d))continue;if(d instanceof j&&d.getNames().some((e=>l.includes(e)))){h.push(d);continue}const[g,y,w,x,M]=c.getEntityProperty(d);if(-1===g&&-1===y&&-1===w)continue;let[S,k,P,,,]=c.getOldEntityProperty(d);S=-1===S?g:S,k=-1===k?y:k,P=-1===P?w:P;const _=g-S,E=y-k,O=w-P,A=(0,a.X6)(_,E,O,0,0,0),L=(0,v._1)(Math.min(1,(0,a.X6)(p,f,m,s,i,r)/o),0),[T,D]=(0,a.tx)(_,E,O,0,0,0),[F,z,B]=(0,a.c8)(T,D,0,0,1),N=g+A*L*F,I=y+A*L*z,R=w+A*L*B;if((s<p?s<N+x/2:p<N+x/2)&&(i<f?i<I+M:f<I+M)&&(r<m?r<R+x/2:m<R+x/2)&&(s>p?s>N-x/2:p>N-x/2)&&(i>f?i>I:f>I)&&(r>m?r>R-x/2:m>R-x/2)){const[e,l,h]=b(s,i,r,t,n,N,I,R,N,I+M,R,x);if(-1===e&&-1===l&&-1===h)continue;if((0,a.X6)(e,l,h,s,i,r)<o)return u=!0,!0}}return!1})),u}hitScanBold(e,t,n,s,i,r,o,l){let h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];const c=new Array,d=e=>h.includes(e),g=this.trees[e],[f,m,y]=this.getWorldSize(),w=Math.min(l,(0,a.X6)(f,m,y,0,0,0)),[b,x,M]=(0,a.c8)(t,n,0,0,w),S=(0,a.X6)(b,x,M,0,0,0),[k,P]=(0,a.tx)(b,x,M,0,0,0),[E,O,A]=(0,a.c8)(k,P,0,0,1),L=Math.min(S,o,.5);let C,T=new Array,D=null,F=0;for(;;){const e=s+F*E,l=i+F*O,h=r+F*A,u=_(e,l-o/2,h,o,o);for(let f=0,m=0|u.length;f<m;f=f+3|0){const m=u[f+0],y=u[f+1],b=u[f+2];if(this.getVoxel(m,y,b)!==K.g7){const[o,u]=(0,a.tx)(m+.5,y+.5,b+.5,e,l,h),d=(0,a.X6)(m+.5,y+.5,b+.5,e,l,h),g=Math.cos(o)+Math.sin(o),p=Math.sin(u)+Math.cos(u),[f,w,v]=(0,a.c8)(t,n,0,0,d-Math.sqrt(Math.max(g*g,p*p))+(0,a.X6)(e,l,h,s,i,r));c.push([f+s,w+i,v+r,(0,a.X6)(f+s,w+i,v+r,s,i,r),null]),C=!0}const x="".concat(m,",").concat(y,",").concat(b);T=x!==D?g.getPointCell(m,y,b):T,D=x;for(let t=0,n=0|T.length;t<n;t=t+1|0){const n=T[t],u=this.getEntityOfID(n);if(null===u||!u.hasLive()||d(u.getID())||u.getNames().some(d))continue;const[f,m,y,b,x]=g.getEntityProperty(u);if(-1===f&&-1===m&&-1===y)continue;let[M,k,P,,,]=g.getOldEntityProperty(u);M=-1===M?f:M,k=-1===k?m:k,P=-1===P?y:P;const _=f-M,E=m-k,O=y-P,A=(0,v._1)(Math.min(1,F/S),0),[L,C]=(0,a.tx)(_,E,O,0,0,0),[D,z,B]=(0,a.c8)(L,C,0,0,1),N=(0,a.X6)(_,E,O,0,0,0);if(p(e,l-o/2,h,o,o,M+N*A*D,k+N*A*z,P+N*A*B,b,x)){const t=e,n=l,o=h,d=(0,a.X6)(t,n,o,s,i,r);d<w&&c.push([t,n,o,d,u])}}}if(C||F>=S){F=S;break}F=Math.min(S,(0,v._1)(F+L,S,1e5,Math.ceil))}return c.length>0?((0,u.qr)(c).asc((e=>e[3])),c[0]):[-1,-1,-1,-1,null]}hitScanBoldFind(e,t,n,s,i,r,o,l){let h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];const c=new Array,d=e=>h.includes(e),g=this.trees[e];let f=new Array,m=null,[y,w,b,x]=this.hitScanVoxelBoldFindMax(t,n,s,i,r,o,1/0);if(-1!==y&&-1!==w&&-1!==b){const e=Math.min(l,x),t=y-s,n=w-i,h=b-r,M=(0,a.X6)(t,n,h,0,0,0),[S,k]=(0,a.tx)(t,n,h,0,0,0),[P,E,O]=(0,a.c8)(S,k,0,0,1),A=Math.min(M,o,.5);let L=0;for(;;){const t=s+L*P,n=i+L*E,l=r+L*O,h=_(t,n-o/2,l,o,o);for(let u=0,y=0|h.length;u<y;u=u+3|0){const y=h[u+0],w=h[u+1],b=h[u+2],x="".concat(y,",").concat(w,",").concat(b);f=x!==m?g.getPointCell(y,w,b):f,m=x;for(let h=0,u=0|f.length;h<u;h=h+1|0){const u=f[h],m=this.getEntityOfID(u);if(null===m||!m.hasLive()||d(m.getID())||m.getNames().some(d))continue;const[y,w,b,x,S]=g.getEntityProperty(m);if(-1===y&&-1===w&&-1===b)continue;let[k,P,_,,,]=g.getOldEntityProperty(m);k=-1===k?y:k,P=-1===P?w:P,_=-1===_?b:_;const E=y-k,O=w-P,A=b-_,C=(0,v._1)(Math.min(1,L/M),0),[T,D]=(0,a.tx)(E,O,A,0,0,0),[F,z,B]=(0,a.c8)(T,D,0,0,1),N=(0,a.X6)(E,O,A,0,0,0);if(p(t,n-o/2,l,o,o,k+N*C*F,P+N*C*z,_+N*C*B,x,S)){const o=t,h=n,u=l,d=(0,a.X6)(o,h,u,s,i,r);d<e&&c.push([o,h,u,d,m])}}}if(L>=M){L=M;break}L=Math.min(M,(0,v._1)(L+A,M,1e5,Math.ceil))}if(c.length>1)return(0,u.qr)(c).asc((e=>e[3])),c[0]}return 0===c.length&&([y,w,b,x]=this.hitScanVoxelBoldFindMin(t,n,s,i,r,o,l)),[y,w,b,x,null]}hitScanVoxelBoldFindMin(e,t,n,s,i,r){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0,l=-1,h=-1,c=-1,u=1/0;const d=r/2;let g=!1;for(let r=0,p=0|ee.length;r<p;r=r+1|0){const p=(0,a.KO)(ee[r][0],ee[r][1],0,0),f=Math.cos(p)*d,m=Math.sin(p)*d,[y,w,b]=(0,a.c8)(e,t,f,m,0),[v,x,M,S]=this.hitScanVoxel(e,t,n+y,s+w,i+b,o);-1!==v&&-1!==x&&-1!==M&&S<u&&(l=v-y,h=x-w,c=M-b,u=S,g=!0)}return[l,h,c,g?u:-1]}hitScanVoxelBoldFindMax(e,t,n,s,i,r){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0,l=-1,h=-1,c=-1,u=0;const d=r/2;let g=!1;for(let r=0,p=0|ee.length;r<p;r=r+1|0){const p=(0,a.KO)(ee[r][0],ee[r][1],0,0),f=Math.cos(p)*d,m=Math.sin(p)*d,[y,w,b]=(0,a.c8)(e,t,f,m,0),[v,x,M,S]=this.hitScanVoxel(e,t,n+y,s+w,i+b,o);-1!==v&&-1!==x&&-1!==M&&S>u&&(l=v-y,h=x-w,c=M-b,u=S,g=!0)}return[l,h,c,g?u:-1]}hitScanVoxelBold(e,t,n,s,i,r,o){const l=new Array,[h,c,d]=this.getWorldSize(),g=Math.min(o,(0,a.X6)(h,c,d,0,0,0)),[p,f,m]=(0,a.c8)(e,t,0,0,g),y=(0,a.X6)(p,f,m,0,0,0),[w,b]=(0,a.tx)(p,f,m,0,0,0),[x,M,S]=(0,a.c8)(w,b,0,0,1),k=Math.min(y,r,.5);let P,E=0;for(;;){const o=n+E*x,h=s+E*M,c=i+E*S,u=_(o,h-r/2,c,r,r);for(let r=0,d=0|u.length;r<d;r=r+3|0){const d=u[r+0],g=u[r+1],p=u[r+2];if(this.getVoxel(d,g,p)!==K.g7){const[r,u]=(0,a.tx)(d+.5,g+.5,p+.5,o,h,c),f=(0,a.X6)(d+.5,g+.5,p+.5,o,h,c),m=Math.cos(r)+Math.sin(r),y=Math.sin(u)+Math.cos(u),[w,b,v]=(0,a.c8)(e,t,0,0,f-Math.sqrt(Math.max(m*m,y*y))+(0,a.X6)(o,h,c,n,s,i));l.push([w+n,b+s,v+i,(0,a.X6)(w+n,b+s,v+i,n,s,i),null]),P=!0}}if(P||E>=y){E=y;break}E=Math.min(y,(0,v._1)(E+k,y,1e5,Math.ceil))}return l.length>0?((0,u.qr)(l).asc((e=>e[3])),l[0]):[-1,-1,-1,-1,null]}expandPosition(){const[e,t,n]=this.getWorldSize(),s=this.getMargin();let i=0,a=0,r=0,o=e-1,l=t-1,h=n-1;e:for(;i<e;){for(let e=0;e<n;e=e+1|0)for(let n=0;n<t;n=n+1|0)if(this.getVoxel(i,n,e)!==K.g7&&this.getVoxel(i,n,e)!==K.xZ)break e;i+=1}e:for(;o>=0;){for(let e=0;e<n;e=e+1|0)for(let n=0;n<t;n=n+1|0)if(this.getVoxel(o,n,e)!==K.g7&&this.getVoxel(o,n,e)!==K.xZ)break e;o+=-1}e:for(;a<t;){for(let t=0;t<e;t=t+1|0)for(let e=0;e<n;e=e+1|0)if(this.getVoxel(t,a,e)!==K.g7&&this.getVoxel(t,a,e)!==K.xZ)break e;a+=1}e:for(;l>=0;){for(let t=0;t<e;t=t+1|0)for(let e=0;e<n;e=e+1|0)if(this.getVoxel(t,l,e)!==K.g7&&this.getVoxel(t,l,e)!==K.xZ)break e;l+=-1}e:for(;r<n;){for(let n=0;n<e;n=n+1|0)for(let e=0;e<t;e=e+1|0)if(this.getVoxel(n,e,r)!==K.g7&&this.getVoxel(n,e,r)!==K.xZ)break e;r+=1}e:for(;h>=0;){for(let n=0;n<e;n=n+1|0)for(let e=0;e<t;e=e+1|0)if(this.getVoxel(n,e,h)!==K.g7&&this.getVoxel(n,e,h)!==K.xZ)break e;h+=-1}let c=0,u=0,d=0;this.offset.left=s,c+=Math.min(0,i-s),this.offset.right=o+s,c+=Math.max(0,o+s-(e-1)),this.offset.bottom=s,u+=Math.min(0,a-s),this.offset.top=l+s,u+=Math.max(0,l+s-(t-1)),this.offset.back=s,d+=Math.min(0,r-s),this.offset.front=h+s,d+=Math.max(0,h+s-(n-1)),this.map.expand(c,u,d);const g=this.getEntitys();for(let e=0,t=0|g.length;e<t;e=e+1|0){const t=g[e];if(!(t instanceof j))continue;const{position:n}=t;n.x+=Math.abs(c<0?c:0),n.y+=Math.abs(u<0?u:0),n.z+=Math.abs(d<0?d:0)}}reductionPosition(){const[e,t,n]=this.getWorldSize(),s=this.getMargin();let i=0,a=0,r=0,o=e-1,l=t-1,h=n-1;e:for(;i<e;){for(let e=0;e<n;e=e+1|0)for(let n=0;n<t;n=n+1|0)if(this.getVoxel(i,n,e)!==K.g7&&this.getVoxel(i,n,e)!==K.xZ)break e;i+=1}e:for(;o>=0;){for(let e=0;e<n;e=e+1|0)for(let n=0;n<t;n=n+1|0)if(this.getVoxel(o,n,e)!==K.g7&&this.getVoxel(o,n,e)!==K.xZ)break e;o+=-1}e:for(;a<t;){for(let t=0;t<e;t=t+1|0)for(let e=0;e<n;e=e+1|0)if(this.getVoxel(t,a,e)!==K.g7&&this.getVoxel(t,a,e)!==K.xZ)break e;a+=1}e:for(;l>=0;){for(let t=0;t<e;t=t+1|0)for(let e=0;e<n;e=e+1|0)if(this.getVoxel(t,l,e)!==K.g7&&this.getVoxel(t,l,e)!==K.xZ)break e;l+=-1}e:for(;r<n;){for(let n=0;n<e;n=n+1|0)for(let e=0;e<t;e=e+1|0)if(this.getVoxel(n,e,r)!==K.g7&&this.getVoxel(n,e,r)!==K.xZ)break e;r+=1}e:for(;h>=0;){for(let n=0;n<e;n=n+1|0)for(let e=0;e<t;e=e+1|0)if(this.getVoxel(n,e,h)!==K.g7&&this.getVoxel(n,e,h)!==K.xZ)break e;h+=-1}let c=0,u=0,d=0;this.offset.left=s,c+=Math.min(0,s-i),this.offset.right=o+s,c+=Math.max(0,e-1-(o+s)),this.offset.bottom=s,u+=Math.min(0,s-a),this.offset.top=l+s,u+=Math.max(0,t-1-(l+s)),this.offset.back=s,d+=Math.min(0,s-r),this.offset.front=h+s,d+=Math.max(0,n-1-(h+s)),this.map.reduction(c,u,d);const g=this.getEntitys();for(let e=0,t=0|g.length;e<t;e=e+1|0){const t=g[e];if(!(t instanceof j))continue;const{position:n}=t;n.x-=Math.abs(c<0?c:0),n.y-=Math.abs(u<0?u:0),n.z-=Math.abs(d<0?d:0)}}findPath(e,t,n,s){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(e,t)=>{t.block=!0},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e=>!0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e=>e.step,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:()=>!0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:()=>0;return this.finder.find(e,t,n,s,i,a,r,o,l)}createTransferVoxelData(e,t,n){return n=n||this.isForceUpdate,this.isForceUpdate=!1,this.transferDataBuilder.createData(e,this.getAssetManager(),t,n)}onbeforeoffset(e){const[t,n,s]=this.getWorldSize();for(const e in this.trees)this.trees[e].update(t,n,s)}onupdateend(e){const{time:t}=e;this.lateTime+=1e-7*t,this.finder.update(t*(1e3/60)),super.onupdateend(e)}}))return;t.getCamera().fov=(0,a.c6)(e)})),this.setting.fov=e,this.saveSetting()}setFramerate(e){e>=ae.length&&(e=1),this.setting.framerate=e,this.saveSetting()}setSoundVolume(e){this.setting.soundVolume=e,this.saveSetting()}setClusterResolution(e){this.setting.clusterResolution=e,this.saveSetting()}setFullscreen(e){this.setting.isFullscreen=e,this.saveSetting()}setBrowserFullscreen(e){this.setting.isBrowserFullscreen=e,this.saveSetting()}setReolutionIndex(e){this.setting.resolutionIndex=e,this.saveSetting()}setReflectionCount(e){this.setting.reflectionCount=e,this.saveSetting()}setShadow(e){this.setting.isShadow=e,this.saveSetting()}setSoftShadow(e){this.setting.isSoftShadow=e,this.saveSetting()}setRoughness(e){this.setting.isRoughness=e,this.saveSetting()}setBloom(e){this.setting.isBloom=e,this.saveSetting()}setMuzzleFlash(e){this.setting.isMuzzleFlash=e,this.saveSetting()}setPixelizedLighting(e){this.setting.isPixelizedLighting=e,this.saveSetting()}setLightingDotScale(e){this.setting.lightingDotScale=e,this.saveSetting()}setBlurDotScale(e){this.setting.blurDotScale=e,this.saveSetting()}setContrast(e){this.setting.contrast=e,this.saveSetting()}setBrightness(e){this.setting.brightness=e,this.saveSetting()}setCRTEnable(e){this.setting.isCRT=e,this.saveSetting()}setCRTDeep(e){this.setting.crtDeep=e,this.saveSetting()}setCRTSubPixel(e){this.setting.crtSubPixel=e,this.saveSetting()}setCRTLens(e){this.setting.crtLens=e,this.saveSetting()}setCRTEdge(e){this.setting.crtEdge=e,this.saveSetting()}setCRTVig(e){this.setting.crtVig=e,this.saveSetting()}setCRTShadowMask(e){this.setting.isCRTShadowMask=e,this.saveSetting()}setInnerDeadzoneX(e){this.setting.stickInnerDeadzoneX=e,this.saveSetting()}setOuterDeadzoneX(e){this.setting.stickOuterDeadzoneX=e,this.saveSetting()}setInnerDeadzoneY(e){this.setting.stickInnerDeadzoneY=e,this.saveSetting()}setOuterDeadzoneY(e){this.setting.stickOuterDeadzoneY=e,this.saveSetting()}getRandomWeaponDrop(){return this.setting.randomWeaponDrop}getRandomHeightEnemy(){return this.setting.randomHeightEnemy}hasBob(){return this.setting.bob}hasToggleSprint(){return this.setting.toggleSprint}hasToggleCluch(){return this.setting.toggleCluch}getWeaponChargeStandTime(){return this.setting.weaponChargeStandTime}getWeaponWheelStandTime(){return this.setting.weaponWheelStandTime}hasEatSound(){return this.setting.eatSound}hasHUD(){return this.setting.isHUD}hasCheckPoint(){return this.setting.isCheckPoint}hasDeadLoseWeapon(){return this.setting.isDeadLoseWeapon}hasPermaDeath(){return this.setting.isPermaDeath}hasSSSSlowMo(){return this.setting.isSSSSlowMo}hasNotSpawnActors(){return this.setting.isNotSpawnActors}hasDebugLog(){return this.setting.isDebugLog}getSoundVolume(){return this.setting.soundVolume}getReflectionCount(){return this.setting.reflectionCount}getLightingDotScale(){return this.hasCRT()?1:this.setting.lightingDotScale}getBlurDotScale(){return this.hasCRT()?1:this.setting.blurDotScale}getClusterResolution(){return this.setting.clusterResolution}hasShadow(){return this.setting.isShadow}hasSoftShadow(){return this.setting.isSoftShadow}hasRoughness(){return this.setting.isRoughness}hasBloom(){return this.setting.isBloom}hasMuzzleFlash(){return this.setting.isMuzzleFlash}hasPixelizedLighting(){return this.setting.isPixelizedLighting}getContrast(){return this.setting.contrast}getBrightness(){return this.setting.brightness}hasCRT(){return this.setting.isCRT}getResolutionIndex(){return this.setting.resolutionIndex}hasFullscreen(){return this.setting.isFullscreen}hasBrowserFullscreen(){return this.setting.isBrowserFullscreen}getCRTSubPixel(){return this.hasCRT()?this.setting.crtSubPixel:1}getCRTLens(){return this.setting.crtLens}getCRTDeep(){return this.setting.crtDeep}getCRTEdge(){return this.setting.crtEdge}getCRTVig(){return this.setting.crtVig}hasCRTShadowMask(){return this.setting.isCRTShadowMask}getSensibility(){return this.setting.sensibility}hasInvertX(){return this.setting.invertX}hasInvertY(){return this.setting.invertY}getInnerDeadzoneX(){return this.setting.stickInnerDeadzoneX}getOuterDeadzoneX(){return this.setting.stickOuterDeadzoneX}getInnerDeadzoneY(){return this.setting.stickInnerDeadzoneY}getOuterDeadzoneY(){return this.setting.stickOuterDeadzoneY}getFramerate(){return(0,i.Vp)()?ae[this.setting.framerate]:1/0}getFramerateIndex(){return this.setting.framerate}getFOV(){return this.setting.fov}getVolume(){return this.setting.soundVolume}}},220:(e,t,n)=>{"use strict";n.d(t,{Tc:()=>g,g7:()=>p,xZ:()=>f});class s{constructor(e,t){this.src=e,this.index=t}}var i=n(764),a=n(276);class r{constructor(e,t,n,s,i,r,o,l,h){let c=arguments.length>9&&void 0!==arguments[9]&&arguments[9],u=arguments.length>10&&void 0!==arguments[10]&&arguments[10],d=arguments.length>11&&void 0!==arguments[11]&&arguments[11],g=arguments.length>12&&void 0!==arguments[12]&&arguments[12],p=arguments.length>13&&void 0!==arguments[13]&&arguments[13],f=arguments.length>14&&void 0!==arguments[14]&&arguments[14],m=arguments.length>15&&void 0!==arguments[15]&&arguments[15],y=arguments.length>16&&void 0!==arguments[16]&&arguments[16],w=arguments.length>17&&void 0!==arguments[17]&&arguments[17],b=arguments.length>18&&void 0!==arguments[18]&&arguments[18],v=arguments.length>19&&void 0!==arguments[19]&&arguments[19],x=arguments.length>20&&void 0!==arguments[20]&&arguments[20];this.flipXFront=!1,this.flipYFront=!1,this.flipXBack=!1,this.flipYBack=!1,this.flipXRight=!1,this.flipYRight=!1,this.flipXLeft=!1,this.flipYLeft=!1,this.flipXTop=!1,this.flipYTop=!1,this.flipXBottom=!1,this.flipYBottom=!1,this.position=new a.P(e,t,n),this.front=s,this.back=i,this.right=r,this.left=o,this.top=l,this.bottom=h,this.flipXFront=c,this.flipYFront=u,this.flipXBack=d,this.flipYBack=g,this.flipXRight=p,this.flipYRight=f,this.flipXLeft=m,this.flipYLeft=y,this.flipXTop=w,this.flipYTop=b,this.flipXBottom=v,this.flipYBottom=x}}var o=n(727),l=n(459),h=n(563),c=n(437);let u=null;if("AudioContext"in self){u=new AudioContext;try{(0,h.T)(u)}catch(e){self.addEventListener("load",(()=>u&&(0,h.T)(u)))}}class d extends l.x{async load(){0===this.data.length&&(this.data=await Promise.all(this.src.map((async e=>u?u.decodeAudioData((await(0,c.hn)(e,"arraybuffer")).source):null))))}}new o.s("./asset/font.png"),new o.s("./asset/icon.png"),new o.s("./asset/key.png"),new o.s("./asset/horde_badge.png"),new o.s("./asset/title-prod.png"),new o.s("./asset/title-demo.png"),new o.s("./asset/how_to_play_keyboard.png"),new o.s("./asset/how_to_play_gamepad.png"),new o.s("./asset/memberscard/members.png"),new o.s("./asset/memberscard/silver.png"),new o.s("./asset/memberscard/gold.png"),new o.s("./asset/memberscard/platinum.png"),new o.s("./asset/memberscard/diamond.png"),new i.g("./asset/wall/default.albedo.png","./asset/wall/default.pbr.png","./asset/wall/default.normal.png"),new i.g("./asset/wall/desert.albedo.png","./asset/wall/desert.pbr.png","./asset/wall/desert.normal.png"),new i.g("./asset/hud/hand.albedo.png","./asset/hud/hand.pbr.png","./asset/hud/hand.normal.png"),new i.g("./asset/hud/foot.albedo.png","./asset/hud/foot.pbr.png","./asset/hud/foot.normal.png"),new i.g("./asset/hud/slowball.albedo.png","./asset/hud/slowball.pbr.png","./asset/hud/slowball.normal.png"),new i.g("./asset/hud/binoculars.albedo.png","./asset/hud/binoculars.pbr.png","./asset/hud/binoculars.normal.png"),new i.g("./asset/hud/energyshield.albedo.png","./asset/hud/energyshield.pbr.png","./asset/hud/energyshield.normal.png"),new i.g("./asset/hud/combobooster.albedo.png","./asset/hud/combobooster.pbr.png","./asset/hud/combobooster.normal.png"),new i.g("./asset/hud/hookshot.albedo.png","./asset/hud/hookshot.pbr.png","./asset/hud/hookshot.normal.png"),new i.g("./asset/hud/pistol.albedo.png","./asset/hud/pistol.pbr.png","./asset/hud/pistol.normal.png"),new i.g("./asset/hud/handcannon.albedo.png","./asset/hud/handcannon.pbr.png","./asset/hud/handcannon.normal.png"),new i.g("./asset/hud/machingun.albedo.png","./asset/hud/machingun.pbr.png","./asset/hud/machingun.normal.png"),new i.g("./asset/hud/chainshotgun.albedo.png","./asset/hud/chainshotgun.pbr.png","./asset/hud/chainshotgun.normal.png"),new i.g("./asset/hud/shotgun.albedo.png","./asset/hud/shotgun.pbr.png","./asset/hud/shotgun.normal.png"),new i.g("./asset/hud/heavycannon.albedo.png","./asset/hud/heavycannon.pbr.png","./asset/hud/heavycannon.normal.png"),new i.g("./asset/hud/launcher.albedo.png","./asset/hud/launcher.pbr.png","./asset/hud/launcher.normal.png"),new i.g("./asset/hud/clusterbow.albedo.png","./asset/hud/clusterbow.pbr.png","./asset/hud/clusterbow.normal.png"),new i.g("./asset/hud/plasmagun.albedo.png","./asset/hud/plasmagun.pbr.png","./asset/hud/plasmagun.normal.png"),new i.g("./asset/hud/plasmasmg.albedo.png","./asset/hud/plasmasmg.pbr.png","./asset/hud/plasmasmg.normal.png"),new i.g("./asset/entity/debug.albedo.png","./asset/entity/debug.pbr.png","./asset/entity/debug.normal.png"),new i.g("./asset/entity/ui.albedo.png","./asset/entity/ui.pbr.png","./asset/entity/ui.normal.png"),new i.g("./asset/entity/bullet.albedo.png","./asset/entity/bullet.pbr.png","./asset/entity/bullet.normal.png"),new i.g("./asset/entity/blood.albedo.png","./asset/entity/blood.pbr.png","./asset/entity/blood.normal.png"),new i.g("./asset/entity/acid.albedo.png","./asset/entity/acid.pbr.png","./asset/entity/acid.normal.png"),new i.g("./asset/entity/gib.albedo.png","./asset/entity/gib.pbr.png","./asset/entity/gib.normal.png"),new i.g("./asset/entity/hit.albedo.png","./asset/entity/hit.pbr.png","./asset/entity/hit.normal.png"),new i.g("./asset/entity/ring.albedo.png","./asset/entity/ring.pbr.png","./asset/entity/ring.normal.png"),new i.g("./asset/entity/stuff.albedo.png","./asset/entity/stuff.pbr.png","./asset/entity/stuff.normal.png"),new i.g("./asset/entity/spark.albedo.png","./asset/entity/spark.pbr.png","./asset/entity/spark.normal.png"),new i.g("./asset/entity/explode.albedo.png","./asset/entity/explode.pbr.png","./asset/entity/explode.normal.png"),new i.g("./asset/entity/flame.albedo.png","./asset/entity/flame.pbr.png","./asset/entity/flame.normal.png"),new i.g("./asset/entity/enemy-guy.albedo.png","./asset/entity/enemy-guy.pbr.png","./asset/entity/enemy-guy.normal.png"),new i.g("./asset/entity/helmet.albedo.png","./asset/entity/helmet.pbr.png","./asset/entity/helmet.normal.png"),new i.g("./asset/entity/enemy-armor.albedo.png","./asset/entity/enemy-armor.pbr.png","./asset/entity/enemy-armor.normal.png"),new i.g("./asset/entity/object.albedo.png","./asset/entity/object.pbr.png","./asset/entity/object.normal.png"),new i.g("./asset/entity/checkpoint.albedo.png","./asset/entity/checkpoint.pbr.png","./asset/entity/checkpoint.normal.png"),new i.g("./asset/entity/spawner.albedo.png","./asset/entity/spawner.pbr.png","./asset/entity/spawner.normal.png"),new i.g("./asset/entity/health.albedo.png","./asset/entity/health.pbr.png","./asset/entity/health.normal.png"),new i.g("./asset/entity/armor.albedo.png","./asset/entity/armor.pbr.png","./asset/entity/armor.normal.png"),new i.g("./asset/entity/stamina.albedo.png","./asset/entity/stamina.pbr.png","./asset/entity/stamina.normal.png"),new i.g("./asset/entity/ammo.albedo.png","./asset/entity/ammo.pbr.png","./asset/entity/ammo.normal.png"),new i.g("./asset/entity/weapon.albedo.png","./asset/entity/weapon.pbr.png","./asset/entity/weapon.normal.png"),new i.g("./asset/entity/key.albedo.png","./asset/entity/key.pbr.png","./asset/entity/key.normal.png");const g=[new d("./asset/sound/menu/press.mp3"),new d("./asset/sound/menu/cancel.mp3"),new d("./asset/sound/menu/scroll.mp3"),new d("./asset/sound/menu/move.mp3"),new d("./asset/sound/menu/buy.mp3"),new d("./asset/sound/effect/explode.mp3"),new d("./asset/sound/effect/corrosive.mp3"),new d("./asset/sound/effect/splash.mp3"),new d("./asset/sound/effect/head-shot.mp3"),new d("./asset/sound/effect/bullet-wall-spark.mp3"),new d("./asset/sound/effect/mine-drop.wav"),new d("./asset/sound/effect/damage-ammo.mp3"),new d("./asset/sound/effect/damage-melee.mp3"),new d("./asset/sound/effect/damage-magic.mp3"),new d("./asset/sound/effect/damage-slash.mp3"),new d("./asset/sound/effect/damage-flame.mp3"),new d("./asset/sound/effect/damage-corrosive1.mp3"),new d("./asset/sound/effect/damage-corrosive2.mp3"),new d("./asset/sound/weapon/punch-fire.mp3"),new d("./asset/sound/weapon/punch-fire-charge.mp3"),new d("./asset/sound/weapon/combobooster-fire.mp3"),new d("./asset/sound/weapon/combobooster-loop.mp3"),new d("./asset/sound/weapon/pistol-fire.mp3"),new d("./asset/sound/weapon/hook-fire.mp3"),new d("./asset/sound/weapon/hook-bullet.mp3"),new d("./asset/sound/weapon/machingun-fire.mp3"),new d("./asset/sound/weapon/chainshotgun-fire.wav"),new d("./asset/sound/weapon/chainshotgun-start.wav"),new d("./asset/sound/weapon/chainshotgun-loop.wav"),new d("./asset/sound/weapon/chainshotgun-end.wav"),new d("./asset/sound/weapon/heavycannon-fire.mp3"),new d("./asset/sound/weapon/heavycannon-fire-charge.wav"),new d("./asset/sound/weapon/heavycannon-pump.mp3"),new d("./asset/sound/weapon/shotgun-fire.mp3"),new d("./asset/sound/weapon/shotgun-pump.mp3"),new d("./asset/sound/weapon/launcher-fire.mp3"),new d("./asset/sound/weapon/launcher-pump.mp3"),new d("./asset/sound/weapon/clusterbow-fire.wav"),new d("./asset/sound/weapon/plasmagun-fire.mp3"),new d("./asset/sound/weapon/plasmasmg-fire.mp3"),new d("./asset/sound/weapon/out-of-ammo.mp3"),new d("./asset/sound/weapon/charge-loop.mp3"),new d("./asset/sound/weapon/charge-complete.mp3"),new d("./asset/sound/combo/up.mp3"),new d("./asset/sound/combo/down.mp3"),new d("./asset/sound/item/ammo.mp3"),new d("./asset/sound/item/weapon.mp3"),new d("./asset/sound/item/key.mp3"),new d("./asset/sound/item/meat-1.mp3"),new d("./asset/sound/item/meat-2.mp3"),new d("./asset/sound/item/meat-3.mp3"),new d("./asset/sound/item/meat-mute.mp3"),new d("./asset/sound/item/armor.mp3"),new d("./asset/sound/item/stamina.mp3"),new d("./asset/sound/item/checkpoint.mp3"),new d("./asset/sound/item/spawn.mp3"),new d("./asset/sound/player/step-1.mp3"),new d("./asset/sound/player/step-2.mp3"),new d("./asset/sound/player/step-3.mp3"),new d("./asset/sound/player/step-4.mp3"),new d("./asset/sound/player/landing.mp3"),new d("./asset/sound/player/grab.mp3"),new d("./asset/sound/player/climb.mp3"),new d("./asset/sound/player/sliding.mp3"),new d("./asset/sound/player/wallrun.mp3"),new d("./asset/sound/player/open.mp3"),new d("./asset/sound/player/lock.mp3"),new d("./asset/sound/enemy/no-damage.mp3"),new d("./asset/sound/enemy/find-pistol-1.mp3"),new d("./asset/sound/enemy/find-pistol-2.mp3"),new d("./asset/sound/enemy/find-pistol-3.mp3"),new d("./asset/sound/enemy/find-pistol-4.mp3"),new d("./asset/sound/enemy/find-shotgun-1.mp3"),new d("./asset/sound/enemy/find-shotgun-2.mp3"),new d("./asset/sound/enemy/find-shotgun-3.mp3"),new d("./asset/sound/enemy/find-shotgun-4.mp3"),new d("./asset/sound/enemy/find-shotgun-5.mp3"),new d("./asset/sound/enemy/find-machingun-1.mp3"),new d("./asset/sound/enemy/find-machingun-2.mp3"),new d("./asset/sound/enemy/find-machingun-3.mp3"),new d("./asset/sound/enemy/find-melee-1.mp3"),new d("./asset/sound/enemy/find-melee-2.mp3"),new d("./asset/sound/enemy/find-melee-3.mp3"),new d("./asset/sound/enemy/pain-pistol-1.mp3"),new d("./asset/sound/enemy/pain-pistol-2.mp3"),new d("./asset/sound/enemy/pain-shotgun-1.mp3"),new d("./asset/sound/enemy/pain-shotgun-2.mp3"),new d("./asset/sound/enemy/pain-machingun-1.mp3"),new d("./asset/sound/enemy/pain-machingun-2.mp3"),new d("./asset/sound/enemy/pain-melee-1.mp3"),new d("./asset/sound/enemy/pain-melee-2.mp3"),new d("./asset/sound/enemy/death-pistol-1.mp3"),new d("./asset/sound/enemy/death-shotgun-1.mp3"),new d("./asset/sound/enemy/death-machingun-1.mp3"),new d("./asset/sound/enemy/death-melee-1.mp3"),new d("./asset/sound/enemy/death-armor.mp3"),new d("./asset/sound/enemy/fire-melee.mp3"),new d("./asset/sound/enemy/fire-magic.mp3"),new d("./asset/sound/system/help.mp3")],p=(new s("./asset/wall/default.albedo.png",0),new s("./asset/wall/default.albedo.png",1),new s("./asset/wall/default.albedo.png",2),new s("./asset/wall/default.albedo.png",3),new s("./asset/wall/default.albedo.png",4),new s("./asset/wall/default.albedo.png",5),new s("./asset/wall/default.albedo.png",6),new s("./asset/wall/default.albedo.png",7),new s("./asset/wall/default.albedo.png",8),new s("./asset/wall/default.albedo.png",9),new s("./asset/wall/default.albedo.png",10),new s("./asset/wall/default.albedo.png",11),new s("./asset/wall/default.albedo.png",14),new s("./asset/wall/default.albedo.png",15),new s("./asset/wall/default.albedo.png",16),new s("./asset/wall/default.albedo.png",17),new s("./asset/wall/default.albedo.png",18),new s("./asset/wall/desert.albedo.png",1),new s("./asset/wall/desert.albedo.png",2),new s("./asset/wall/desert.albedo.png",3),new s("./asset/wall/desert.albedo.png",4),new s("./asset/wall/desert.albedo.png",5),new s("./asset/wall/desert.albedo.png",6),new s("./asset/wall/desert.albedo.png",7),new s("./asset/wall/desert.albedo.png",8),new s("./asset/wall/desert.albedo.png",9),new s("./asset/wall/desert.albedo.png",14),new s("./asset/wall/desert.albedo.png",15),new s("./asset/wall/desert.albedo.png",16),new s("./asset/wall/desert.albedo.png",17),new s("./asset/wall/desert.albedo.png",18),new s("./asset/hud/hand.albedo.png",0),new s("./asset/hud/hand.albedo.png",1),new s("./asset/hud/hand.albedo.png",2),new s("./asset/hud/hand.albedo.png",3),new s("./asset/hud/hand.albedo.png",4),new s("./asset/hud/hand.albedo.png",5),new s("./asset/hud/hand.albedo.png",6),new s("./asset/hud/hand.albedo.png",7),new s("./asset/hud/foot.albedo.png",0),new s("./asset/hud/foot.albedo.png",1),new s("./asset/hud/slowball.albedo.png",0),new s("./asset/hud/slowball.albedo.png",1),new s("./asset/hud/binoculars.albedo.png",0),new s("./asset/hud/energyshield.albedo.png",0),new s("./asset/hud/energyshield.albedo.png",1),new s("./asset/hud/energyshield.albedo.png",2),new s("./asset/hud/combobooster.albedo.png",0),new s("./asset/hud/combobooster.albedo.png",1),new s("./asset/hud/hookshot.albedo.png",0),new s("./asset/hud/pistol.albedo.png",0),new s("./asset/hud/pistol.albedo.png",1),new s("./asset/hud/pistol.albedo.png",2),new s("./asset/hud/handcannon.albedo.png",0),new s("./asset/hud/handcannon.albedo.png",1),new s("./asset/hud/handcannon.albedo.png",2),new s("./asset/hud/machingun.albedo.png",0),new s("./asset/hud/machingun.albedo.png",1),new s("./asset/hud/machingun.albedo.png",2),new s("./asset/hud/chainshotgun.albedo.png",0),new s("./asset/hud/chainshotgun.albedo.png",1),new s("./asset/hud/chainshotgun.albedo.png",2),new s("./asset/hud/shotgun.albedo.png",0),new s("./asset/hud/shotgun.albedo.png",1),new s("./asset/hud/shotgun.albedo.png",2),new s("./asset/hud/heavycannon.albedo.png",0),new s("./asset/hud/heavycannon.albedo.png",1),new s("./asset/hud/heavycannon.albedo.png",2),new s("./asset/hud/launcher.albedo.png",0),new s("./asset/hud/launcher.albedo.png",1),new s("./asset/hud/launcher.albedo.png",2),new s("./asset/hud/clusterbow.albedo.png",0),new s("./asset/hud/clusterbow.albedo.png",1),new s("./asset/hud/plasmagun.albedo.png",0),new s("./asset/hud/plasmagun.albedo.png",1),new s("./asset/hud/plasmagun.albedo.png",2),new s("./asset/hud/plasmasmg.albedo.png",0),new s("./asset/hud/plasmasmg.albedo.png",1),new s("./asset/hud/plasmasmg.albedo.png",2),new s("./asset/entity/debug.albedo.png",0),new s("./asset/entity/ui.albedo.png",0),new s("./asset/entity/ui.albedo.png",1),new s("./asset/entity/ui.albedo.png",2),new s("./asset/entity/ui.albedo.png",3),new s("./asset/entity/ui.albedo.png",4),new s("./asset/entity/ui.albedo.png",5),new s("./asset/entity/bullet.albedo.png",0),new s("./asset/entity/bullet.albedo.png",1),new s("./asset/entity/bullet.albedo.png",2),new s("./asset/entity/bullet.albedo.png",3),new s("./asset/entity/bullet.albedo.png",3),new s("./asset/entity/bullet.albedo.png",4),new s("./asset/entity/bullet.albedo.png",5),new s("./asset/entity/bullet.albedo.png",6),new s("./asset/entity/bullet.albedo.png",7),new s("./asset/entity/bullet.albedo.png",8),new s("./asset/entity/bullet.albedo.png",9),new s("./asset/entity/blood.albedo.png",0),new s("./asset/entity/blood.albedo.png",1),new s("./asset/entity/blood.albedo.png",2),new s("./asset/entity/blood.albedo.png",3),new s("./asset/entity/blood.albedo.png",4),new s("./asset/entity/blood.albedo.png",5),new s("./asset/entity/acid.albedo.png",0),new s("./asset/entity/gib.albedo.png",0),new s("./asset/entity/gib.albedo.png",1),new s("./asset/entity/gib.albedo.png",2),new s("./asset/entity/gib.albedo.png",3),new s("./asset/entity/hit.albedo.png",0),new s("./asset/entity/hit.albedo.png",1),new s("./asset/entity/hit.albedo.png",2),new s("./asset/entity/hit.albedo.png",3),new s("./asset/entity/hit.albedo.png",4),new s("./asset/entity/hit.albedo.png",5),new s("./asset/entity/ring.albedo.png",0),new s("./asset/entity/ring.albedo.png",1),new s("./asset/entity/ring.albedo.png",2),new s("./asset/entity/ring.albedo.png",3),new s("./asset/entity/ring.albedo.png",4),new s("./asset/entity/ring.albedo.png",5),new s("./asset/entity/ring.albedo.png",6),new s("./asset/entity/ring.albedo.png",7),new s("./asset/entity/ring.albedo.png",8),new s("./asset/entity/ring.albedo.png",9),new s("./asset/entity/ring.albedo.png",10),new s("./asset/entity/ring.albedo.png",11),new s("./asset/entity/stuff.albedo.png",0),new s("./asset/entity/spark.albedo.png",0),new s("./asset/entity/spark.albedo.png",1),new s("./asset/entity/spark.albedo.png",2),new s("./asset/entity/spark.albedo.png",3),new s("./asset/entity/explode.albedo.png",0),new s("./asset/entity/explode.albedo.png",1),new s("./asset/entity/explode.albedo.png",2),new s("./asset/entity/explode.albedo.png",3),new s("./asset/entity/explode.albedo.png",4),new s("./asset/entity/explode.albedo.png",5),new s("./asset/entity/explode.albedo.png",6),new s("./asset/entity/explode.albedo.png",7),new s("./asset/entity/explode.albedo.png",8),new s("./asset/entity/explode.albedo.png",9),new s("./asset/entity/explode.albedo.png",10),new s("./asset/entity/explode.albedo.png",11),new s("./asset/entity/explode.albedo.png",12),new s("./asset/entity/explode.albedo.png",13),new s("./asset/entity/explode.albedo.png",14),new s("./asset/entity/explode.albedo.png",15),new s("./asset/entity/explode.albedo.png",16),new s("./asset/entity/explode.albedo.png",17),new s("./asset/entity/explode.albedo.png",18),new s("./asset/entity/explode.albedo.png",19),new s("./asset/entity/explode.albedo.png",20),new s("./asset/entity/explode.albedo.png",21),new s("./asset/entity/explode.albedo.png",22),new s("./asset/entity/explode.albedo.png",23),new s("./asset/entity/explode.albedo.png",24),new s("./asset/entity/explode.albedo.png",25),new s("./asset/entity/explode.albedo.png",26),new s("./asset/entity/explode.albedo.png",27),new s("./asset/entity/flame.albedo.png",0),new s("./asset/entity/flame.albedo.png",1),new s("./asset/entity/flame.albedo.png",2),new s("./asset/entity/flame.albedo.png",3),new s("./asset/entity/flame.albedo.png",4),new s("./asset/entity/enemy-guy.albedo.png",0),new s("./asset/entity/enemy-guy.albedo.png",2),new s("./asset/entity/enemy-guy.albedo.png",3),new s("./asset/entity/enemy-guy.albedo.png",4),new s("./asset/entity/enemy-guy.albedo.png",5),new s("./asset/entity/enemy-guy.albedo.png",6),new s("./asset/entity/enemy-guy.albedo.png",7),new s("./asset/entity/enemy-guy.albedo.png",8),new s("./asset/entity/enemy-guy.albedo.png",9),new s("./asset/entity/enemy-guy.albedo.png",10),new s("./asset/entity/enemy-guy.albedo.png",11),new s("./asset/entity/enemy-guy.albedo.png",12),new s("./asset/entity/enemy-guy.albedo.png",13),new s("./asset/entity/enemy-guy.albedo.png",14),new s("./asset/entity/enemy-guy.albedo.png",15),new s("./asset/entity/enemy-guy.albedo.png",16),new s("./asset/entity/enemy-guy.albedo.png",17),new s("./asset/entity/enemy-guy.albedo.png",18),new s("./asset/entity/enemy-guy.albedo.png",19),new s("./asset/entity/enemy-guy.albedo.png",20),new s("./asset/entity/enemy-guy.albedo.png",21),new s("./asset/entity/enemy-guy.albedo.png",22),new s("./asset/entity/enemy-guy.albedo.png",23),new s("./asset/entity/enemy-guy.albedo.png",24),new s("./asset/entity/enemy-guy.albedo.png",25),new s("./asset/entity/enemy-guy.albedo.png",26),new s("./asset/entity/enemy-guy.albedo.png",27),new s("./asset/entity/enemy-guy.albedo.png",30),new s("./asset/entity/enemy-guy.albedo.png",31),new s("./asset/entity/enemy-guy.albedo.png",32),new s("./asset/entity/enemy-guy.albedo.png",35),new s("./asset/entity/enemy-guy.albedo.png",36),new s("./asset/entity/enemy-guy.albedo.png",37),new s("./asset/entity/enemy-guy.albedo.png",40),new s("./asset/entity/enemy-guy.albedo.png",41),new s("./asset/entity/enemy-guy.albedo.png",42),new s("./asset/entity/enemy-guy.albedo.png",45),new s("./asset/entity/enemy-guy.albedo.png",46),new s("./asset/entity/enemy-guy.albedo.png",47),new s("./asset/entity/enemy-guy.albedo.png",50),new s("./asset/entity/enemy-guy.albedo.png",51),new s("./asset/entity/enemy-guy.albedo.png",52),new s("./asset/entity/helmet.albedo.png",0),new s("./asset/entity/helmet.albedo.png",1),new s("./asset/entity/enemy-armor.albedo.png",0),new s("./asset/entity/enemy-armor.albedo.png",1),new s("./asset/entity/enemy-armor.albedo.png",2),new s("./asset/entity/enemy-armor.albedo.png",3),new s("./asset/entity/enemy-armor.albedo.png",4),new s("./asset/entity/object.albedo.png",0),new s("./asset/entity/object.albedo.png",1),new s("./asset/entity/object.albedo.png",2),new s("./asset/entity/object.albedo.png",3),new s("./asset/entity/checkpoint.albedo.png",0),new s("./asset/entity/checkpoint.albedo.png",1),new s("./asset/entity/spawner.albedo.png",0),new s("./asset/entity/health.albedo.png",0),new s("./asset/entity/health.albedo.png",1),new s("./asset/entity/health.albedo.png",2),new s("./asset/entity/armor.albedo.png",0),new s("./asset/entity/stamina.albedo.png",0),new s("./asset/entity/ammo.albedo.png",0),new s("./asset/entity/ammo.albedo.png",1),new s("./asset/entity/ammo.albedo.png",2),new s("./asset/entity/ammo.albedo.png",3),new s("./asset/entity/ammo.albedo.png",4),new s("./asset/entity/weapon.albedo.png",0),new s("./asset/entity/weapon.albedo.png",6),new s("./asset/entity/weapon.albedo.png",12),new s("./asset/entity/weapon.albedo.png",18),new s("./asset/entity/weapon.albedo.png",24),new s("./asset/entity/weapon.albedo.png",30),new s("./asset/entity/weapon.albedo.png",36),new s("./asset/entity/weapon.albedo.png",1),new s("./asset/entity/weapon.albedo.png",7),new s("./asset/entity/weapon.albedo.png",2),new s("./asset/entity/weapon.albedo.png",8),new s("./asset/entity/weapon.albedo.png",3),new s("./asset/entity/weapon.albedo.png",9),new s("./asset/entity/weapon.albedo.png",4),new s("./asset/entity/weapon.albedo.png",10),new s("./asset/entity/weapon.albedo.png",5),new s("./asset/entity/weapon.albedo.png",11),new s("./asset/entity/key.albedo.png",0),new s("./asset/entity/key.albedo.png",1),new s("./asset/entity/key.albedo.png",2),new s("./asset/entity/key.albedo.png",3),new r(.5,.5,.5,"NONE","NONE","NONE","NONE","NONE","NONE")),f=new r(.5,.5,.5,"NONE","NONE","NONE","NONE","NONE","NONE");new r(.5,.5,.5,"WALL","WALL","WALL","WALL","CEIL","FLOOR"),new r(.5,.5,.5,"DOOR_DEFAULT","DOOR_DEFAULT","DOOR_DEFAULT","DOOR_DEFAULT","DOOR_DEFAULT","DOOR_DEFAULT"),new r(.5,.5,.5,"DOOR_RED","DOOR_RED","DOOR_RED","DOOR_RED","DOOR_RED","DOOR_RED"),new r(.5,.5,.5,"DOOR_BLUE","DOOR_BLUE","DOOR_BLUE","DOOR_BLUE","DOOR_BLUE","DOOR_BLUE"),new r(.5,.5,.5,"DOOR_YELLOW","DOOR_YELLOW","DOOR_YELLOW","DOOR_YELLOW","DOOR_YELLOW","DOOR_YELLOW"),new r(.5,.5,.5,"EDIT_BLOCK","EDIT_BLOCK","EDIT_BLOCK","EDIT_BLOCK","EDIT_BLOCK","EDIT_BLOCK")},202:(e,t,n)=>{"use strict";n.d(t,{mI:()=>o,rw:()=>a,y3:()=>r});var s=n(983);const i=new s.zv("window"),a=new s.zv("display-log"),r=new s.zv("worker-tick"),o=new s.zv("worker-paint");"window"in self&&i.addEventListener("message",(e=>{const{data:t}=e;if(t instanceof Object)switch(t.method){case"shatdown":self.close();break;case"reload":self.location.reload()}}))},459:(e,t,n)=>{"use strict";n.d(t,{x:()=>i});var s=n(437);class i{constructor(){this.data=Array(),this.locations=new Array,this.isTransfer=!1;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.src=t}async load(){0===this.data.length&&(this.data=await Promise.all(this.src.map((async e=>(await(0,s.hn)(e)).source))))}hasTransfer(){return this.isTransfer}createTransferData(){return this.isTransfer=!0,{src:this.src,locations:this.locations}}}},727:(e,t,n)=>{"use strict";n.d(t,{s:()=>a});var s=n(459),i=n(959);class a extends s.x{async load(){0===this.data.length&&(this.data=await Promise.all(this.src.map((async e=>await(0,i.B)(e)))))}}},764:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});var s=n(727);class i extends s.s{}},352:(e,t,n)=>{"use strict";n.a(e,(async(e,s)=>{try{n.d(t,{l:()=>d});var i=n(402),a=n(276),r=n(46),o=n(959),l=n(574),h=e([r]);r=(h.then?(await h)():h)[0];class c{constructor(e,t){this.buffer=(0,r.vL)(e,t)}get width(){return this.buffer.width}set width(e){this.buffer.width=e}get height(){return this.buffer.height}set height(e){this.buffer.height=e}getContext(){return this.buffer.getContext("2d")}async toDataURL(){const e=this.buffer;let t;return 0===e.width||0===e.height?"data:,":(r.aE&&e instanceof OffscreenCanvas?t=await e.convertToBlob():e instanceof HTMLCanvasElement&&(t=await new Promise((t=>e.toBlob((e=>{e instanceof Blob&&t(e)}))))),await new Promise((e=>{const n=new FileReader;n.onload=()=>{const t=n.result;"string"==typeof t&&e(t)},n.readAsDataURL(t)})))}async transferToImageBitmap(){const e=this.buffer;return r.aE&&e instanceof OffscreenCanvas?e.transferToImageBitmap():await(0,o.B)(await this.toDataURL())}getBuffer(){return this.buffer}}class u{constructor(e,t,n){this.id=e,this.position=new a.FM(t,n)}}class d{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:64;this.bufferIDCount=0,this.isUpdate=!0,this.albedoBuffer=new c(0,0),this.pbrBuffer=new c(0,0),this.normalBuffer=new c(0,0),this.unloadBufferIDCache=new Array,this.tile_size=64,this.tile_size=e}getID(){(0,l.qr)(this.unloadBufferIDCache).asc();let e=this.unloadBufferIDCache.shift();return void 0===e&&(e=this.bufferIDCount++),e}unloadID(e){this.unloadBufferIDCache.push(e)}getSize(){return[this.albedoBuffer.width,this.albedoBuffer.height]}getTileSize(){return this.tile_size}getBuffer(){return{albedo:this.albedoBuffer.getBuffer(),pbr:this.pbrBuffer.getBuffer(),normal:this.normalBuffer.getBuffer()}}checkUpdate(){const e=this.isUpdate;return this.isUpdate=!1,e}load(e,t,n){const s=new Array,a=new Array,r=new Array;[...new Array(e.width/this.tile_size*e.height/this.tile_size).fill(null)].forEach((()=>{const e=this.getID(),[t,n]=(0,i.sS)(e);s.push(e),a.push(t*this.tile_size),r.push(n*this.tile_size)}));const o=s.map(((s,i)=>[{source:e,buffer:this.albedoBuffer},{source:t,buffer:this.pbrBuffer},{source:n,buffer:this.normalBuffer}].map((e=>{let{source:t,buffer:n}=e;const o=a[i],l=r[i],h=Math.max(...a),d=Math.max(...r),g=Math.max(t.width,h+this.tile_size,t.height,d+this.tile_size);if(0===n.width||0===n.height)n.width=g,n.height=g;else if(g>n.width||g>n.height){const e=new c(g,g),t=e.getContext();null!==t&&(t.imageSmoothingEnabled=!1,t.drawImage(n.getBuffer(),0,0)),n.width=g,n.height=g;const s=n.getContext();null!==s&&(s.imageSmoothingEnabled=!0,s.clearRect(0,0,n.width,n.height),s.drawImage(e.getBuffer(),0,0))}let p,f;t.width<=i*this.tile_size?(p=this.tile_size*i%t.width,f=Math.floor(this.tile_size*i/t.width)*this.tile_size):(p=i*this.tile_size,f=0);const m=n.getContext();return null!==m&&(m.imageSmoothingEnabled=!1,m.drawImage(t,p,f,this.tile_size,this.tile_size,o,l,this.tile_size,this.tile_size)),new u(s,o,l)}))));return this.isUpdate=!0,o}unload(e){[this.albedoBuffer,this.pbrBuffer,this.normalBuffer].forEach((t=>{e.forEach((e=>{const n=new Array,s=new Array;e.forEach((e=>{n.push(e.position.x),s.push(e.position.y),this.unloadID(e.id)}));const i=0===n.length?0:Math.min(...n),a=0===s.length?0:Math.min(...s),r=Math.max(Math.min(t.width,i),Math.min(t.height,a));if(0===r||0===r)t.width=0,t.height=0;else if(r<t.width||r<t.height){const e=new c(r,r),n=e.getContext();null!==n&&(n.imageSmoothingEnabled=!1,n.drawImage(t.getBuffer(),0,0)),t.width=e.width,t.height=e.height;const s=t.getContext();null!==s&&(s.imageSmoothingEnabled=!0,s.clearRect(0,0,t.width,t.height),s.drawImage(e.getBuffer(),0,0))}this.isUpdate=!0,0!==t.width&&0!==t.height&&e.forEach((e=>{const n=e.position.x,s=e.position.y;if(n<t.width&&s<t.height){const e=t.getContext();null!==e&&(e.imageSmoothingEnabled=!1,e.clearRect(n,s,this.tile_size,this.tile_size))}}))}))}))}}s()}catch(e){s(e)}}))},279:(e,t,n)=>{"use strict";n.a(e,(async(e,s)=>{try{n.d(t,{m:()=>l});var i=n(352),a=n(764),r=n(574),o=e([i]);i=(o.then?(await o)():o)[0];class l{constructor(e,t){this.assets={},this.isUpdate=!0,this.buffer=new i.l(e),t.forEach((e=>e.src.forEach((t=>this.assets[t.toLowerCase()]=e))))}getBuffer(){return this.buffer}getBufferLocation(e,t){const n=this.assets.hasOwnProperty(e)?this.assets[e]:null;if(null===n)return 0;const s=void 0!==n.locations[t]?n.locations[t][0]:null;return null===s?0:s.id}getAssetSource(e){return this.assets.hasOwnProperty(e)?this.assets[e].data[0]:null}hasAsset(e){return this.assets.hasOwnProperty(e)}getAssetLenght(){return Object.keys(this.assets).length}async load(e){const t=Object.keys(this.assets);await Promise.all(t.map((t=>this.assets[t].load().then(e))));for(const e in this.assets){const t=this.assets[e];t instanceof a.g&&t.locations.push(...this.buffer.load(t.data[0],t.data[1],t.data[2]))}this.isUpdate=!0}async unload(){for(const e in this.assets){const t=this.assets[e];t instanceof a.g&&this.buffer.unload(t.locations),(0,r.vF)(t.locations)}this.isUpdate=!0}checkUpdate(){const{isUpdate:e}=this;return this.isUpdate=!1,e}createTransferData(){const e={};for(const t in this.assets){const n=this.assets[t];n.hasTransfer()||(e[t]=n.createTransferData())}return{assets:e,isUpdate:this.isUpdate}}}s()}catch(e){s(e)}}))},365:(e,t,n)=>{"use strict";n.d(t,{Y:()=>c});var s=n(563),i=n(424),a=n(768),r=n(749);class o{constructor(e,t,n,s,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.buffer=null,this.lfo=null,this.depth=null,this.oscillator=null,this.isStop=!1,this.id=e,this.src=n,this.context=s,this.source=s.createBufferSource(),this.volume=s.createGain(),this.target=a,this.sounds=t,this.volume.connect(i),null!==this.target?(this.panner=s.createPanner(),this.source.connect(this.panner).connect(this.volume)):(this.panner=null,this.source.connect(this.volume)),this.endedListener=()=>{this.stop()},this.source.addEventListener("ended",this.endedListener,!1),new r.j(this,"play").on((()=>this.source.start(s.currentTime)))}initVibrato(){null!==this.lfo&&null!==this.depth&&null!==this.oscillator||(this.lfo=this.context.createOscillator(),this.depth=this.context.createGain(),this.oscillator=this.context.createOscillator(),this.oscillator.connect(this.volume).connect(this.context.destination),this.lfo.connect(this.depth).connect(this.oscillator.frequency),this.lfo.start())}getID(){return this.id}play(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.buffer=e,this.sounds.hasPlay()?this.hasPlay()?this.isStop&&(this.isStop=!1,new r.j(this,"play").trigger({})):(this.source.buffer=this.buffer,this.source.loop=t,new r.j(this,"play").trigger({})):this.stop()}pause(){this.hasPlay()&&(this.source.stop(),this.isStop=!0,new r.j(this,"pause").trigger({}))}stop(){new r.j(this,"stop").trigger({})}hasPlay(){return null!==this.source.buffer}getSrc(){return this.src}setVolume(e){return this.volume.gain.value=(0,a._1)(e,0),this}setSpeed(e){return this.source.playbackRate.value=(0,a._1)(e,0),this}setTarget(e){return this.target=e,this}setOscillatorType(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"sine";return null!==e&&(this.initVibrato(),null!==this.oscillator&&(this.oscillator.type=e)),this}setVibratoSpeed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return 0!==e&&(this.initVibrato(),null!==this.lfo&&(this.lfo.frequency.value=0|(0,a._1)(e,0))),this}setVibratoDepth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return 0!==e&&(this.initVibrato(),null!==this.depth&&(this.depth.gain.value=0|(0,a._1)(e,0))),this}update(){if(null!==this.target&&null!==this.panner)try{this.panner.positionX.setValueAtTime((0,a._1)(this.target.x,0),this.context.currentTime),this.panner.positionY.setValueAtTime((0,a._1)(this.target.y,0),this.context.currentTime),this.panner.positionZ.setValueAtTime((0,a._1)(this.target.z,0),this.context.currentTime)}catch(e){this.panner.setPosition((0,a._1)(this.target.x,0),(0,a._1)(this.target.y,0),(0,a._1)(this.target.z,0))}}onstop(){this.source.removeEventListener("ended",this.endedListener),this.source.disconnect(),this.source.buffer=null}}var l=n(276);class h{constructor(e){this.context=(0,s.T)(new AudioContext),this.sounds={},this.isPlay=!0,this.id=e,this.volume=this.context.createGain(),this.volume.connect(this.context.destination)}getID(){return this.id}getSound(e){if(!this.sounds.hasOwnProperty(e))throw new Error('Not found sound is "'.concat(e));return this.sounds[e]}getSounds(){return Object.values(this.sounds)}createSound(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,i.D)();this.sounds.hasOwnProperty(n)&&this.sounds[n].stop();const s=this.sounds[n]=new o(n,this,e,this.context,this.volume,t);return new r.j(s,"stop").on((()=>delete this.sounds[n])),s}hasSound(e){return this.sounds.hasOwnProperty(e)}play(){this.isPlay||(this.context.resume(),this.isPlay=!0)}pause(){this.isPlay&&(this.context.suspend(),this.isPlay=!1)}stop(){Object.keys(this.sounds).forEach((e=>this.sounds[e].stop())),this.isPlay=!1}setVolume(e){return this.volume.gain.value=(0,a._1)(e,0),this}setSpeed(e){for(const t in this.sounds)this.sounds[t].setSpeed(e);return this}getVolume(){return this.volume.gain.value}getContext(){return this.context}hasPlay(){return this.isPlay}updateCenter(e,t){const[n,s,i]=(0,l.XC)(e.x,e.y),[r,o,h]=(0,l.fB)(e.x,e.y),c=this.context.listener;try{c.positionX.setValueAtTime((0,a._1)(t.x,0),this.context.currentTime),c.positionY.setValueAtTime((0,a._1)(t.y,0),this.context.currentTime),c.positionZ.setValueAtTime((0,a._1)(t.z,0),this.context.currentTime),c.forwardX.setValueAtTime((0,a._1)(n,0),this.context.currentTime),c.forwardY.setValueAtTime((0,a._1)(s,0),this.context.currentTime),c.forwardZ.setValueAtTime((0,a._1)(i,0),this.context.currentTime),c.upX.setValueAtTime((0,a._1)(r,0),this.context.currentTime),c.upY.setValueAtTime((0,a._1)(o,0),this.context.currentTime),c.upZ.setValueAtTime((0,a._1)(h,0),this.context.currentTime)}catch(e){c.setPosition((0,a._1)(t.x,0),(0,a._1)(t.y,0),(0,a._1)(t.z,0)),c.setOrientation((0,a._1)(n,0),(0,a._1)(s,0),(0,a._1)(i,0),(0,a._1)(r,0),(0,a._1)(o,0),(0,a._1)(h,0))}}updateSounds(){for(const e in this.sounds)this.sounds[e].update()}}class c{constructor(e){this.contexts={},this.nowSceneName=null,this.assets=e}createContext(e){if(this.contexts.hasOwnProperty(e))throw new Error('Not redefine audio context is "'.concat(e,'"'));return this.contexts[e]=new h(e)}getContext(e){if(!this.contexts.hasOwnProperty(e))throw new Error('Not found audio context is ""'.concat(e,'"'));return this.contexts[e]}hasContext(e){return this.contexts.hasOwnProperty(e)}play(){const e=this.getNowSceneName();if(null===e)return;const t=this.getContext(e);for(const e in this.contexts){const n=this.contexts[e];n!==t&&n.pause()}t.play()}pause(){for(const e in this.contexts){this.contexts[e].pause()}}getNowSceneName(){return this.nowSceneName}createTransferData(){const e=new Array;for(const t in this.contexts){const n=this.contexts[t];if(n.hasPlay()){n.getSounds().forEach((t=>{t.hasPlay()&&e.push(t.getID())}));break}}return{lives:e}}update(){}rendering(e){this.hasContext(e.sceneName)||this.createContext(e.sceneName),this.nowSceneName=e.sceneName;const t=this.getContext(e.sceneName);t.setVolume(e.volume);for(const e in this.contexts){const n=this.contexts[e];n!==t&&n.pause()}t.play();for(const n in e.sounds){const s=e.sounds[n];if(s.init||t.createSound(s.src,s.target,s.id).getID(),!t.hasSound(s.id))continue;const i=t.getSound(s.id);if(s.isPlay){const e=this.assets.getAssetSource(i.getSrc());null!==e&&i.play(e)}else i.pause();i.setVolume(s.volume),i.setSpeed(s.speed*e.speed),i.setTarget(s.target),i.setOscillatorType(s.oscillatorType),i.setVibratoSpeed(s.vibratoSpeed),i.setVibratoDepth(s.vibratoDepth)}t.getSounds().forEach((t=>{e.sounds.hasOwnProperty(t.getID())||t.stop()})),t.updateCenter(e.center.direction,e.center.position),t.updateSounds()}}},711:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});var s=n(768);class i{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;this.presss=new Array,this.axess=new Array,this.axesNames=new Array,this.keys={},this.name=e,this.sensibility=t,this.channel=n,self.addEventListener("blur",(()=>this.clear()))}getName(){return this.name}firePress(e,t){if("string"==typeof e){for(let n=0,s=0|this.presss.length;n<s;n=n+1|0)this.presss[n](e,t);this.channel.postMessage({method:"press",name:e,press:t,inputType:this.getName()})}}fireAxes(e,t,n){if("string"==typeof e){this.axesNames.includes(e)||this.axesNames.push(e),"y"===e&&(t*=this.sensibility,n*=this.sensibility),t=(0,s._1)(t,0),n=(0,s._1)(n,0);for(let s=0,i=0|this.axess.length;s<i;s=s+1|0){(0,this.axess[s])(e,t,n)}this.channel.postMessage({method:"axes",name:e,x:t,y:n,inputType:this.getName()})}}press(e){-1===this.presss.indexOf(e)&&this.presss.push(e)}axes(e){-1===this.axess.indexOf(e)&&this.axess.push(e)}clear(){for(const e in this.keys)this.keys[e]&&(this.firePress(e,!1),this.keys[e]=!1);this.axesNames.forEach((e=>{this.channel.postMessage({method:"axes",name:e,x:0,y:0,inputType:this.getName()})}))}update(){}}},813:(e,t,n)=>{"use strict";n.d(t,{n:()=>h});var s=n(276),i=n(574);function a(){return"getGamepads"in self.navigator?[...self.navigator.getGamepads()]:[]}var r=n(711),o=n(749);const l={axes:{left:[0,1],right:[2,3]},buttons:{a:0,b:1,x:2,y:3,lb:4,rb:5,lt:6,rt:7,select:8,start:9,ls:10,rs:11,up:12,down:13,left:14,right:15,home:16}};class h extends r.o{constructor(e,t,n){super("gamepad",e,n),this.isConnectGamepad=!1,this.addx=0,this.addy=0,this.addd=0,this.addl=0,this.buttons=new Array,this.pushs={},this.haptics=new Array,this.setting=t}getInnerDeadzoneX(){return this.setting.stickInnerDeadzoneX||0}getOuterDeadzoneX(){return this.setting.stickOuterDeadzoneX||0}getInnerDeadzoneY(){return this.setting.stickInnerDeadzoneY||0}getOuterDeadzoneY(){return this.setting.stickOuterDeadzoneY}addHaptics(){this.haptics.push(...arguments)}update(){const e=a(),t=[...e].some((e=>null!==e));this.isConnectGamepad!==t&&new o.j(this,"changeconnect").trigger({value:t}),this.isConnectGamepad=t;let n=!1;for(let t=0,a=0|e.length;t<a;t=t+1|0){const a=e[t];if(a&&"standard"===a.mapping){const{axes:e}=l,t=(0,s.KO)(a.axes[e.left[0]],-a.axes[e.left[1]],0,0),r=(0,s.KO)(a.axes[e.right[0]],a.axes[e.right[1]],0,0),o=new s.FM(Math.max(Math.abs(Math.cos(t)),Math.abs(Math.sin(t))),Math.max(Math.abs(Math.cos(r)),Math.abs(Math.sin(r)))),h=o.x*this.getInnerDeadzoneX(),c=o.y*this.getInnerDeadzoneY(),u=o.x*this.getOuterDeadzoneX(),d=o.y*this.getOuterDeadzoneY(),g=Math.min(1,Math.max(-1,(a.axes[e.left[0]]>0?Math.max(a.axes[e.left[0]]-h,0):Math.min(a.axes[e.left[0]]+h,0))/Math.max(0,1-h-u))),p=Math.min(1,Math.max(-1,(-a.axes[e.left[1]]>0?Math.max(-a.axes[e.left[1]]-h,0):Math.min(-a.axes[e.left[1]]+h,0))/Math.max(0,1-h-u))),f=Math.min(1,Math.max(-1,(a.axes[e.right[0]]>0?Math.max(a.axes[e.right[0]]-c,0):Math.min(a.axes[e.right[0]]+c,0))/Math.max(0,1-c-d))),m=Math.min(1,Math.max(-1,(a.axes[e.right[1]]>0?Math.max(a.axes[e.right[1]]-c,0):Math.min(a.axes[e.right[1]]+c,0))/Math.max(0,1-c-d)));this.addx===g&&this.addy===p||(this.fireAxes("x",g,p),this.addx=g,this.addy=p),this.addd===f&&this.addl===m||(this.fireAxes("y",f,m),this.addd=f,this.addl=m);const y=this.buttons.slice();(0,i.vF)(this.buttons),a.buttons.forEach(((e,t)=>{const{buttons:n}=l;for(const s in n){const i="gamepad_".concat(s);n[s]===t&&e.pressed&&(this.pushs[i]||(this.firePress(i,!0),this.pushs[i]=!0),this.buttons.push(i))}})),y.forEach((e=>{-1===this.buttons.indexOf(e)&&this.pushs[e]&&(this.firePress(e,!1),this.pushs[e]=!1)})),n=!0;break}}if(!n){const e=0,t=0,n=0,s=0;this.addx===e&&this.addy===t||(this.fireAxes("x",e,t),this.addx=e,this.addy=t),this.addd===n&&this.addl===s||(this.fireAxes("y",n,s),this.addd=n,this.addl=s),this.buttons.forEach((e=>{this.pushs[e]&&(this.firePress(e,!1),this.pushs[e]=!1)}))}}}},169:(e,t,n)=>{"use strict";n.d(t,{N:()=>h});var s=n(276);const i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"alt",19:"pause_break",20:"caps_lock",27:"escape",32:"space",33:"page_up",34:"page_down",35:"end",36:"home",37:"left_arrow",38:"up_arrow",39:"right_arrow",40:"down_arrow",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"left_window_key",92:"right_window_key",93:"select_key",96:"numpad_0",97:"numpad_1",98:"numpad_2",99:"numpad_3",100:"numpad_4",101:"numpad_5",102:"numpad_6",103:"numpad_7",104:"numpad_8",105:"numpad_9",106:"multiply",107:"add",109:"subtract",110:"decimal_point",111:"divide",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"num_lock",145:"scroll_lock",186:"semi_colon",187:"equal_sign",188:"comma",189:"dash",190:"period",191:"forward_slash",192:"grave_accent",219:"open_bracket",220:"back_slash",221:"close_braket",222:"single_quote"},a={0:"none",1:"left",2:"middle",3:"right",4:"wheel_down",5:"wheel_up"};var r=n(711),o=n(768),l=n(481);class h extends r.o{constructor(e,t,n){let r,o,h;super("keyboard",e,n),this.isPointerLockPoint=!1,this.private=0,this.pointer=new s.FM(0,0),this.curs=new s.FM(0,0),this.cursors=new Array,this.controlElement=t,(0,l.Ot)(t),document.body.addEventListener("keydown",(e=>{e.preventDefault(),e.stopPropagation();const t="keyboard_".concat(i[e.keyCode]);return this.keys[t]||(this.keys[t]=!0,this.firePress(t,!0)),!1}),!1),document.body.addEventListener("keyup",(e=>{e.preventDefault(),e.stopPropagation();const t="keyboard_".concat(i[e.keyCode]);return this.keys[t]&&(this.keys[t]=!1,this.firePress(t,!1)),!1}),!1),t.addEventListener("mousedown",(e=>{e.preventDefault(),e.stopPropagation();const t="mouse_".concat(a[e.which]);return this.keys[t]=!0,this.firePress(t,!0),this.keys[a[4]]&&(clearTimeout(r),r=setTimeout((()=>{this.keys[a[4]]&&this.firePress(a[4],!1)}),10)),this.keys[a[5]]&&(clearTimeout(o),o=setTimeout((()=>{this.keys[a[5]]&&this.firePress(a[5],!1)}),10)),!1}),!1),t.addEventListener("mouseup",(e=>{e.preventDefault(),e.stopPropagation();const t="mouse_".concat(a[e.which]);return this.keys[t]=!1,this.firePress(t,!1),!1}),!1),t.addEventListener("wheel",(e=>{e.preventDefault(),e.stopPropagation();const t="mouse_".concat(a[e.deltaY>0?4:5]);return this.keys[t]=!0,this.firePress(t,!0),!1}),{passive:!1}),t.addEventListener("mousemove",(e=>{if(e.preventDefault(),e.stopPropagation(),(0,l.Xq)()){const t=e.movementX/1920,n=e.movementY/1080;this.isPointerLockPoint?(this.pointer.x+=t,this.pointer.y+=n):(this.pointer.x=t,this.pointer.y=n),this.fireAxes("y",this.pointer.x,this.pointer.y),clearTimeout(h),this.isPointerLockPoint||(h=setTimeout((()=>{this.pointer.x=0,this.pointer.y=0,this.fireAxes("y",this.pointer.x,this.pointer.y)}),10))}else performance.now()-(0,l.Uu)()>100&&(this.curs.x=e.offsetX/t.clientWidth,this.curs.y=e.offsetY/t.clientHeight,this.fireCursor(this.curs.x,this.curs.y));return!1}),!1),n.addEventListener("message",(e=>{const{data:t}=e;if(t instanceof Object&&"stick"===t.method)this.setPointerLookPoint(t.value)}))}cursor(e){-1===this.cursors.indexOf(e)&&this.cursors.push(e)}fireCursor(e,t){e=(0,o._1)(e,0),t=(0,o._1)(t,0),this.cursors.forEach((n=>n(e,t))),this.channel.postMessage({method:"cursor",x:e,y:t,inputType:this.getName()})}setPointerLookPoint(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.isPointerLockPoint;e!==this.isPointerLockPoint&&(!this.isPointerLockPoint||0===this.pointer.x&&0===this.pointer.y||(this.pointer.x=0,this.pointer.y=0,this.fireAxes("y",this.pointer.x,this.pointer.y)),this.isPointerLockPoint=e)}hasPointerLookPoint(){return this.isPointerLockPoint}update(){}}},615:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});var s=n(276),i=n(169);class a{constructor(){this.inputType=null,this.buttons={},this.axes={x:new s.FM(0,0),y:new s.FM(0,0),z:new s.FM(0,0)},this.pointer=new s.FM(0,0);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.controls=t,t.forEach((e=>{e.press(((t,n)=>{this.buttons[t]=n,this.inputType=e.getName()})),e.axes(((t,n,s)=>{switch(t){case"x":this.axes.x.x=n,this.axes.x.y=s;break;case"y":this.axes.y.x=n,this.axes.y.y=s;break;case"z":this.axes.z.x=n,this.axes.z.y=s}this.inputType=e.getName()})),e instanceof i.N&&e.cursor(((t,n)=>{this.pointer.x=t,this.pointer.y=n,this.inputType=e.getName()}))}))}getInputType(){return this.inputType}update(){this.controls.forEach((e=>e.update()))}applyData(e){e.controls.isClear&&this.controls.forEach((e=>e.clear()))}}},990:(e,t,n)=>{"use strict";n.d(t,{X:()=>h});var s=n(276),i=n(711),a=n(736),r=n(301),o=n(666);function l(e){return(e||"").length>0?(e||"").split(" "):[]}class h extends i.o{constructor(e,t,n,i){super("touchpad",e,n),this.html="",this.pointer=new s.FM(0,0),this.init=!1,this.actions=new Map,this.visible=!1,this.controlElement=t,this.html=i,n.addEventListener("message",(e=>{const{data:t}=e;if(t instanceof Object&&"stick"===t.method)this.changeStick(t.name,t.value)}))}query(e){return[].slice.call(this.controlElement.querySelectorAll(e))}pressAction(e){this.actions.get(e)||(this.actions.set(e,!0),this.firePress("touchpad_".concat(e),!0))}releaseAction(e){this.actions.get(e)&&(this.actions.set(e,!1),this.firePress("touchpad_".concat(e),!1))}hasAction(e){return this.actions.get(e)||!1}initialize(){this.init||(this.init=!0,this.controlElement.innerHTML=this.html,this.query(".touch-cross").forEach((e=>{const t="calc(".concat(e.getAttribute("size")," / 3.0)"),n=e.hasAttribute("capture"),s=l(e.getAttribute("secondary")),i=parseInt(e.getAttribute("interval")||"0")||300,r=e.getAttribute("press-up")||"",o=e.getAttribute("press-down")||"",h=e.getAttribute("press-right")||"",c=e.getAttribute("press-left")||"";let u,d=null;e.innerHTML='\n\t\t\t\t<div class="touch-layer" size="'.concat(t,'" bottom="50%" left="50%" color="').concat(e.getAttribute("color"),'" font="').concat(e.getAttribute("font"),'"></div>\n\t\t\t\t<div class="touch-layer" button-name="').concat(r,'" size="').concat(t,'" bottom="50% + ').concat(t,'" left="50%" color="').concat(e.getAttribute("color"),'" font="').concat(e.getAttribute("font"),'" style="border-top-right-radius:5px; border-top-left-radius:5px;"></div>\n\t\t\t\t<div class="touch-layer" button-name="').concat(o,'" size="').concat(t,'" bottom="50% - ').concat(t,'" left="50%" color="').concat(e.getAttribute("color"),'" font="').concat(e.getAttribute("font"),'" style="border-bottom-right-radius:5px; border-bottom-left-radius:5px;"></div>\n\t\t\t\t<div class="touch-layer" button-name="').concat(h,'" size="').concat(t,'" bottom="50%" left="50% + ').concat(t,'" color="').concat(e.getAttribute("color"),'" font="').concat(e.getAttribute("font"),'" style="border-top-right-radius:5px; border-bottom-right-radius:5px;"></div>\n\t\t\t\t<div class="touch-layer" button-name="').concat(c,'" size="').concat(t,'" bottom="50%" left="50% - ').concat(t,'" color="').concat(e.getAttribute("color"),'" font="').concat(e.getAttribute("font"),'" style="border-top-left-radius:5px; border-bottom-left-radius:5px;"></div>\n\t\t\t');let g="none";const p=t=>{if(n||(t.preventDefault(),t.stopPropagation()),null===t.target)return;const s=e.getBoundingClientRect(),i=s.left,l=s.top;let u="none";const d=t.target.clientWidth/3;if(Array.prototype.slice.call(t.changedTouches).forEach((t=>{if(t.target!==e)return;const n=t.pageX-i,s=t.pageY-l;if(n<d||n>2*d||s<d||s>2*d)switch(!0){case n<d&&s<d:u="".concat(r," ").concat(c);break;case n>2*d&&s<d:u="".concat(r," ").concat(h);break;case s>2*d&&n<d:u="".concat(o," ").concat(c);break;case n>2*d&&s>2*d:u="".concat(o," ").concat(h);break;case n>d&&n<2*d&&s<d:u=r;break;case n>d&&s>2*d&&n<2*d:u=o;break;case s>d&&n<d&&s<2*d:u=c;break;case n>2*d&&s>d&&s<2*d:u=h}})),g!==u){const t=[].slice.call(e.children);g.split(" ").forEach((e=>this.releaseAction(e))),u.split(" ").forEach((e=>this.pressAction(e))),t.forEach((t=>{if(t.hasAttribute("button-name")){const n=t.getAttribute("button-name");if(null===n)return;-1!==u.indexOf(n)?(0,a.A_)(t,"backgroundColor",e.getAttribute("hover")||""):-1!==g.indexOf(n)&&(0,a.A_)(t,"backgroundColor",e.getAttribute("color")||"")}}))}g=u},f=t=>{n||(t.preventDefault(),t.stopPropagation()),s.forEach((e=>this.releaseAction(e))),g.split(" ").forEach((e=>this.releaseAction(e))),[].slice.call(e.children).forEach((t=>{const n=t.getAttribute("button-name");null!==n&&-1!==g.indexOf(n)&&(0,a.A_)(t,"backgroundColor",e.getAttribute("color")||"")})),g="none"};e.addEventListener("touchstart",(e=>{const t=performance.now();p(e),clearTimeout(u),null!==d&&t-d<i?s.forEach((e=>this.pressAction(e))):(d=t,u=setTimeout((()=>{d=null}),i))}),{passive:!1,capture:n}),e.addEventListener("touchmove",p,{passive:!1,capture:n}),e.addEventListener("touchend",f,n),e.addEventListener("touchcancel",f,n)})),this.query("[primary]").forEach((e=>{const t=l(e.getAttribute("primary")),n=l(e.getAttribute("secondary")),s=e.hasAttribute("capture"),i=e.hasAttribute("exit");let a,r,o,h=parseInt(e.getAttribute("interval")||"0"),c=null,u=!1;if(isNaN(h))switch(!0){case e.hasAttribute("hold"):h=150;break;case e.hasAttribute("double"):h=225;break;case e.hasAttribute("quick"):h=275;break;default:h=0}switch(!0){case e.hasAttribute("hold"):r=e=>{s||(e.preventDefault(),e.stopPropagation()),clearTimeout(a),a=setTimeout((()=>{u=!0,n.forEach((e=>this.pressAction(e)))}),h),t.forEach((e=>this.releaseAction(e)))};break;case e.hasAttribute("double"):r=e=>{s||(e.preventDefault(),e.stopPropagation()),null!==c&&performance.now()-c<h?(c=null,clearTimeout(a),n.forEach((e=>this.pressAction(e)))):(c=performance.now(),clearTimeout(a),a=setTimeout((()=>{u=!0,c=null,t.forEach((e=>this.pressAction(e)))}),h))};break;case e.hasAttribute("quick"):r=e=>{s||(e.preventDefault(),e.stopPropagation()),null!==c&&performance.now()-c<h?(c=null,n.forEach((e=>this.pressAction(e)))):(c=performance.now(),t.forEach((e=>this.pressAction(e))))};break;default:r=e=>{s||(e.preventDefault(),e.stopPropagation()),t.forEach((e=>this.pressAction(e)))}}switch(!0){case e.hasAttribute("hold"):o=e=>{s||(e.preventDefault(),e.stopPropagation()),clearTimeout(a),u?(u=!1,n.forEach((e=>this.releaseAction(e)))):(t.forEach((e=>this.pressAction(e))),a=setTimeout((()=>{t.forEach((e=>this.releaseAction(e)))}),h))};break;case e.hasAttribute("double"):o=e=>{s||(e.preventDefault(),e.stopPropagation()),u?(u=!1,t.forEach((e=>this.releaseAction(e)))):clearTimeout(a),n.forEach((e=>this.releaseAction(e)))};break;case e.hasAttribute("quick"):default:o=e=>{s||(e.preventDefault(),e.stopPropagation()),t.forEach((e=>this.releaseAction(e))),n.forEach((e=>this.releaseAction(e)))}}e.addEventListener("touchstart",r,{passive:!1,capture:s}),e.addEventListener("touchend",o,s),e.addEventListener("touchcancel",o,s),i&&e.addEventListener("touchend",(()=>this.hide()))})),this.query(".touch-button, .touch-layout, .touch-layer").forEach((e=>{let t,n;e.hasAttribute("size")?t=n=e.getAttribute("size"):(t=e.getAttribute("width"),n=e.getAttribute("height")),(0,a.tt)(e,{width:t||"",height:n||"",top:"calc(".concat(e.getAttribute("top")," - ").concat(n," / 2)"),bottom:"calc(".concat(e.getAttribute("bottom")," - ").concat(n," / 2)"),left:"calc(".concat(e.getAttribute("left")," - ").concat(t," / 2)"),right:"calc(".concat(e.getAttribute("right")," - ").concat(t," / 2)")})})),this.query(".touch-button, .touch-layer").forEach((e=>{let t="",n="";e.hasAttribute("size")?t=n=e.getAttribute("size")||"":(t=e.getAttribute("width")||"",n=e.getAttribute("height")||""),e.hasAttribute("radius")&&(0,a.A_)(e,"borderRadius","".concat((e.getAttribute("radius")||"").length?e.getAttribute("radius"):"".concat(/\%$/.test(t)||/\%$/.test(n)?"50vw":Number((t.match(/^[0-9.]+/)||[])[0])<Number((n.match(/^[0-9.]+/)||[])[0])?t:n))),(0,a.tt)(e,{backgroundColor:"".concat(e.getAttribute("color")),color:"".concat(e.getAttribute("font"))})})),this.query(".touch-axes").forEach((e=>{let t,n=-1,s=-1,i=-1;e.addEventListener("touchstart",(e=>{e.preventDefault(),[...e.changedTouches].forEach((e=>{let{identifier:t,clientX:a,clientY:r}=e;-1===n&&-1===s&&-1===i&&(n=t,s=a,i=r)}))}),{passive:!1}),e.addEventListener("touchmove",(a=>{a.preventDefault();let o=0,l=0;[...a.changedTouches].forEach((a=>{let{identifier:h,clientX:c,clientY:u}=a;if(n!==h)return;-1!==s&&-1!==i&&(o=c-s,l=u-i),e.hasAttribute("stick")||(s=c,i=u);const[d,g]=(0,r.bY)(),p=Math.min(d,g)/3;"y"===e.getAttribute("name")?(this.pointer.x=o/p,this.pointer.y=l/p,e.hasAttribute("stick")?(this.pointer.x+=o/p,this.pointer.y+=l/p):(clearTimeout(t),t=setTimeout((()=>{this.pointer.x=0,this.pointer.y=0,this.fireAxes("y",this.pointer.x,this.pointer.y)}),10)),this.fireAxes("y",this.pointer.x,this.pointer.y)):this.fireAxes(e.getAttribute("name")||"",o/p,l/p)}))}),{passive:!1});const a=t=>{t.preventDefault(),[...t.changedTouches].forEach((t=>{let{identifier:a,clientX:r,clientY:o}=t;n===a&&(n=-1,s=-1,i=-1,"y"===e.getAttribute("name")&&(this.pointer.x=0,this.pointer.y=0),this.fireAxes(e.getAttribute("name")||"",0,0))}))};e.addEventListener("touchend",a),e.addEventListener("touchcancel",a)})),this.updateVisible())}show(){this.visible=!0}hide(){this.visible=!1}hasVisible(){return"none"!==this.controlElement.style.display}updateVisible(){this.controlElement&&(0,a.A_)(this.controlElement,"display",(0,o.Pe)()&&this.visible?"block":"none")}changeStick(e,t){[...document.querySelectorAll('.touch-axes[name="'.concat(e,'"]'))].forEach((e=>{null!==e&&(t?e.setAttribute("stick","stick"):e.removeAttribute("stick"))}))}update(){this.initialize()}rendering(){null!==this.controlElement&&(this.updateVisible(),this.query(".touch-hover").forEach((e=>{if(e.hasAttribute("hover")){(0,a.A_)(e,"backgroundColor",e.getAttribute("color")||"");l(e.getAttribute("primary")).concat(l(e.getAttribute("secondary"))).forEach((t=>{this.hasAction(t)&&(0,a.A_)(e,"backgroundColor",e.getAttribute("hover")||"")}))}})))}}},574:(e,t,n)=>{"use strict";n.d(t,{vF:()=>p,Sy:()=>f,qr:()=>g});var s=n(790),i=function(e){return function(t,n,s){return e(t,n,s)*s}},a=function(e,t){if(e)throw Error("Invalid sort config: "+t)},r=function(e){var t=e||{},n=t.asc,s=t.desc,r=n?1:-1,o=n||s;return a(!o,"Expected `asc` or `desc` property"),a(n&&s,"Ambiguous object with `asc` and `desc` config properties"),{order:r,sortBy:o,comparer:e.comparer&&i(e.comparer)}};function o(e,t,n){if(void 0===e||!0===e)return function(e,s){return t(e,s,n)};if("string"==typeof e)return a(e.includes("."),"String syntax not allowed for nested properties."),function(s,i){return t(s[e],i[e],n)};if("function"==typeof e)return function(s,i){return t(e(s),e(i),n)};if(Array.isArray(e)){var s=function(e){return function t(n,s,i,a,o,l,h){var c,u;if("string"==typeof n)c=l[n],u=h[n];else{if("function"!=typeof n){var d=r(n);return t(d.sortBy,s,i,d.order,d.comparer||e,l,h)}c=n(l),u=n(h)}var g=o(c,u,a);return(0===g||null==c&&null==u)&&s.length>i?t(s[i],s,i+1,a,o,l,h):g}}(t);return function(i,a){return s(e[0],e,1,n,t,i,a)}}var i=r(e);return o(i.sortBy,i.comparer||t,i.order)}var l=function(e,t,n,s){return Array.isArray(t)?(Array.isArray(n)&&n.length<2&&(n=n[0]),t.sort(o(n,s,e))):t};function h(e){var t=i(e.comparer);return function(n){var s=Array.isArray(n)&&!e.inPlaceSorting?n.slice():n;return{asc:function(e){return l(1,s,e,t)},desc:function(e){return l(-1,s,e,t)},by:function(e){return l(1,s,e,t)}}}}var c=function(e,t,n){return null==e?n:null==t?-n:e<t?-1:e>t?1:0},u=(h({comparer:c}),h({comparer:c,inPlaceSorting:!0}));class d{constructor(e){this.sorter=null,this.sorter=u(e)}asc(e){this.sorter.asc(e)}desc(e){this.sorter.desc(e)}}function g(e){return new d(e)}function p(e){if(s.D1)for(;e.length>0;)e.pop();else e.length=0}function f(e){for(let t=e.length-1|0,n=0;t>n;t--){const n=Math.floor(Math.random()*(t+1)),s=e[t];e[t]=e[n],e[n]=s}}},563:(e,t,n)=>{"use strict";n.d(t,{T:()=>a});const s=["touchstart","touchend","mousedown","keydown"],i=new WeakMap;function a(e){if(i.get(e)||"suspended"!==e.state)return e;const t=self.document.body;function n(){e.resume().then(a)}function a(){s.forEach((e=>t.removeEventListener(e,n))),i.delete(e)}return s.forEach((e=>t.addEventListener(e,n,!1))),i.set(e,!0),e}},790:(e,t,n)=>{"use strict";n.d(t,{D1:()=>a});var s=n(762);const i=self.navigator.userAgent.length>0?(0,s.getParser)(self.navigator.userAgent):null,a=(i&&i.isBrowser("chrome"),i&&i.getOS().name,i&&i.isBrowser("firefox"));i&&i.isBrowser("safari")},46:(e,t,n)=>{"use strict";n.a(e,(async(e,s)=>{try{n.d(t,{aE:()=>i,mC:()=>o,qm:()=>a,vL:()=>r});const e=new(n(52).V)(Worker,(function(){postMessage(!(!("OffscreenCanvas"in self)||!new OffscreenCanvas(1,1).getContext("2d")),[])})),i="OffscreenCanvas"in self,a=await e.exec();function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"OffscreenCanvas"in self?new OffscreenCanvas(e,t):(()=>{const n=document.createElement("canvas");return n.width=e,n.height=t,n})()}function o(e){return"OffscreenCanvas"in self&&a&&e instanceof HTMLCanvasElement?e.transferControlToOffscreen():e}e.terminate(),s()}catch(e){s(e)}}),1)},736:(e,t,n)=>{"use strict";n.d(t,{A_:()=>a,tt:()=>r,yG:()=>o});const s=new WeakMap,i=new WeakMap;function a(e,t,n){s.has(e)||s.set(e,{});const i=s.get(e)||null;null!==i&&i[t]!==n&&(e.style[t]=n,i[t]=n)}function r(e,t){for(const n in t)a(e,n,t[n])}function o(e,t){(i.get(e)||null)!==t&&(e.innerHTML=t,i.set(e,t))}},749:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});const s=new WeakMap;class i{constructor(e,t){this.type=t,this.timestamp=performance.now(),this.target=e}on(e){let t=s.get(this.target);void 0===t&&s.set(this.target,t=new Map),t.has(this.type)||t.set(this.type,new Array);const n=t.get(this.type);void 0!==n&&n.push(e)}off(e){const t=s.get(this.target);if(void 0===t||!t.has(this.type))return;const n=t.get(this.type);void 0!==n&&n.includes(e)&&n.splice(n.indexOf(e))}trigger(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=s.get(this.target)||null,n=this.target["on".concat(this.type)];if(null===t&&!(n instanceof Function))return;for(const t in e)Object.defineProperty(this,t,{writable:!1,enumerable:!0,configurable:!0,value:e[t]});n instanceof Function&&n.call(this.target,this);const i=null!==t&&t.get(this.type)||null;if(null!==i)for(let e=0,t=0|i.length;e<t;e=e+1|0)i[e].call(this.target,this)}async triggerAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=s.get(this.target),n=this.target["on".concat(this.type)];if(void 0===t&&!(n instanceof Function))return;for(const t in e)Object.defineProperty(this,t,{writable:!1,enumerable:!0,configurable:!0,value:e[t]});n instanceof Function&&await n.call(this.target,this);const i=void 0!==t?t.get(this.type):void 0;if(void 0!==i)for(let e=0,t=0|i.length;e<t;e=e+1|0){const t=(0,i[e])(this);t instanceof Promise&&await t}}}},437:(e,t,n)=>{"use strict";function s(e){return btoa(unescape(encodeURIComponent(e)))}n.d(t,{hn:()=>p,DU:()=>g});var i=n(148),a=n(983),r=n(666);let o=!1;const l=new a.zv("file");function h(e,t){switch(e.toLowerCase()){case"text":return t.text();case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json();case"xml":return t.text().then((e=>(new DOMParser).parseFromString(e,"text/xml")));case"html":return t.text().then((e=>(new DOMParser).parseFromString(e,"text/html")))}return null}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{method:"GET",mode:"cors",cache:"no-store",credentials:"same-origin"};try{return await(0,i.h)(e,n).then((async e=>e.ok?await h(t,e):null))}catch(e){return console.error(e),null}}async function u(e){let t=null;o=!0;try{const n=prompt(e);null!==n&&(t=await c(n,"text"))}catch(e){console.error(e)}finally{o=!1}return t}async function d(e,t,n,i,a){let r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const l=r?e:"".concat(prompt("enter file name")||e).concat(n?"."+n[0]:"");switch(o=!0,i){case"text":a="data:".concat(t?t[0]:"",";charset=utf-8;base64,").concat(s(a));break;case"blob":a=URL.createObjectURL(new Blob([a],{type:t[0]}))}const h=document.createElement("a");h.href=a,h.download=l,document.body.appendChild(h),h.click(),h.remove(),"blob"===i&&URL.revokeObjectURL(a),await new Promise((e=>{const t=()=>{self.removeEventListener("focus",t,!1),e(null)};self.addEventListener("focus",t,!1)})),o=!1}function g(){return o}async function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=e;if(/^(data|blob):/.test(e)||new RegExp("^".concat(location.origin)).test(e))s=e;else if("file:"!==location.protocol){const t=/^http:\/\/[^\/]+\/$|^file:\/\/[^\/]+\/$|^http:\/\/$|^file:\/\/$/.test(location.origin)?location.origin.substring(0,location.origin.length-1):location.origin,n=(/^http:\/\/|^file:\/\//.test(location.pathname)||0===location.pathname.length?"/":location.pathname).replace(/\/[^\/]+$/,"/");s="".concat(t).concat(n).concat(e.replace(/^\.\/|^\//,""))}const i=await c(s,t,n);if(null===i)throw new Error("Not found file is ".concat(e));return{source:i,src:s}}(0,r.nq)()||l.addEventListener("message",(async e=>{const{data:t}=e;if(!(t instanceof Object))return;let n=null;switch(t.method){case"open":n=await async function(e,t,n){return(0,r.nq)()?await new Promise((s=>{const i=e=>{const{data:t}=e;if(t instanceof Object&&(l.removeEventListener("message",i),"return"===t.method))t.data&&s(t.data)};l.addEventListener("message",i),l.postMessage({method:"open",description:e,mimeTypes:t,extensions:n})})):"showOpenFilePicker"in window&&self.isSecureContext?await async function(e,t,n){let s=null;o=!0;try{const i=(await showOpenFilePicker({types:[{description:e,accept:(()=>{const e={};return e[t[0]]=n.map((e=>".".concat(e))),e})()}]}))[0];if("granted"===await i.requestPermission({mode:"read"})){const e=await i.getFile();s=await e.text()}else u(e)}catch(e){console.error(e.message)}finally{o=!1}return s}(e,t,n):u(e)}(t.description,t.mimeTypes,t.extensions);break;case"save":await async function(e,t,n,s,i){(0,r.nq)()?await new Promise((a=>{const r=e=>{l.removeEventListener("message",r),a(null)};l.addEventListener("message",r),l.postMessage({method:"save",description:e,mimeTypes:t,extensions:n,type:s,text:i})})):"showSaveFilePicker"in self&&self.isSecureContext?await async function(e,t,n,s,i){let a="boxengine-file".concat(n?"."+n[0]:""),r=null;o=!0;try{const l=await window.showSaveFilePicker({types:[{description:e,accept:(()=>{const e={};return e[t[0]]=n.map((e=>".".concat(e))),e})()}]});a=l.name,"granted"===await l.requestPermission({mode:"readwrite"})?(r=await l.createWritable(),await r.truncate(0),await r.write(i)):await d(a,t,n,s,i instanceof Function?i():i,!0)}catch(e){console.error("Cannot save complete.")}finally{null!==r&&await r.close(),o=!1}}(e,t,n,s,i):d("boxengine-file",t,n,s,i instanceof Function?i():i)}(t.description,t.mimeTypes,t.extensions,t.type,t.text)}l.postMessage({method:"return",data:n})}))},329:(e,t,n)=>{"use strict";n.d(t,{I4:()=>d,Kw:()=>p,Qg:()=>m,Zx:()=>f,mU:()=>g});var s=n(983),i=n(424),a=n(666);let r=!1,o=!1,l=!1,h=!1;const c=new s.zv("fullscreen"),u=new Array;function d(){c.postMessage({method:"hack",value:p()})}function g(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,a.nq)()?u.length>0?h:(0,a.Vp)()?o:e?l||r:l:(0,a.Vp)()?o:null!==document.fullscreenElement||!!e&&p()}function p(){return(0,a.nq)()?r:window.innerHeight>=window.outerHeight||window.innerHeight>=window.outerWidth}function f(){const e=async t=>{if((0,a.nq)()){const e=(0,i.D)(),n=s=>{const{data:i}=s;if(i instanceof Object&&i.key===e&&"success"===i.method)u.includes(i.key)&&u.splice(u.indexOf(i.key),1),c.removeEventListener("message",n),t(null)};h=!0,u.push(e),c.addEventListener("message",n),c.postMessage({method:"exec",value:!0,key:e})}else if((0,a.Vp)())o||("api"in self&&self.api.fullscreen(!0),o=!0,window.dispatchEvent(new UIEvent("resize")),c.postMessage({method:"electron",value:o})),t(null);else if(g(!(0,a.Vp)()))t(null);else if(null!==document.body){function e(){c.postMessage({method:"browser",value:g()}),t(null)}document.body.requestFullscreen().then(e).catch(e)}else window.addEventListener("load",(()=>e(t)))};return new Promise(e)}async function m(){(0,a.nq)()?await new Promise((e=>{const t=(0,i.D)(),n=s=>{const{data:i}=s;if(i instanceof Object&&i.key===t&&"success"===i.method)u.includes(i.key)&&u.splice(u.indexOf(i.key),1),c.removeEventListener("message",n),e(null)};h=!1,u.push(t),c.addEventListener("message",n),c.postMessage({method:"exec",value:!1,key:t})})):g(!(0,a.Vp)())&&((0,a.Vp)()?o&&("api"in self&&self.api.fullscreen(!1),o=!1,window.dispatchEvent(new UIEvent("resize")),c.postMessage({method:"electron",value:o})):g(!1)&&await document.exitFullscreen())}(0,a.nq)()?c.addEventListener("message",(e=>{const{data:t}=e;if(t instanceof Object)switch(t.method){case"browser":l=t.value;break;case"hack":r=t.value;break;case"electron":o=t.value;break;case"success":u.includes(t.key)&&u.splice(u.indexOf(t.key),1)}})):(c.addEventListener("message",(async e=>{const{data:t}=e;if(t instanceof Object){if("exec"===t.method)await(t.value?f():m());c.postMessage({method:"success",key:t.key})}})),document.addEventListener("fullscreenchange",(e=>{l=!!document.fullscreenElement,c.postMessage({method:"browser",value:l})})))},148:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});var s=n(424),i=n(983),a=n(666);let r;r=(0,a.nq)(!1)?async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(((n,a)=>{const r=(0,s.D)();addEventListener("message",(function e(t){const{data:s}=t;s instanceof Object&&r===s.key&&"fetch"===s.method&&(removeEventListener("message",e),s.error?a():n(new Response(s.data,{status:200})))})),(0,i.gC)({method:"fetch",type:"arraybuffer",options:t,url:e,key:r},[])}))}:(0,a.Vp)()&&"localhost"!==location.hostname?async function(e){const t=await("api"in self?self.api.request(e):null);return new Response(t,{status:t?200:404})}:self.fetch;const o=r},959:(e,t,n)=>{"use strict";n.d(t,{B:()=>i});var s=n(437);async function i(e){let t;if("createImageBitmap"in self){const n=(await(0,s.hn)(e,"blob")).source;t=await createImageBitmap(n)}else Image.prototype.decode?(t=new Image,await t.decode()):t=await new Promise((t=>{const n=new Image;n.onload=()=>{t(n)},n.onerror=()=>{throw new Error("Not found image to ".concat(e))},n.src=e}));return t}},580:(e,t,n)=>{"use strict";n.d(t,{X0:()=>c,nL:()=>u});var s=n(983),i=n(424),a=n(666);const r=new s.zv("local-storage"),o={};(0,a.nq)()?r.addEventListener("message",(e=>{const{data:t}=e;if(t instanceof Object&&"save"===t.method){const e=o[t.name]||{};for(const t in e)delete e[t];for(const n in t.data)e[n]=t.data[n];o[t.name]=e}})):r.addEventListener("message",(e=>{const{data:t}=e;if(t instanceof Object)switch(t.method){case"load":c(t.name).then((e=>{r.postMessage({method:"load",name:t.name,data:e,key:t.key})}));break;case"save":c(t.name).then((e=>{for(const n in t.data)e[n]=t.data[n];u(t.name).then((e=>{r.postMessage({method:"save",name:t.name,data:t.data,key:t.key})}))}));break;case"delete":(async function(e){if((0,a.nq)()){if(!o.hasOwnProperty(e))return;let t=(0,i.D)();return delete o[e],await new Promise((n=>{function s(e){const{data:i}=e;if(i instanceof Object&&i.key===t&&"delete"===i.method)r.removeEventListener("message",s),o[i.name]=i.data,t=null,n(i.data)}r.addEventListener("message",s),r.postMessage({method:"delete",name:e,key:t})}))}{const t=await c(e);for(const e in t)delete t[e];await u(e)}})(t.name).then((()=>{r.postMessage({method:"delete",name:t.name,key:t.key})}))}}));const l=function(e,t){switch(!0){case void 0===t:case null===t:return{__extendData__:!0,type:"null",value:""};case Number.isNaN(t):return{__extendData__:!0,type:"number",value:"NaN"};case Number.POSITIVE_INFINITY===t:return{__extendData__:!0,type:"number",value:"Infinity"};case Number.NEGATIVE_INFINITY===t:return{__extendData__:!0,type:"number",value:"-Infinity"};case t instanceof Date:return{__extendData__:!0,type:"date",value:t.toISOString()};case"symbol"==typeof t:return{__extendData__:!0,type:"symbol",value:Symbol.keyFor(t)}}return t},h=function(e,t){if("object"!=typeof t||!t.__extendData__)return t;switch(t.type){case"undefined":return;case"null":return null;case"number":switch(t.value){case"NaN":return Number.NaN;case"Infinity":case"+Infinity":return Number.POSITIVE_INFINITY;case"-Infinity":return Number.NEGATIVE_INFINITY}case"date":return new Date(t.value);case"symbol":return Symbol.for(t.value)}};async function c(e){let t={};if((0,a.nq)()){if(o.hasOwnProperty(e))return o[e];let n=(0,i.D)();t=await new Promise((t=>{const s=e=>{const{data:i}=e;if(i instanceof Object&&i.key===n&&"load"===i.method)r.removeEventListener("message",s),o[i.name]=i.data,n=null,t(i.data)};r.addEventListener("message",s),r.postMessage({method:"load",name:e,key:n})}))}else if(o.hasOwnProperty(e))t=o[e];else{const n=localStorage.getItem(e);if(n&&n.length>0)try{t=JSON.parse(n,h)}catch(n){localStorage.removeItem(e),t={}}o[e]=t}return t}async function u(e){if((0,a.nq)()){if(!o.hasOwnProperty(e))return;let t=(0,i.D)();await new Promise((n=>{const s=e=>{const{data:i}=e;if(i instanceof Object&&i.key===t&&"save"===i.method)r.removeEventListener("message",s),t=null,n(null)};r.addEventListener("message",s),r.postMessage({method:"save",name:e,data:o[e],key:t})}))}else if(o.hasOwnProperty(e))try{localStorage.setItem(e,JSON.stringify(o[e],l))}catch(e){}}},34:(e,t,n)=>{"use strict";n.d(t,{Er:()=>c,gw:()=>h});var s=n(736),i=n(202);n(574);const a={},r=new Array;let o=!1,l=!1;function h(e,t){r.push({id:e,message:t})}function c(){var e,t;const n=document.querySelector("#log");if(null===n)return;const i=Object.keys(a);if(o&&!l&&i.length>0){n.classList.add("log");for(let e=0,t=0|i.length;e<t;e=e+1|0){const t=i[e],r=a[t];if(void 0===r)break;let o=n.children[e]||null;null===o&&(o=document.createElement("div"),n.appendChild(o)),o instanceof HTMLElement&&(0,s.yG)(o,r)}for(;n.children.length>i.length;)null===(e=n.children[0].parentNode)||void 0===e||e.removeChild(n.children[0])}else for(n.classList.remove("log");n.children.length>0;)null===(t=n.children[0].parentNode)||void 0===t||t.removeChild(n.children[0])}"window"in self&&i.rw.addEventListener("message",(e=>{const{data:t}=e;if(t instanceof Object)switch(t.method){case"enable":o=!0;break;case"disable":o=!1;break;case"log":l=!1;for(const e in t.messages){const{id:n,message:s}=t.messages[e];a[n]=s}const e=Object.values(t.messages);for(const t in a)e.some((e=>e.id===t))||delete a[t];break;case"stop":l=!0}}))},768:(e,t,n)=>{"use strict";function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.floor;return isNaN(e)||e===1/0?t:-1===n?e:s(Math.abs(e)*n)/n*Math.sign(e)}function i(e,t,n){return isNaN(e)||isNaN(t)||isNaN(n)?0:e===1/0||t===1/0||n===1/0?1/0:e*(1-n)+t*n}n.d(t,{CD:()=>i,_1:()=>s})},402:(e,t,n)=>{"use strict";function s(e){let t=e;return t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),t}function i(e){let t=e;return t&=1023,t=4278190335&(t^t<<16),t=50393103&(t^t<<8),t=51130563&(t^t<<4),t=153391689&(t^t<<2),t}function a(e){let t=e;return t&=1431655765,t=858993459&(t|t>>1),t=252645135&(t|t>>2),t=16711935&(t|t>>4),t=65535&(t|t>>8),t}function r(e){return e}function o(e,t){return s(0|e)|s(0|t)<<1}function l(e,t,n){return i(0|e)|i(0|t)<<1|i(0|n)<<2}function h(e){return[a(e>>0),a(e>>1)]}n.d(t,{Hq:()=>l,mY:()=>r,nI:()=>o,sS:()=>h})},666:(e,t,n)=>{"use strict";n.d(t,{Pe:()=>g,Tt:()=>p,Vp:()=>d,nq:()=>u});var s=n(121),i=n.n(s),a=n(317),r=n.n(a);let o=i()(),l=r()(),h="api"in self&&self.api.hasSteam(),c="api"in self&&self.api.hasOpenSteamOverlay();function u(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!e)return"postMessage"in self&&"importScripts"in self;try{return!!importScripts}catch(e){return!1}}function d(){return o}function g(){return l}function p(){return c}setInterval((()=>{o=i()(),l=r()(),h="api"in self&&self.api.hasSteam(),c="api"in self&&self.api.hasOpenSteamOverlay()}))},481:(e,t,n)=>{"use strict";n.d(t,{HW:()=>m,Ot:()=>g,Uu:()=>d,Xq:()=>p,d3:()=>f});var s=n(983),i=n(424),a=n(666);const r=new s.zv("pointer-lock");let o=!1,l=!1,h=null,c=-1;const u=new Array;function d(){return c}function g(e){h=e}function p(){return(0,a.nq)()?u.length>0?l:o:null!==document.pointerLockElement}async function f(){return await new Promise(((e,t)=>{if((0,a.nq)()){const t=(0,i.D)(),n=s=>{const{data:i}=s;if(i instanceof Object&&i.key===t&&"success"===i.method)u.includes(i.key)&&u.splice(u.indexOf(i.key),1),r.removeEventListener("message",n),e()};l=!0,r.addEventListener("message",n),r.postMessage({method:"exec",value:!0,key:t})}else if(p())e();else{const n=()=>{document.removeEventListener("pointerlockchange",s),document.removeEventListener("pointerlockerror",i)},s=()=>{n(),e()},i=e=>{n(),t()};document.addEventListener("pointerlockchange",s,!1),document.addEventListener("pointerlockerror",i,!1),null!==document.body?null!==h&&h.requestPointerLock():window.addEventListener("load",(()=>f().then(e).catch(t)))}}))}async function m(){c=performance.now(),(0,a.nq)()?await new Promise(((e,t)=>{const n=(0,i.D)(),s=t=>{const{data:i}=t;if(i instanceof Object&&i.key===n&&"success"===i.method)u.includes(i.key)&&u.splice(u.indexOf(i.key),1),r.removeEventListener("message",s),e(null)};l=!1,u.push(n),r.addEventListener("message",s),r.postMessage({method:"exec",value:!1,key:n})})):p()&&document.exitPointerLock()}(0,a.nq)()?r.addEventListener("message",(e=>{const{data:t}=e;if(t instanceof Object&&"exec"===t.method)o=t.value})):(r.addEventListener("message",(async e=>{const{data:t}=e;if(t instanceof Object){if("exec"===t.method)await(t.value?f():m());r.postMessage({method:"success",key:t.key})}})),document.addEventListener("pointerlockchange",(()=>{r.postMessage({method:"exec",value:null!==document.pointerLockElement})})),document.addEventListener("pointerlockerror",(()=>{r.postMessage({method:"exec",value:!1})})))},983:(e,t,n)=>{"use strict";n.d(t,{zv:()=>ge,Vw:()=>pe,gC:()=>fe});var s=n(749);Promise.resolve(!1),Promise.resolve(!0);var i=Promise.resolve();function a(e,t){return e||(e=0),new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))}function r(){return Math.random().toString(36).substring(2)}var o=0,l=0;function h(){var e=(new Date).getTime();return e===o?1e3*e+ ++l:(o=e,l=0,1e3*e)}var c="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);const u={create:function(e){var t={messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t},close:function(e){e.bc.close(),e.subFns=[]},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){try{return e.bc.postMessage(t,!1),i}catch(e){return Promise.reject(e)}},canBeUsed:function(){if(c&&"undefined"==typeof window)return!1;if("function"==typeof BroadcastChannel){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}return!1},type:"native",averageResponseTime:function(){return 150},microSeconds:h};var d=function(){function e(e){this.ttl=e,this.set=new Set,this.timeMap=new Map}return e.prototype.has=function(e){return this.set.has(e)},e.prototype.add=function(e){var t=this;this.timeMap.set(e,g()),this.set.add(e),setTimeout((function(){!function(e){var t=g()-e.ttl,n=e.set[Symbol.iterator]();for(;;){var s=n.next().value;if(!s)return;if(!(e.timeMap.get(s)<t))return;e.timeMap.delete(s),e.set.delete(s)}}(t)}),0)},e.prototype.clear=function(){this.set.clear(),this.timeMap.clear()},e}();function g(){return(new Date).getTime()}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return void 0===t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&"function"==typeof e.idb.onclose&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=12e4),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),void 0===t.node.useFastPath&&(t.node.useFastPath=!0),t}var f="messages",m={durability:"relaxed"};function y(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function w(e){e.commit&&e.commit()}function b(e,t){var n=e.transaction(f,"readonly",m),s=n.objectStore(f),i=[],a=IDBKeyRange.bound(t+1,1/0);if(s.getAll){var r=s.getAll(a);return new Promise((function(e,t){r.onerror=function(e){return t(e)},r.onsuccess=function(t){e(t.target.result)}}))}return new Promise((function(e,r){var o=function(){try{return a=IDBKeyRange.bound(t+1,1/0),s.openCursor(a)}catch(e){return s.openCursor()}}();o.onerror=function(e){return r(e)},o.onsuccess=function(s){var a=s.target.result;a?a.value.id<t+1?a.continue(t+1):(i.push(a.value),a.continue()):(w(n),e(i))}}))}function v(e,t){return function(e,t){var n=(new Date).getTime()-t,s=e.transaction(f,"readonly",m),i=s.objectStore(f),a=[];return new Promise((function(e){i.openCursor().onsuccess=function(t){var i=t.target.result;if(i){var r=i.value;if(!(r.time<n))return w(s),void e(a);a.push(r),i.continue()}else e(a)}}))}(e,t).then((function(t){return function(e,t){var n=e.transaction([f],"readwrite",m).objectStore(f);return Promise.all(t.map((function(e){var t=n.delete(e);return new Promise((function(e){t.onsuccess=function(){return e()}}))})))}(e,t.map((function(e){return e.id})))}))}function x(e){e.closed||M(e).then((function(){return a(e.options.idb.fallbackInterval)})).then((function(){return x(e)}))}function M(e){return e.closed?i:e.messagesCallback?b(e.db,e.lastCursorId).then((function(t){var n=t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return function(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}(t,e)})).sort((function(e,t){return e.time-t.time}));return n.forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),i})):i}const S={create:function(e,t){return t=p(t),function(e){var t="pubkey.broadcast-channel-0-"+e,n=y().open(t);return n.onupgradeneeded=function(e){e.target.result.createObjectStore(f,{keyPath:"id",autoIncrement:!0})},new Promise((function(e,t){n.onerror=function(e){return t(e)},n.onsuccess=function(){e(n.result)}}))}(e).then((function(n){var s={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:r(),eMIs:new d(2*t.idb.ttl),writeBlockPromise:i,messagesCallback:null,readQueuePromises:[],db:n};return n.onclose=function(){s.closed=!0,t.idb.onclose&&t.idb.onclose()},x(s),s}))},close:function(e){e.closed=!0,e.db.close()},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t,M(e)},postMessage:function(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return function(e,t,n){var s={uuid:t,time:(new Date).getTime(),data:n},i=e.transaction([f],"readwrite",m);return new Promise((function(e,t){i.oncomplete=function(){return e()},i.onerror=function(e){return t(e)},i.objectStore(f).add(s),w(i)}))}(e.db,e.uuid,t)})).then((function(){var t,n;0===(t=0,n=10,Math.floor(Math.random()*(n-t+1)+t))&&v(e.db,e.options.idb.ttl)})),e.writeBlockPromise},canBeUsed:function(){return!c&&!!y()},type:"idb",averageResponseTime:function(e){return 2*e.idb.fallbackInterval},microSeconds:h};function k(){var e;if("undefined"==typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(e){}return e}function P(e){return"pubkey.broadcastChannel-"+e}function _(){if(c)return!1;var e=k();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch(e){return!1}return!0}const E={create:function(e,t){if(t=p(t),!_())throw new Error("BroadcastChannel: localstorage cannot be used");var n=r(),s=new d(t.localstorage.removeTimeout),i={channelName:e,uuid:n,eMIs:s};return i.listener=function(e,t){var n=P(e),s=function(e){e.key===n&&t(JSON.parse(e.newValue))};return window.addEventListener("storage",s),s}(e,(function(e){i.messagesCallback&&e.uuid!==n&&e.token&&!s.has(e.token)&&(e.data.time&&e.data.time<i.messagesCallbackTime||(s.add(e.token),i.messagesCallback(e.data)))})),i},close:function(e){var t;t=e.listener,window.removeEventListener("storage",t)},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){a().then((function(){var s=P(e.channelName),i={token:r(),time:(new Date).getTime(),data:t,uuid:e.uuid},a=JSON.stringify(i);k().setItem(s,a);var o=document.createEvent("Event");o.initEvent("storage",!0,!0),o.key=s,o.newValue=a,window.dispatchEvent(o),n()}))}))},canBeUsed:_,type:"localstorage",averageResponseTime:function(){var e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")?240:120},microSeconds:h};var O=h,A=new Set;const L={create:function(e){var t={name:e,messagesCallback:null};return A.add(t),t},close:function(e){A.delete(e)},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){return setTimeout((function(){Array.from(A).filter((function(t){return t.name===e.name})).filter((function(t){return t!==e})).filter((function(e){return!!e.messagesCallback})).forEach((function(e){return e.messagesCallback(t)})),n()}),5)}))},canBeUsed:function(){return!0},type:"simulate",averageResponseTime:function(){return 5},microSeconds:O};var C=[u,S,E];var T,D=new Set,F=0,z=function(e,t){var n,s,i;this.id=F++,D.add(this),this.name=e,T&&(t=T),this.options=p(t),this.method=function(e){var t=[].concat(e.methods,C).filter(Boolean);if(e.type){if("simulate"===e.type)return L;var n=t.find((function(t){return t.type===e.type}));if(n)return n;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||c||(t=t.filter((function(e){return"idb"!==e.type})));var s=t.find((function(e){return e.canBeUsed()}));if(s)return s;throw new Error("No useable method found in "+JSON.stringify(C.map((function(e){return e.type}))))}(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,s=(n=this).method.create(n.name,n.options),(i=s)&&"function"==typeof i.then?(n._prepP=s,s.then((function(e){n._state=e}))):n._state=s};function B(e,t,n){var s={time:e.method.microSeconds(),type:t,data:n};return(e._prepP?e._prepP:i).then((function(){var t=e.method.postMessage(e._state,s);return e._uMP.add(t),t.catch().then((function(){return e._uMP.delete(t)})),t}))}function N(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function I(e,t,n){e._addEL[t].push(n),function(e){if(!e._iL&&N(e)){var t=function(t){e._addEL[t.type].forEach((function(e){var n=1e5,s=e.time-n;t.time>=s&&e.fn(t.data)}))},n=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,n)})):(e._iL=!0,e.method.onMessage(e._state,t,n))}}(e)}function R(e,t,n){e._addEL[t]=e._addEL[t].filter((function(e){return e!==n})),function(e){if(e._iL&&!N(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}(e)}z._pubkey=!0,z.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(e));return B(this,"message",e)},postInternal:function(e){return B(this,"internal",e)},set onmessage(e){var t={time:this.method.microSeconds(),fn:e};R(this,"message",this._onML),e&&"function"==typeof e?(this._onML=t,I(this,"message",t)):this._onML=null},addEventListener:function(e,t){I(this,e,{time:this.method.microSeconds(),fn:t})},removeEventListener:function(e,t){R(this,e,this._addEL[e].find((function(e){return e.fn===t})))},close:function(){var e=this;if(!this.closed){D.delete(this),this.closed=!0;var t=this._prepP?this._prepP:i;return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(Array.from(e._uMP))})).then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type},get isClosed(){return this.closed}};var V=n(666),j=n(148);const q=self,X=self.requestAnimationFrame&&self.requestAnimationFrame||setTimeout,W=self.cancelAnimationFrame||clearTimeout,U=[];let Y,H,G,Z,K=0,Q=!1,$=7,J=35,ee=125,te=0,ne=0,se=0;const ie={get didTimeout(){return!1},timeRemaining(){var e=$-(Date.now()-ne);return Math.max(0,e)}},ae=function(e){let t,n;const s=()=>{var i=Date.now()-n;i<99?t=setTimeout(s,99-i):(t=null,e())};return()=>{n=Date.now(),t||(t=setTimeout(s,99))}}((()=>{$=22,ee=66,J=0}));function re(){125!=ee&&($=7,ee=125,J=35,Q&&(Q&&(Z&&W(Z),G&&clearTimeout(G),Q=!1),he())),ae()}function oe(){Z=null,G=setTimeout(ce,0)}function le(){G=null,X(oe)}function he(){Q||(H=ee-(Date.now()-ne),Y=Date.now(),Q=!0,J&&H<J&&(H=J),H>9?G=setTimeout(le,H):(H=0,le()))}function ce(){let e;const t=$>9?9:1;if(ne=Date.now(),Q=!1,G=null,K>2||ne-H-50<Y)for(let n=0,s=0|U.length;n<s&&ie.timeRemaining()>t;n=n+1|0)e=U.shift()||null,se++,e&&e(ie);U.length?he():K=0}function ue(e){return te++,U.push(e),he(),te}function de(e){var t=e-1-se;U[t]&&(U[t]=null)}if("requestIdleCallback"in q&&"cancelIdleCallback"in q)try{self.requestIdleCallback((()=>{}),{timeout:0})}catch(e){(e=>{let t,n;if(self.requestIdleCallback=function(t,n){return n&&"number"==typeof n.timeout?e(t,{timeout:n.timeout}):e(t)},self.IdleDeadline&&(t=self.IdleDeadline.prototype)){if(n=Object.getOwnPropertyDescriptor(t,"timeRemaining"),!n||!n.configurable||!n.get)return;Object.defineProperty(t,"timeRemaining",{value:function(){return n.get.call(this)},enumerable:!0,configurable:!0})}})(self.requestIdleCallback)}else self.requestIdleCallback=ue,self.cancelIdleCallback=de,self.document&&document.addEventListener&&(self.addEventListener("scroll",re,!0),self.addEventListener("resize",re),document.addEventListener("focus",re,!0),document.addEventListener("mouseover",re,!0),["click","keypress","touchstart","mousedown"].forEach((function(e){document.addEventListener(e,re,{capture:!0,passive:!0})})),self.MutationObserver&&new MutationObserver(re).observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0}));const ge="BroadcastChannel"in self?self.BroadcastChannel:class extends z{addEventListener(e,t){super.addEventListener(e,(n=>{t(new MessageEvent(e,{data:n}))}))}};class pe{constructor(e){this.scope={importScripts(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>{(0,j.h)(e).then((e=>{e.text().then((e=>{new Function(e)}))}))}))},addEventListener:(e,t)=>{new s.j(this.scope,e).on(t)},removeEventListener:(e,t)=>{new s.j(this.scope,e).off(t)},postMessage:e=>{new s.j(this,"message").trigger({data:e})}},setTimeout((()=>{(0,j.h)(e).then((e=>e.text().then((e=>{new Function("scope","with(scope){".concat(e,"}").replace("/******/ })()","/******/ })()}")).call(null,this.scope)}))))}))}onmessage(){}onmessageerror(){}onerror(){}addEventListener(e,t,n){t instanceof Function&&new s.j(this,e).on(t)}removeEventListener(e,t){t instanceof Function&&new s.j(this,e).off(t)}dispatchEvent(e){return!1}postMessage(e,t){setTimeout((()=>{new s.j(this.scope,"message").trigger({data:e})}))}terminate(){}}const fe=(0,V.nq)(!1)?q.postMessage:postMessage;self.requestIdleCallback,self.cancelIdleCallback},301:(e,t,n)=>{"use strict";n.d(t,{Ho:()=>c,bY:()=>d,jt:()=>u});var s=n(329),i=n(666),a=n(276);const r=new(n(983).zv)("screen"),o=new a.FM(0,0);let l=!1,h=1;if((0,i.nq)())r.addEventListener("message",(e=>{const{data:t}=e;if(t instanceof Object)switch(t.method){case"resolution":o.x=t.width,o.y=t.height;break;case"pixel-ratio":h=t.value;break;case"blur":l=t.value}})),r.postMessage({method:"init"});else{let e=!1;function t(){function e(){return(0,i.Vp)()&&(0,s.mU)(!0)?[self.screen.width,self.screen.height]:[self.innerWidth,self.innerHeight]}function t(e){l!==e&&(l=e,r.postMessage({method:"blur",value:e}))}const n=()=>{const[n,s]=e();o.x=n,o.y=s,h=self.devicePixelRatio,t(!1),r.postMessage({method:"resolution",width:n,height:s}),r.postMessage({method:"pixel-ratio",value:self.devicePixelRatio})};function a(){document.body.addEventListener("mousedown",n),document.body.addEventListener("touchstart",n),n()}self.addEventListener("resize",n),self.addEventListener("orientationchange",(()=>setTimeout(n,100))),self.addEventListener("fullscreenchange",n),self.addEventListener("fullscreenerror",n),document.addEventListener("pointerlockchange",n),document.addEventListener("pointerlockerror",n),self.addEventListener("focus",(()=>t(!1))),self.addEventListener("blur",(()=>t(!0)));const[c,u]=e();o.x=0|c,o.y=0|u,document.body?a():self.addEventListener("load",a)}r.addEventListener("message",(n=>{const{data:s}=n;if(s instanceof Object&&"init"===s.method)e||t(),e=!0}))}function c(){return("api"in self&&self.api.hasBlur()||l)&&!(0,i.Tt)()}function u(){l=!1}function d(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{x:t,y:n}=o;return[Math.floor(t*((0,i.Pe)()||!e?1:h)),Math.floor(n/((0,i.Pe)()&&t<n?2:1)*((0,i.Pe)()||!e?1:h))]}},424:(e,t,n)=>{"use strict";function s(){const e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".split("");for(let t=0,n=0|e.length;t<n;t=t+1|0)switch(e[t]){case"x":e[t]=Math.floor(16*Math.random()).toString(16);break;case"y":e[t]=(Math.floor(4*Math.random())+8).toString(16)}return e.join("")}n.d(t,{D:()=>s})},276:(e,t,n)=>{"use strict";n.d(t,{B8:()=>v,FM:()=>a,KO:()=>w,LW:()=>d,P:()=>r,X6:()=>g,XC:()=>P,c6:()=>A,c8:()=>y,fB:()=>k,gJ:()=>_,iV:()=>E,oK:()=>h,t6:()=>m,tL:()=>f,tx:()=>b,uB:()=>i,vr:()=>S,xv:()=>O,xw:()=>o});const s=2*Math.PI,i=(Math.PI,Math.PI/2);Math.PI;class a{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.x=e,this.y=t}}class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=e,this.y=t,this.z=n}}function o(e,t,n,s){return[e-n,t-s]}function l(e,t,n,s,i,a){return[e-s,t-i,n-a]}function h(e,t,n,s){return e*n+t*s}function c(e,t,n,s,i,a){return e*s+t*i+n*a}function u(e,t,n,s,i,a){return[t*a-i*n,n*s-a*e,e*i-s*t]}function d(e,t,n,s){const[i,a]=o(e,t,n,s);return Math.sqrt(h(i,a,i,a))}function g(e,t,n,s,i,a){const[r,o,h]=l(e,t,n,s,i,a);return Math.sqrt(c(r,o,h,r,o,h))}function p(e){return[Math.cos(v(e)),Math.sin(v(e))]}function f(e,t){const n=Math.sin(v(t)),s=Math.cos(v(t)),i=Math.sin(v(e)),a=Math.cos(v(e)),r=Math.abs(s);return[a*r,-n,i*r]}function m(e,t,n){let s=0,i=0;const[a,r]=p(e-Math.PI/2);s+=t*a,i+=t*r;const[o,l]=p(e);return s+=n*o,i+=n*l,[s,i]}function y(e,t,n,s,i){let a=0,r=0,o=0;const[l,h]=p(e-Math.PI/2);if(a+=n*l,o+=n*h,t>0){const[n,i,l]=f(e,t-Math.PI/2);a+=s*n,r+=s*i,o+=s*l}else{const[n,i,l]=f(e,t+Math.PI/2);a-=s*n,r-=s*i,o-=s*l}const[c,u,d]=f(e,t);return a+=i*c,r+=i*u,o+=i*d,[a,r,o]}function w(e,t,n,s){const[i,a]=o(e,t,n,s);return Math.atan2(a,i)}function b(e,t,n,s,i,a){const[r,o,h]=l(e,t,n,s,i,a);return[Math.atan2(h,r),-Math.atan2(o,Math.sqrt(r*r+h*h))]}function v(e){return(e%=s)<0&&(e+=s),6123233995736766e-32===e?0:e}function x(e,t,n){let s=e*e+t*t+n*n;return s>0&&(s=1/Math.sqrt(s)),[e*s,t*s,n*s]}function M(e,t){let n=(e=v(e))-(t=v(t));return n-=Math.floor(n/s)*s,n-=n>Math.PI?s:0,n}function S(e,t,n,s){const[i,a]=function(e,t,n,s){const i=M(e,n);return[i,M(Math.abs(i)<Math.PI/4*3?t:Math.PI/2*(t/Math.abs(t))-t+Math.PI/2*(t/Math.abs(t)),s)]}(e,t,n,s);return[Math.abs(i),Math.abs(a)]}function k(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const a=Math.cos(e),r=Math.sin(e),o=Math.cos(t-Math.PI/2),l=Math.sin(t-Math.PI/2),h=s-.5,c=i-.5,u=n,d=u*o+c*l;return x(d*a-h*r,c*o-u*l,h*a+d*r)}function P(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const a=Math.cos(e),r=Math.sin(e),o=Math.cos(t),l=Math.sin(t),h=s-.5,c=i-.5,u=n,d=u*o+c*l;return x(d*a-h*r,c*o-u*l,h*a+d*r)}function _(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const[a,r,o]=k(e,t,n,s,i),[l,h,c]=P(e,t,n,s,i),[d,g,p]=u(l,h,c,a,r,o);return[d,g,p,a,r,o,l,h,c]}function E(e,t,n,s,i,a,r,o,l,h,u,g,p,f,m,y){let w=arguments.length>16&&void 0!==arguments[16]?arguments[16]:0,b=arguments.length>17&&void 0!==arguments[17]?arguments[17]:1;const v=s-e,x=i-t,M=a-n,S=c(v,x,M,o,l,h),k=c(v,x,M,u,g,p),P=c(v,x,M,f,m,y),_=2*b,E=S/P*_,O=k/P*_,A=r*d(0,0,1,1)/P*_,L=Math.sin(-w),C=Math.cos(-w);return[C*E-L*O,L*E+C*O,A]}function O(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const s=1/e*2,i=1/t*2;let a=0;for(let r=0,o=0|t;r<o;r=r+1|0)for(let t=0,o=0|e;t<o;t=t+1|0){let e=t*s+s/2,o=r*i+i/2;n[2*a]=e-1,n[2*a+1]=o-1,a++}return[n,s,i]}function A(e){return 90/e/(e/90*2)}},211:(e,t,n)=>{"use strict";n.a(e,(async(e,s)=>{try{n.d(t,{D8:()=>l});var i=n(46),a=e([i]);i=(a.then?(await a)():a)[0];const r=(0,i.vL)(0,0).getContext("webgl2");const o=null==r?null:r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),l=(null===r||r.MAX_TEXTURE_SIZE,null===r?0:r.MAX_3D_TEXTURE_SIZE);null===r||r.MAX_COLOR_ATTACHMENTS,null!==r&&null!==o&&r.getParameter(o.MAX_TEXTURE_MAX_ANISOTROPY_EXT);s()}catch(e){s(e)}}))},52:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});class s{constructor(e,t){const n=t.toString().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/),s=function(e,t){return URL.createObjectURL(new Blob([t],{type:e}))}("text/ecmascript",null!==n?n.length>2?"\n\t\t\tonmessage = (".concat(n[1],") =>\n\t\t\t{\n\t\t\t\t").concat(n[2],"\n\n\t\t\t};\n\t\t"):"\n\t\t\tonmessage = () =>\n\t\t\t{\n\t\t\t\t".concat(n[1],"\n\n\t\t\t};\n\t\t"):"");this.source=s,this.worker=new e(s)}exec(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise(((t,n)=>{const s=e=>{this.worker.removeEventListener("message",s),this.worker.removeEventListener("error",i),t(e.data)},i=e=>{this.worker.removeEventListener("message",s),this.worker.removeEventListener("error",i),n(e)};this.worker.addEventListener("message",s),this.worker.addEventListener("error",i),this.worker.postMessage(e)}))}terminate(){URL.revokeObjectURL(this.source),this.worker.terminate()}}},748:(e,t,n)=>{"use strict";n.a(e,(async(e,s)=>{try{n.d(t,{D:()=>o});var i=n(983),a=n(46),r=e([a]);function o(e){if(document.body){const t=e();t instanceof Promise&&t.catch((e=>{throw e}))}else document.addEventListener("DOMContentLoaded",(()=>{const t=e();t instanceof Promise&&t.catch((e=>{throw e}))}))}a=(r.then?(await r)():r)[0],self.CanvasWorker="OffscreenCanvas"in self&&a.qm?Worker:i.Vw,s()}catch(e){s(e)}}))},40:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});var s=n(749);class i{constructor(){this.activeSceneName=null,this.isChangeScene=!1}getActiveSceneName(){return this.activeSceneName}applyData(e){const t=e.scenes;this.isChangeScene=t.activeSceneName!==this.activeSceneName,this.isChangeScene&&(this.activeSceneName=t.activeSceneName,new s.j(this,"inactive").trigger({activeSceneName:this.activeSceneName}),new s.j(this,"active").trigger({activeSceneName:t.activeSceneName}))}}},685:(e,t,n)=>{"use strict";n.d(t,{w:()=>l});var s=n(749),i=n(276),a=n(736),r=n(301),o=n(666);class l{constructor(e){this.size=new i.FM(0,0),this.oldSize=new i.FM(0,0),this.isUpdate=!1,this.id=e;for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];this.childs=n,self.addEventListener("resize",(()=>{this.resize()}))}fix(e,t,n){let s=0,i=0;t>e?n.clientHeight/n.clientWidth>t/e?(s=Math.max(e,t)*(this.size.x/this.size.y),i=Math.max(e,t)):(s=Math.min(t,e),i=Math.min(t,e)*(this.size.y/this.size.x)):n.clientWidth/n.clientHeight>e/t?(s=Math.max(t,e),i=Math.max(t,e)*(this.size.y/this.size.x)):(s=Math.min(e,t)*(this.size.x/this.size.y),i=Math.min(e,t)),(0,a.tt)(n,{transformOrigin:"top left",transform:"translate(calc(".concat(e,"px / 2.0 - ").concat(s,"px / 2.0), calc(").concat(t,"px / 2.0 - ").concat(i,"px / 2.0)) scale(").concat(s/this.size.x,", ").concat(i/this.size.y,")"),position:"relative"})}setSize(e,t){this.size.x===e&&this.size.y===t||(this.isUpdate=!0),this.size.x=e,this.size.y=t}resize(){const e=document.querySelector(this.id),[t,n]=(0,r.bY)(!1);if(null!==e&&null!==e.parentElement&&e instanceof HTMLElement&&(this.isUpdate||t!==this.oldSize.x||n!==this.oldSize.y)){const i=e.parentElement||e;this.oldSize.x=t,this.oldSize.y=n,this.fix(t,n,e),(0,o.Pe)()&&i.clientHeight>i.clientWidth?this.childs.forEach((e=>{(0,a.tt)(e,{left:"".concat(0,"px"),top:"".concat(n,"px"),width:"".concat(t,"px"),height:"".concat(n,"px")})})):this.childs.forEach((e=>{(0,a.tt)(e,{left:"".concat(0,"px"),top:"".concat(0,"px"),width:"".concat(t,"px"),height:"".concat(n,"px")})})),this.isUpdate=!1,new s.j(this,"resize").trigger({widht:this.oldSize.x,height:this.oldSize.y})}}update(){}rendering(){}}},815:(e,t,n)=>{"use strict";n.d(t,{u:()=>a});var s=n(329),i=n(301);function a(e,t){const[n,a]=(0,s.mU)(!0)&&t[e.resolutionIndex]||(0,i.bY)();return[0|n,0|a]}},388:(e,t,n)=>{"use strict";n.a(e,(async(e,t)=>{try{var s=n(579),i=n(217),a=e([s]);(0,(s=(a.then?(await a)():a)[0]).F)(i.Z),t()}catch(e){t(e)}}))},579:(e,t,n)=>{"use strict";n.a(e,(async(e,s)=>{try{n.d(t,{F:()=>T});var i=n(748),a=n(685),r=n(990),o=n(169),l=n(813),h=n(46),c=n(959),u=n(437),d=n(279),g=n(365),p=n(220),f=n(749),m=n(615),y=n(40),w=n(580),b=n(211),v=n(301),x=n(815),M=n(736),S=n(34),k=n(666),P=n(329),_=n(481),E=n(202),O=n(313),A=n(224),L=n(451),C=e([i,h,d,b]);async function T(e){(0,i.D)((async function(){if(!(0,h.vL)(0,0).getContext("webgl2"))throw alert("Not support is this ".concat((0,k.Vp)()?"hardware":"browser"));const t=document.getElementById("game"),n=document.getElementById("touchpad");if(!t||!n)return;const s=(0,h.vL)(0,0);if(null===s)return;const i=await(0,w.X0)("setting"),C=new A.p(i),T=new y.i,D=new d.m(64,p.Tc),F=new g.Y(D),z=new a.w(".resizer",n),B=document.querySelector("#game");function N(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B.width||0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B.height;0===e&&0===t?setTimeout((()=>N())):B instanceof HTMLCanvasElement&&((0,M.A_)(B,"width","".concat(e,"px")),(0,M.A_)(B,"height","".concat(t,"px")))}let[I,R]=(0,x.u)(i,L.V);s.width=I,s.height=R,t.width=I,t.height=R,t instanceof HTMLCanvasElement&&(0,M.tt)(t,{width:"".concat(I,"px"),height:"".concat(R,"px")});const V=()=>{Z.postMessage({method:"resize"})};self.addEventListener("orientationchange",(()=>setTimeout(V,100))),self.addEventListener("resize",V),self.addEventListener("blur",V),self.addEventListener("focus",V),self.document.addEventListener("fullscreenchange",V),z.setSize(I,R),z.resize();let j,q=-1,X=!1,W=!1;function U(){X=!0,cancelAnimationFrame(q),clearTimeout(j),E.y3.postMessage({method:"error"}),E.mI.postMessage({method:"error"}),(0,_.HW)()}self.addEventListener("error",U);const Y=new MessageChannel,H=new MessageChannel,G=new e,Z=new O.Z;let K=!1,Q=!1,$=!1,J=!1,ee=!1,te=!1;self.addEventListener("contextmenu",(e=>{e.stopPropagation(),e.preventDefault()})),G.addEventListener("message",(e=>{const{data:t}=e;if(t instanceof Object)switch(t.method){case"standby":K=!0;break;case"ready":$=!0;break;case"error":U();break;case"resize":E.mI.postMessage({method:"resize"});break;case"transfer-update":const e=t.data;T.applyData(e),ue.applyData(e),G.postMessage({method:"apply-update-data"});break;case"transfer-render":const n=t.data;Z.postMessage({method:"transfer-render",data:n},n.transfers);break;case"transfer-sound":const s=t.data;F.rendering(s.sounds),G.postMessage({method:"apply-sound-data",data:F.createTransferData()});break;case"fetch":(0,u.hn)(t.url,t.type,t.options).then((e=>e.source instanceof ArrayBuffer?G.postMessage({method:"fetch",error:!1,data:e.source,key:t.key},[e.source]):G.postMessage({method:"fetch",error:!1,data:e.source,key:t.key}))).catch((()=>G.postMessage({method:"fetch",error:!0,data:null,key:t.key})))}})),Z.addEventListener("message",(e=>{const{data:t}=e;if(t instanceof Object)switch(t.method){case"standby":Q=!0;break;case"ready":J=!0;break;case"error":U();break;case"loaded":ee=!0;break;case"apply-render-data":G.postMessage({method:"apply-render-data",render:t.render,update:t.update,fps:t.fps});break;case"lostcontext":E.mI.postMessage({method:"error"}),E.y3.postMessage({method:"error"}),C.setCRTEnable(!1),(0,w.nL)("setting"),alert("sorry lost context of WebGL");break;case"contextrestored":E.mI.postMessage({method:"run"}),E.y3.postMessage({method:"run"});break;case"paintwait":te=!0;break;case"unlockpaintwait":te=!1,V();break;case"resize":z.setSize(t.width,t.height),N(t.width,t.height),z.resize(),(0,P.I4)();break;case"post-asset-data":break;case"fetch":(0,u.hn)(t.url,t.type,t.options).then((e=>e.source instanceof ArrayBuffer?Z.postMessage({method:"fetch",error:!1,data:e.source,key:t.key},[e.source]):Z.postMessage({method:"fetch",error:!1,data:e.source,key:t.key}))).catch((()=>Z.postMessage({method:"fetch",error:!0,data:null,key:t.key})))}}));let ne=null;new f.j(T,"active").on((()=>{ne=T.getActiveSceneName()}));let se="";const ie=[await(0,c.B)("./asset/warn.png"),await(0,c.B)("./asset/creater.png"),await(0,c.B)("./asset/engine.png"),await(0,c.B)("./asset/background.png")],ae={maxTextureSize:b.D8},re={logos:ie,assetLength:D.getAssetLenght(),mainScreen:(0,h.mC)(t)},oe=[...re.logos.filter((e=>e instanceof ImageBitmap))];h.aE&&re.mainScreen instanceof OffscreenCanvas&&oe.push(re.mainScreen),H.port1.start();try{await Promise.all([new Promise((e=>{const t=()=>{K?e(null):setTimeout(t)};t()})),new Promise((e=>{const t=()=>{Q?e(null):setTimeout(t)};t()}))]),await Promise.all([new Promise((e=>{const t=()=>{$?e(null):setTimeout(t)};G.postMessage({method:"init",paintChannel:Y.port1,controlChannel:H.port2,data:ae},[Y.port1,H.port2]),t()})),new Promise((e=>{const t=()=>{J?e(null):setTimeout(t)};Z.postMessage({method:"init",paintChannel:Y.port2,data:re},[Y.port2,...oe]),t()}))]);let e=!C.hasFullscreen(),t=(0,P.Kw)();const n=()=>{requestAnimationFrame(n),(0,k.Vp)()&&"api"in self&&!W&&(self.api.init(),W=!0);const s=C.hasFullscreen();s!==e&&(s?(0,P.Zx)():(0,P.Qg)()),e=s;const i=(0,P.Kw)();t!==i&&V(),t=i};requestAnimationFrame(n)}catch(e){throw U(),e}se=(await(0,u.hn)("./asset/touchpad.html","text")).source;const le=new o.N(.0125,t,H.port1),he=new r.X(.0065,n,H.port1,se),ce=new l.n(.00125,i,H.port1),ue=new m.$(le,he,ce),de=[z,F,ue];document.body.addEventListener("keydown",(e=>{let t="none";if(e.ctrlKey){switch(e.key.toLocaleLowerCase()){case"o":t="open";break;case"s":t="save";break;case"n":t="new";break;case"b":t="build";break;case"p":t="preview";break;default:t="none"}H.port1.postMessage({method:"editor",name:t})}}),!1),document.body.addEventListener("touchend",(()=>he.show()));let ge=!1;t.addEventListener("mousedown",(e=>{(0,k.Pe)()||(e.preventDefault(),e.stopPropagation(),self.focus(),X||ge||"title"===ne||(0,_.d3)())})),new f.j(ce,"changeconnect").on((e=>{let{value:t}=e;"gamepad"!==ue.getInputType()||t||E.y3.postMessage({method:"pause"})})),le.press((()=>(0,v.jt)())),ce.press((()=>(0,v.jt)())),document.body.classList.remove("no-init"),"api"in self&&self.api.requestScreenChange(V),V(),await Promise.all([D.load((()=>Z.postMessage({method:"send-loaded"}))),await new Promise((e=>{const t=()=>{ee?e(null):setTimeout(t)};Z.postMessage({method:"loading"}),t()}))]),G.postMessage({method:"start"}),Z.postMessage({method:"start"}),j=setTimeout((function e(){j=setTimeout(e),te||(0,u.DU)()||(0,k.Tt)()||(0,v.Ho)()?ge||(E.y3.postMessage({method:"sleep",scene:(0,v.Ho)()?"title":null}),E.mI.postMessage({method:"sleep"}),F.pause(),ge=!0):ge&&(E.y3.postMessage({method:"unsleep",scene:(0,v.Ho)()?"title":null}),E.mI.postMessage({method:"unsleep"}),F.play(),ge=!1),de.forEach((e=>e.update()))})),q=requestAnimationFrame((function e(t){q=requestAnimationFrame(e),(0,S.Er)(),he.rendering()}))}))}[i,h,d,b]=C.then?(await C)():C,s()}catch(e){s(e)}}))},451:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});const s=[[1920,1080],[1280,720],[800,600],[900,600],[300,200]]},762:function(e){e.exports=function(e){var t={};function n(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var s=n(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,s){void 0===s&&(s=!1);var i=e.getVersionPrecision(t),a=e.getVersionPrecision(n),r=Math.max(i,a),o=0,l=e.map([t,n],(function(t){var n=r-e.getVersionPrecision(t),s=t+new Array(n+1).join(".0");return e.map(s.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(s&&(o=r-Math.min(i,a)),r-=1;r>=o;){if(l[0][r]>l[1][r])return 1;if(l[0][r]===l[1][r]){if(r===o)return 0;r-=1}else if(l[0][r]<l[1][r])return-1}},e.map=function(e,t){var n,s=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)s.push(t(e[n]));return s},e.find=function(e,t){var n,s;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,s=e.length;n<s;n+=1){var i=e[n];if(t(i,n))return i}},e.assign=function(e){for(var t,n,s=e,i=arguments.length,a=new Array(i>1?i-1:0),r=1;r<i;r++)a[r-1]=arguments[r];if(Object.assign)return Object.assign.apply(Object,[e].concat(a));var o=function(){var e=a[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){s[t]=e[t]}))};for(t=0,n=a.length;t<n;t+=1)o();return e},e.getBrowserAlias=function(e){return s.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return s.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var s,i=(s=n(91))&&s.__esModule?s:{default:s},a=n(18);function r(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var o=function(){function e(){}var t,n,s;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,s=[{key:"BROWSER_MAP",get:function(){return a.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return a.ENGINE_MAP}},{key:"OS_MAP",get:function(){return a.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return a.PLATFORMS_MAP}}],(n=null)&&r(t.prototype,n),s&&r(t,s),e}();t.default=o,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var s=l(n(92)),i=l(n(93)),a=l(n(94)),r=l(n(95)),o=l(n(17));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=o.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=o.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=o.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=o.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return o.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},s=0,i={},a=0;if(Object.keys(e).forEach((function(t){var r=e[t];"string"==typeof r?(i[t]=r,a+=1):"object"==typeof r&&(n[t]=r,s+=1)})),s>0){var r=Object.keys(n),l=o.default.find(r,(function(e){return t.isOS(e)}));if(l){var h=this.satisfies(n[l]);if(void 0!==h)return h}var c=o.default.find(r,(function(e){return t.isPlatform(e)}));if(c){var u=this.satisfies(n[c]);if(void 0!==u)return u}}if(a>0){var d=Object.keys(i),g=o.default.find(d,(function(e){return t.isBrowser(e,!0)}));if(void 0!==g)return this.compareVersion(i[g])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),s=e.toLowerCase(),i=o.default.getBrowserTypeByAlias(s);return t&&i&&(s=i.toLowerCase()),s===n},t.compareVersion=function(e){var t=[0],n=e,s=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(s=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(s=!0,n=e.substr(1)),t.indexOf(o.default.compareVersions(i,n,s))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=h,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var s,i=(s=n(17))&&s.__esModule?s:{default:s},a=/version\/(\d+(\.?_?\d+)+)/i,r=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=i.default.getFirstMatch(a,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=i.default.getFirstMatch(a,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=r,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var s,i=(s=n(17))&&s.__esModule?s:{default:s},a=n(18),r=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:a.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=i.default.getWindowsVersionName(t);return{name:a.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:a.OS_MAP.iOS},n=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=i.default.getMacOSVersionName(t),s={name:a.OS_MAP.MacOS,version:t};return n&&(s.versionName=n),s}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:a.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=i.default.getAndroidVersionName(t),s={name:a.OS_MAP.Android,version:t};return n&&(s.versionName=n),s}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:a.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:a.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:a.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:a.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:a.OS_MAP.PlayStation4,version:t}}}];t.default=r,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var s,i=(s=n(17))&&s.__esModule?s:{default:s},a=n(18),r=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:a.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:a.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:a.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.tv}}}];t.default=r,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var s,i=(s=n(17))&&s.__esModule?s:{default:s},a=n(18),r=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:a.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:a.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:a.ENGINE_MAP.Trident},n=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:a.ENGINE_MAP.Presto},n=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:a.ENGINE_MAP.Gecko},n=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:a.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:a.ENGINE_MAP.WebKit},n=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=r,e.exports=t.default}})},121:e=>{e.exports=function(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}},317:e=>{"use strict";e.exports=i,e.exports.isMobile=i,e.exports.default=i;const t=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,n=/CrOS/,s=/android|ipad|playbook|silk/i;function i(e){e||(e={});let i=e.ua;if(i||"undefined"==typeof navigator||(i=navigator.userAgent),i&&i.headers&&"string"==typeof i.headers["user-agent"]&&(i=i.headers["user-agent"]),"string"!=typeof i)return!1;let a=t.test(i)&&!n.test(i)||!!e.tablet&&s.test(i);return!a&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==i.indexOf("Macintosh")&&-1!==i.indexOf("Safari")&&(a=!0),a}},313:(e,t,n)=>{"use strict";function s(){return new CanvasWorker(n.p+"worker.render.js")}n.d(t,{Z:()=>s})},217:(e,t,n)=>{"use strict";function s(){return new Worker(n.p+"worker.tick.js")}n.d(t,{Z:()=>s})}},o={};function l(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e].call(n.exports,n,n.exports,l),n.exports}e="function"==typeof Symbol?Symbol("webpack then"):"__webpack_then__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",s=e=>{e&&(e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},i=e=>!--e.r&&e(),a=(e,t)=>e?e.push(t):i(t),l.a=(r,o,l)=>{var h,c,u,d=l&&[],g=r.exports,p=!0,f=!1,m=(t,n,s)=>{f||(f=!0,n.r+=t.length,t.map(((t,i)=>t[e](n,s))),f=!1)},y=new Promise(((e,t)=>{u=t,c=()=>(e(g),s(d),d=0)}));y[t]=g,y[e]=(e,t)=>{if(p)return i(e);h&&m(h,e,t),a(d,e),y.catch(t)},r.exports=y,o((r=>{var o;h=(r=>r.map((r=>{if(null!==r&&"object"==typeof r){if(r[e])return r;if(r.then){var o=[];r.then((e=>{l[t]=e,s(o),o=0}),(e=>{l[n]=e,s(o),o=0}));var l={};return l[e]=(e,t)=>(a(o,e),r.catch(t)),l}}var h={};return h[e]=e=>i(e),h[t]=r,h})))(r);var l=()=>h.map((e=>{if(e[n])throw e[n];return e[t]})),c=new Promise(((e,t)=>{(o=()=>e(l)).r=0,m(h,o,t)}));return o.r?c:l()}),(e=>(e&&u(y[n]=e),c()))),p=!1},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;l.g.importScripts&&(e=l.g.location+"");var t=l.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=e})();l(388)})();